(FILECREATED "22-AUG-80 21:45:38" <LISPUSERS>SCRATCHLIST.;7 2365   

     changes to:  SCRATCHLIST

     previous date: "14-APR-79 13:25:18" <LISPUSERS>SCRATCHLIST.;6)


(PRETTYCOMPRINT SCRATCHLISTCOMS)

(RPAQQ SCRATCHLISTCOMS [(FNS ADDTOSCRATCHLIST SCRATCHLIST)
			(PROP MACRO SCRATCHLIST ADDTOSCRATCHLIST)
			(PROP INFO SCRATCHLIST)
			(DECLARE: DONTEVAL@LOAD DOEVAL@COMPILE DONTCOPY COMPILERVARS
				  (ADDVARS (NLAMA SCRATCHLIST)
					   (NLAML)
					   (LAMA])
(DEFINEQ

(ADDTOSCRATCHLIST
  (LAMBDA (VALUE)                       (* lmm "17-JAN-78 16:27")
    (FRPLACA (SETQ !SCRATCHTAIL (OR (LISTP (CDR !SCRATCHTAIL))
				    (CDR (FRPLACD !SCRATCHTAIL
						  (CONS)))))
	     VALUE)))

(SCRATCHLIST
  [NLAMBDA ARGS                    (* rmk: "23-JAN-79 21:54")
    ([LAMBDA (!SCRATCHLIST !SCRATCHTAIL)
	(DECLARE (SPECVARS !SCRATCHLIST !SCRATCHTAIL))
	(SETQ !SCRATCHTAIL !SCRATCHLIST)
	(APPLY (FUNCTION PROGN)
	       (CDR ARGS)
	       (QUOTE INTERNAL))
	(COND
	  ((EQ !SCRATCHTAIL !SCRATCHLIST)
	    NIL)
	  (T (PROG ((L2 (CDR !SCRATCHLIST)))
	           (RPLACD !SCRATCHLIST (PROG1 (CDR !SCRATCHTAIL)
					       (RPLACD !SCRATCHTAIL NIL)))
	           (FRPLACD (FLAST !SCRATCHLIST)
			    L2)
	           (RETURN L2]
      (OR (LISTP (EVAL (CAR ARGS)
		       (QUOTE INTERNAL)))
	  (CONS))
      NIL])
)

(PUTPROPS SCRATCHLIST MACRO ((SCRATCHLIST . FORMS)
			     ([LAMBDA (!SCRATCHLIST !SCRATCHTAIL)
				 (DECLARE (SPECVARS !SCRATCHLIST !SCRATCHTAIL))
				 (SETQ !SCRATCHTAIL !SCRATCHLIST)
				 (PROGN . FORMS)
				 (COND
				   ((EQ !SCRATCHTAIL !SCRATCHLIST)
				     NIL)
				   (T (PROG ((L2 (CDR !SCRATCHLIST)))
					    (RPLACD !SCRATCHLIST (PROG1 (CDR !SCRATCHTAIL)
									(RPLACD !SCRATCHTAIL NIL)))
					    (FRPLACD (FLAST !SCRATCHLIST)
						     L2)
					    (RETURN L2]
			       (OR (LISTP SCRATCHLIST)
				   (CONS))
			       NIL)))

(PUTPROPS ADDTOSCRATCHLIST MACRO ((VALUE)
				  (FRPLACA [SETQ !SCRATCHTAIL (OR (LISTP (CDR !SCRATCHTAIL))
								  (CDR (FRPLACD !SCRATCHTAIL
										(CONS]
					   VALUE)))

(PUTPROPS SCRATCHLIST INFO EVAL)
(DECLARE: DONTEVAL@LOAD DOEVAL@COMPILE DONTCOPY COMPILERVARS 

(ADDTOVAR NLAMA SCRATCHLIST)

(ADDTOVAR NLAML )

(ADDTOVAR LAMA )
)
(DECLARE: DONTCOPY
  (FILEMAP (NIL (490 1387 (ADDTOSCRATCHLIST 502 . 730) (SCRATCHLIST 734 . 1384)))))
STOP
