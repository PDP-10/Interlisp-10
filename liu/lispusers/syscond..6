(FILECREATED "15-JAN-81 18:18:00" <LISPUSERS>SYSCOND.;6 2986   

     changes to:  SYSCOND

     previous date: "22-MAY-80 22:44:12" <LISPUSERS>SYSCOND.;5)


(PRETTYCOMPRINT SYSCONDCOMS)

(RPAQQ SYSCONDCOMS [(E (RESETSAVE CLISPIFYPRETTYFLG NIL))
		    (FNS SYSCOND)
		    (ALISTS (DWIMEQUIVLST SYSCOND)
			    (PRETTYEQUIVLST SYSCOND))
		    (ADDVARS (NOFIXVARSLST ALTO TENEX))
		    (PROP (ALTOMACRO MACRO)
			  SYSCOND)
		    (ADDVARS (CLISPRECORDTYPES SYSREC))
		    (P (MOVD? (QUOTE RECORD)
			      (QUOTE SYSREC)))
		    (PROP USERRECORDTYPE SYSREC)
		    (FNS SYSRECTRAN)
		    (DECLARE: DONTEVAL@LOAD DOEVAL@COMPILE DONTCOPY COMPILERVARS
			      (ADDVARS (NLAMA SYSCOND)
				       (NLAML)
				       (LAMA])
(DEFINEQ

(SYSCOND
  [NLAMBDA FORMS                                       (* rmk: "15-JAN-81 18:16")
    (PROG ((TAIL FORMS))
      LP  (RETURN (if (NLISTP TAIL)
		      then (if TAIL
			       then (ERROR "UNUSUAL CDR ARG LIST" TAIL)
			     else (ERROR "UNRECOGNIZED SYSTEM TYPE" FORMS))
		    elseif [OR (EQ (SYSTEMTYPE)
				   (CAAR TAIL))
			       (AND [EQ (QUOTE OR)
					(CAR (LISTP (CAAR TAIL]
				    (MEMB (SYSTEMTYPE)
					  (CDAAR TAIL]
		      then (APPLY (FUNCTION PROGN)
				  (CDAR TAIL)
				  (QUOTE INTERNAL))
		    else (SETQ TAIL (CDR TAIL))
			 (GO LP])
)

(ADDTOVAR DWIMEQUIVLST (SYSCOND . COND))

(ADDTOVAR PRETTYEQUIVLST (SYSCOND . COND))

(ADDTOVAR NOFIXVARSLST ALTO TENEX)

(PUTPROPS SYSCOND ALTOMACRO [FORMS (MKPROGN (CDAR (SOME FORMS
							(FUNCTION
							  (LAMBDA
							    (X)
							    (COND
							      ((OR (EQ (CAR X)
								       (QUOTE ALTO))
								   (AND (EQ (CAR (LISTP (CAR X)))
									    (QUOTE OR))
									(MEMB (QUOTE ALTO)
									      (CDAR X])

(PUTPROPS SYSCOND MACRO [FORMS (MKPROGN (CDAR (SOME FORMS (FUNCTION (LAMBDA (X)
							(COND
							  ((OR (EQ (CAR X)
								   (QUOTE TENEX))
							       (AND (EQ (CAR (LISTP (CAR X)))
									(QUOTE OR))
								    (MEMB (QUOTE TENEX)
									  (CDAR X])

(ADDTOVAR CLISPRECORDTYPES SYSREC)
(MOVD? (QUOTE RECORD)
       (QUOTE SYSREC))

(PUTPROPS SYSREC USERRECORDTYPE SYSRECTRAN)
(DEFINEQ

(SYSRECTRAN
  [LAMBDA (DECL)                                       (* rmk: "22-MAY-80 22:44")
    (PROG [(RESULT (SELECTQ (COMPILEMODE)
			    [ALTO (CADAR (SOME (CDDR DECL)
					       (FUNCTION (LAMBDA (X)
						   (EQMEMB (QUOTE ALTO)
							   (CAR X]
			    [(PDP-10 MAXC/10 MAXC)
			      (CADAR (SOME (CDDR DECL)
					   (FUNCTION (LAMBDA (X)
					       (EQMEMB (QUOTE TENEX)
						       (CAR X]
			    (SHOULDNT]
          (RETURN (CONS (CAR RESULT)
			(CONS (CADR DECL)
			      (CDR RESULT])
)
(DECLARE: DONTEVAL@LOAD DOEVAL@COMPILE DONTCOPY COMPILERVARS 

(ADDTOVAR NLAMA SYSCOND)

(ADDTOVAR NLAML )

(ADDTOVAR LAMA )
)
(DECLARE: DONTCOPY
  (FILEMAP (NIL (753 1390 (SYSCOND 765 . 1387)) (2274 2815 (SYSRECTRAN 2286 . 2812)))))
STOP
