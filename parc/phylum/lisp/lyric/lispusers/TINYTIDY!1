(DEFINE-FILE-INFO §READTABLE "INTERLISP" §PACKAGE "INTERLISP")(FILECREATED " 4-Dec-86 07:41:11" {ERIS}<LISPUSERS>LISPCORE>TINYTIDY.;1 6253         changes to%:  (FNS MOVEICON TINYTIDY)      previous date%: "16-Dec-85 16:56:22" {ERIS}<LISP>KOTO>LISPUSERS>TINYTIDY.;1)(* "Copyright (c) 1984, 1985, 1986 by Xerox Corporation.  All rights reserved.")(PRETTYCOMPRINT TINYTIDYCOMS)(RPAQQ TINYTIDYCOMS [(FNS MOVEICON TINYTIDY)                     (INITVARS (TINYTIDY.DEFAULT 'RIGHTBOTTOM)                            (TINYTIDY.DEFAULT.ALL 'LEFT))                     (P (COND ((NOT (FASSOC 'TinyTidy BackgroundMenuCommands))                               (PUSH BackgroundMenuCommands '(TinyTidy (TINYTIDY)                                                                    "aligns all icons on screen edge"                                                                    ))                               (SETQ BackgroundMenu NIL])(DEFINEQ(MOVEICON  [LAMBDA (WINDOW ICON X Y)                                  (* ; "Edited  4-Dec-86 07:38 by lmm")    (if (NEQ WINDOW ICON)        then (PUTWINDOWPROP WINDOW 'ICONPOSITION (CONS X Y)))    (LET ((REGION (WINDOWREGION ICON)))         (if (GETWINDOWPROP ICON 'ATTACHEDWINDOWS)             then                     (* ;; "this is a workaround for what I think is a bug in attached windows, namely that MOVEW coordinates move the main window, not the attached windows")                  [RELMOVEW ICON (CONS (IDIFFERENCE X (fetch (REGION LEFT) of REGION))                                       (IDIFFERENCE Y (fetch (REGION BOTTOM) of REGION]           elseif (OPENWP ICON)             then (MOVEW ICON X Y)           else (WINDOWPROP ICON 'REGION (CREATEREGION X Y (fetch (REGION LEFT) of REGION)                                                (fetch (REGION BOTTOM) of REGION])(TINYTIDY  [LAMBDA (EDGE SPACING ALL)                                 (* ; "Edited  4-Dec-86 07:40 by lmm")    (OR SPACING (SETQ SPACING 4))    (OR EDGE (SETQ EDGE (if ALL                            then TINYTIDY.DEFAULT.ALL                          else TINYTIDY.DEFAULT)))    (for OW in (REVERSE (OPENWINDOWS)) bind ICON (X _ 0)                                            (Y _ 0)                                            (MAXY _ 0)                                            W H REGION       when (COND               ((GETWINDOWPROP OW 'ICONFOR)                  (* ; "I'm an icon")                (SETQ ICON OW))               [(SETQ ICON (GETWINDOWPROP OW 'ICONWINDOW))   (* ; "I've got an icon window")                (AND (WINDOWP ICON)                     (NOT (OPENWP ICON]               ([OR (GETWINDOWPROP OW 'ICONP)                    (AND ALL (NOT (GETWINDOWPROP OW 'MAINWINDOW]                                                             (* ;                   "I have an ICONP property or else ALL is specified (unless I'm an attached window)")                                                             (* ; "treat as icon even though not")                (SETQ ICON OW))) do (SETQ REGION (WINDOWREGION ICON))                                    (SETQ H (fetch (REGION HEIGHT) of REGION))                                    (SETQ W (fetch (REGION WIDTH) of REGION))                                    (if (ILEQ (SELECTQ EDGE                                                  ((BOTTOM TOP BOTTOMRIGHT TOPRIGHT)                                                        SCREENWIDTH)                                                  (PROGN (swap W H)                                                         SCREENHEIGHT))                                              (IPLUS X W))                                        then (SETQ X 0)                                             (add Y MAXY SPACING)                                             (SETQ MAXY 0))                                    (SELECTQ EDGE                                        (BOTTOM (MOVEICON OW ICON X Y))                                        (BOTTOMRIGHT (MOVEICON OW ICON (IDIFFERENCE SCREENWIDTH                                                                              (IPLUS X W))                                                            Y))                                        (LEFT (MOVEICON OW ICON Y (IDIFFERENCE SCREENHEIGHT                                                                         (IPLUS X W))))                                        (LEFTBOTTOM (MOVEICON OW ICON Y X))                                        (TOP (MOVEICON OW ICON X (IDIFFERENCE SCREENHEIGHT                                                                        (IPLUS Y H))))                                        (TOPRIGHT (MOVEICON OW ICON (IDIFFERENCE SCREENWIDTH                                                                           (IPLUS X W))                                                         (IDIFFERENCE SCREENHEIGHT (IPLUS Y H))))                                        (RIGHT (MOVEICON OW ICON (IDIFFERENCE SCREENWIDTH                                                                        (IPLUS Y H))                                                      (IDIFFERENCE SCREENHEIGHT (IPLUS X W))))                                        (RIGHTBOTTOM (MOVEICON OW ICON (IDIFFERENCE SCREENWIDTH                                                                              (IPLUS Y H))                                                            X))                                        (SHOULDNT))                                    (add X W SPACING)                                    (SETQ MAXY (IMAX MAXY H]))(RPAQ? TINYTIDY.DEFAULT 'RIGHTBOTTOM)(RPAQ? TINYTIDY.DEFAULT.ALL 'LEFT)(COND ((NOT (FASSOC 'TinyTidy BackgroundMenuCommands))       (PUSH BackgroundMenuCommands '(TinyTidy (TINYTIDY)                                            "aligns all icons on screen edge"))       (SETQ BackgroundMenu NIL)))(PUTPROPS TINYTIDY COPYRIGHT ("Xerox Corporation" 1984 1985 1986))(DECLARE%: DONTCOPY  (FILEMAP (NIL (957 5852 (MOVEICON 967 . 1941) (TINYTIDY 1943 . 5850)))))STOP