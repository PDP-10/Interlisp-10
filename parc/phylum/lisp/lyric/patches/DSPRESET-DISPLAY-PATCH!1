(DEFINE-FILE-INFO READTABLE "XCL" PACKAGE "INTERLISP")(FILECREATED "19-Apr-88 14:30:29" {PHYLUM}<LISP>LYRIC>PATCHES>DSPRESET-DISPLAY-PATCH.\;1 2503         |changes| |to:|  (VARS DSPRESET-DISPLAY-PATCHCOMS) (FNS \\DSPRESET.DISPLAY)); Copyright (c) 1988 by Xerox Corporation.  All rights reserved.(PRETTYCOMPRINT DSPRESET-DISPLAY-PATCHCOMS)(RPAQQ DSPRESET-DISPLAY-PATCHCOMS ((* |;;| "correct missing \"don't create\" flag in call to WFROMDS in \\DSPRESET.DISPLAY") (* |;;| "this is fixed in source in Medley.") (FNS \\DSPRESET.DISPLAY)))(* |;;| "correct missing \"don't create\" flag in call to WFROMDS in \\DSPRESET.DISPLAY")(* |;;| "this is fixed in source in Medley.")(DEFINEQ(\\DSPRESET.DISPLAY(LAMBDA (DISPLAYSTREAM) (* \; "Edited 19-Apr-88 14:25 by Briggs") (DECLARE (GLOBALVARS \\CURRENTDISPLAYLINE)) (* \; "resets a display stream") (PROG (CREG FONT FONTASCENT (DD (\\DTEST (|fetch| (STREAM IMAGEDATA) |of| (SETQ DISPLAYSTREAM (\\OUTSTREAMARG DISPLAYSTREAM))) (QUOTE \\DISPLAYDATA)))) (SETQ CREG (|ffetch| (\\DISPLAYDATA |DDClippingRegion|) |of| DD)) (SETQ FONT (|fetch| (\\DISPLAYDATA DDFONT) |of| DD)) (SETQ FONTASCENT (FONTASCENT FONT)) (SELECTQ (|fetch| (FONTDESCRIPTOR ROTATION) |of| FONT) (0 (\\DSPXPOSITION.DISPLAY DISPLAYSTREAM (|ffetch| (\\DISPLAYDATA |DDLeftMargin|) |of| DD)) (\\DSPYPOSITION.DISPLAY DISPLAYSTREAM (ADD1 (IDIFFERENCE (|fetch| (REGION TOP) |of| CREG) FONTASCENT)))) (90 (\\DSPXPOSITION.DISPLAY DISPLAYSTREAM (IPLUS (|fetch| (REGION LEFT) |of| CREG) FONTASCENT)) (\\DSPYPOSITION.DISPLAY DISPLAYSTREAM (|fetch| (REGION BOTTOM) |of| CREG))) (270 (\\DSPXPOSITION.DISPLAY DISPLAYSTREAM (IDIFFERENCE (|fetch| (REGION RIGHT) |of| CREG) FONTASCENT)) (\\DSPYPOSITION.DISPLAY DISPLAYSTREAM (|fetch| (REGION TOP) |of| CREG))) (ERROR "only supported rotations are 0, 90 and 270")) (BITBLT NIL NIL NIL DISPLAYSTREAM (|fetch| (REGION LEFT) |of| CREG) (|fetch| (REGION BOTTOM) |of| CREG) (|fetch| (REGION WIDTH) |of| CREG) (|fetch| (REGION HEIGHT) |of| CREG) (QUOTE TEXTURE) (QUOTE REPLACE) (|ffetch| (\\DISPLAYDATA |DDTexture|) |of| DD)) (* |;;| "if this display stream is the tty display stream of a process, reset the # of lines in that process.") (PROG ((X (WFROMDS DISPLAYSTREAM T))) (COND ((AND X (SETQ X (WINDOWPROP X (QUOTE PROCESS))) (EQ (PROCESS.TTY X) DISPLAYSTREAM)) (PROCESS.EVAL X (QUOTE (SETQ \\CURRENTDISPLAYLINE 0))))))))))(PUTPROPS DSPRESET-DISPLAY-PATCH COPYRIGHT ("Xerox Corporation" 1988))(DECLARE\: DONTCOPY  (FILEMAP (NIL (712 2409 (\\DSPRESET.DISPLAY 722 . 2407)))))STOP