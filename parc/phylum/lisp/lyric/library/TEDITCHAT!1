(DEFINE-FILE-INFO §READTABLE "XCL" §PACKAGE "LISP")(IL:FILECREATED "20-Oct-86 15:05:37" IL:{DSK}<LISPFILES>TEDITCHAT.\;4 30286        IL:|changes| IL:|to:|  (IL:FNS IL:TEDITCHAT.MENUFN)      IL:|previous| IL:|date:| "20-Oct-86 14:45:50" IL:{DSK}<LISPFILES>TEDITCHAT.\;3); Copyright (c) 1985, 1986 by Xerox Corporation.  All rights reserved.(IL:PRETTYCOMPRINT IL:TEDITCHATCOMS)(IL:RPAQQ IL:TEDITCHATCOMS ((IL:COMS (IL:* IL:|character| IL:|routines|)                                   (IL:FNS IL:TEDITCHAT.CHARFN IL:\\TEXTSTREAMBOUT))                            (IL:COMS (IL:FNS IL:TEDITSTREAM.INIT IL:TEDITCHAT.MENUFN))                            (IL:COMS (IL:* IL:TEDIT IL:|update| IL:|routines|)                                   (IL:FNS IL:TEDIT.DISPLAYTEXT))                            (IL:GLOBALVARS IL:TEDITCHAT.MENU IL:CHAT.DRIVERTYPES IL:CHAT.DISPLAYTYPES                                   )                            (IL:VARS IL:TEDITCHAT.MENUITEMS (IL:TEDITCHAT.MENU))                            (IL:ADDVARS (IL:CHAT.DRIVERTYPES (IL:TEDIT IL:TEDITCHAT.CHARFN IL:NILL)))                            (IL:DECLARE\: IL:EVAL@COMPILE IL:DONTCOPY (IL:FILES (IL:SOURCE)                                                                             IL:CHATDECLS))))(IL:* IL:|character| IL:|routines|)(IL:DEFINEQ(IL:TEDITCHAT.CHARFN  (IL:LAMBDA (IL:CH IL:CHAT.STATE)                           (IL:* IL:AJB "22-May-85 18:16")    (LET* ((IL:TEXTSTREAM (IL:|fetch| (IL:CHAT.STATE IL:TEXTSTREAM) IL:|of| IL:CHAT.STATE))           (IL:SEL (IL:|fetch| IL:SEL IL:|of| (IL:TEXTOBJ IL:TEXTSTREAM))))          (IL:\\CARET.DOWN (IL:|fetch| IL:DS IL:|of| (IL:TEXTOBJ IL:TEXTSTREAM)))          (IL:SELCHARQ IL:CH                (IL:BS (IL:\\TEDIT.CHARDELETE IL:TEXTSTREAM "" IL:SEL)                       (IL:MOVETO (IL:|fetch| IL:X0 IL:|of| IL:SEL)                              (IL:|fetch| IL:Y0 IL:|of| IL:SEL)                              (CAR (IL:|fetch| IL:\\WINDOW IL:|of| (IL:TEXTOBJ IL:TEXTSTREAM)))))                (IL:LF NIL)                (IL:BOUT IL:TEXTSTREAM IL:CH)))))(IL:\\TEXTSTREAMBOUT  (IL:LAMBDA (STREAM BYTE)                                   (IL:* IL:AJB "21-May-85 16:00")                    (IL:* IL:D\o IL:BOUT IL:|to| IL:\a IL:|text| IL:|stream,| IL:|which| IL:|is|           IL:|an| IL:|insertion| IL:|at| IL:|the| IL:|caret.|)    (PROG ((IL:TEXTOBJ (IL:|fetch| (IL:TEXTSTREAM IL:TEXTOBJ) IL:|of| STREAM))           IL:CH# IL:WINDOW IL:TEXTLEN IL:PS IL:PC IL:PSTR IL:OFFST IL:SEL)          (IL:SETQ IL:TEXTLEN (IL:|fetch| IL:TEXTLEN IL:|of| IL:TEXTOBJ))          (IL:SETQ IL:WINDOW (IL:|fetch| IL:\\WINDOW IL:|of| IL:TEXTOBJ))          (IL:SETQ IL:SEL (IL:|fetch| IL:SEL IL:|of| IL:TEXTOBJ))          (COND             ((NOT (CAR (IL:|fetch| IL:L1 IL:|of| IL:SEL)))              (RETURN)))                    (IL:* IL:|Return| IL:|if| IL:|caret| IL:|out| IL:|of| IL:|bounds,| IL:|ie,|           IL:|user| IL:|scrolls| IL:|past| IL:|end| IL:|of| IL:|text|)          (IL:SETQ IL:CH# (IL:|fetch| IL:CH# IL:|of| IL:SEL))          (AND IL:WINDOW (IL:\\TEDIT.MARK.LINES.DIRTY IL:TEXTOBJ IL:CH# IL:CH#))          (IL:\\INSERTCH BYTE IL:CH# IL:TEXTOBJ)          (AND IL:WINDOW               (PROG ((IL:THISLINE (IL:|fetch| IL:THISLINE IL:|of| IL:TEXTOBJ))                      IL:EOLFLAG IL:CHORIG IL:CHWIDTH IL:OXLIM IL:OCHLIM IL:OCR\\END IL:PREVSPACE                       IL:FIXEDLINE IL:NEXTLINE IL:LINES IL:NEWLINEFLG IL:DX IL:PREVLINE IL:SAVEWIDTH                       IL:OFLOWFN IL:OLHEIGHT IL:DY IL:TABSEEN IL:IMAGECACHE IL:CURLINE IL:FONT                      (IL:L1 (CAR (IL:|fetch| IL:L1 IL:|of| IL:SEL)))                      (IL:LN (CAR (IL:|fetch| IL:LN IL:|of| IL:SEL)))                      (IL:LOOKS (IL:\\TEDIT.APPLY.STYLES (IL:|fetch| IL:CARETLOOKS IL:|of| IL:TEXTOBJ                                                                )                                       (IL:|fetch| IL:\\INSERTPC IL:|of| IL:TEXTOBJ)                                       IL:TEXTOBJ)))                     (IL:|add| (IL:|fetch| IL:CH# IL:|of| IL:SEL)                            1)                    (IL:* IL:|These| IL:|must| IL:|be| IL:|here,| IL:|since| IL:SEL\s IL:|are|           IL:|valid| IL:|even| IL:|without| IL:\a IL:|window.|)                     (IL:|replace| IL:CHLIM IL:|of| IL:SEL IL:|with| (IL:|fetch| IL:CH# IL:|of|                                                                                        IL:SEL))                     (IL:|replace| IL:POINT IL:|of| IL:SEL IL:|with| 'IL:LEFT)                     (IL:|replace| IL:DCH IL:|of| IL:SEL IL:|with| 0)                     (IL:|replace| IL:SELKIND IL:|of| IL:SEL IL:|with| 'IL:CHAR)                     (IL:SETQ IL:CURLINE IL:L1)                     (IL:|add| (IL:|fetch| IL:CHARLIM IL:|of| IL:CURLINE)                            1)                     (IL:|add| (IL:|fetch| IL:CHARTOP IL:|of| IL:CURLINE)                            1)                     (IL:SETQ IL:FONT (IL:|fetch| IL:CLFONT IL:|of| IL:LOOKS))                     (IL:DSPFONT IL:FONT (CAR IL:WINDOW))                     (COND                        ((OR (IL:IGREATERP (IL:PLUS (IL:|fetch| IL:X0 IL:|of| IL:SEL)                                                  (IL:CHARWIDTH BYTE IL:FONT))                                    (IL:IDIFFERENCE (IL:|fetch| IL:WRIGHT IL:|of| IL:TEXTOBJ)                                           8))                             (IL:IEQP BYTE (IL:CHARCODE IL:CR)))                    (IL:* IL:|gone| IL:|off| IL:|the| IL:|edge| IL:|of| IL:|the| IL:|line|           IL:|reformat| IL:|and| IL:|add| IL:|new| IL:|line|)                         (IL:TEDIT.UPDATE.SCREEN IL:TEXTOBJ)                         (IL:\\FIXSEL IL:SEL IL:TEXTOBJ (CAR IL:WINDOW))                         (IL:SETQ IL:L1 (CAR (IL:|fetch| IL:L1 IL:|of| IL:SEL)))                         (IL:SETQ IL:LN (CAR (IL:|fetch| IL:LN IL:|of| IL:SEL)))                         (COND                            ((OR (NULL (IL:SELECTQ (IL:|fetch| IL:POINT IL:|of| IL:SEL)                                             (IL:LEFT IL:L1)                                             (IL:RIGHT IL:LN)                                             NIL))                                 (IL:ILEQ (IL:SELECTQ (IL:|fetch| IL:POINT IL:|of| IL:SEL)                                                (IL:LEFT (IL:|fetch| IL:YBOT IL:|of| IL:L1))                                                (IL:RIGHT (IL:|fetch| IL:YBOT IL:|of| IL:LN))                                                0)                                        (IL:|fetch| IL:BOTTOM IL:|of| (IL:DSPCLIPPINGREGION                                                                       NIL                                                                       (CAR IL:WINDOW)))))                    (IL:* IL:|The| IL:|caret| IL:|is| IL:|off-window| IL:|in| IL:|the|           IL:|selection| IL:|window.| IL:|Need| IL:|to| IL:|scroll| IL:|it| IL:|up|           IL:|so| IL:|the| IL:|caret| IL:|is| IL:|visible.|)                             (IL:|while| (OR (IL:ILESSP (IL:|fetch| IL:Y0 IL:|of| IL:SEL)                                                    (IL:|fetch| IL:WBOTTOM IL:|of| IL:TEXTOBJ))                                             (IL:IGEQ (IL:|fetch| IL:Y0 IL:|of| IL:SEL)                                                    (IL:|fetch| IL:WTOP IL:|of| IL:TEXTOBJ)))                                IL:|do|                      (IL:* IL:|The| IL:|caret| IL:|just|                                                              IL:|went| IL:|off-screen.|                                                             IL:|Move| IL:|it| IL:|up| IL:|some.|)                                      (IL:|replace| IL:EDITOPACTIVE IL:|of| IL:TEXTOBJ IL:|with|                                                                                       NIL)                                      (IL:SCROLLW (CAR IL:WINDOW)                                             0                                             (IL:LLSH (COND                                                         ((IL:SELECTQ (IL:|fetch| IL:POINT                                                                         IL:|of| IL:SEL)                                                                (IL:LEFT IL:L1)                                                                (IL:RIGHT IL:LN)                                                                NIL)                                                          (IL:|fetch| IL:LHEIGHT                                                             IL:|of| (IL:SELECTQ (IL:|fetch| IL:POINT                                                                                    IL:|of| IL:SEL)                                                                           (IL:LEFT IL:L1)                                                                           (IL:RIGHT IL:LN)                                                                           (IL:SHOULDNT))))                                                         (T 12))                                                    1))))))                        (T (IL:TEDIT.DISPLAYTEXT IL:TEXTOBJ BYTE (IL:CHARWIDTH BYTE IL:FONT)                                  IL:CURLINE                                  (IL:|fetch| IL:X0 IL:|of| IL:SEL)                                  (CAR IL:WINDOW)                                  IL:SEL)                    (IL:* IL:|Print| IL:|out| IL:|the|                                                              IL:|character| IL:|on| IL:|the|                                                              IL:|screen|)                           (IL:|add| (IL:|fetch| IL:X0 IL:|of| IL:SEL)                                  (IL:CHARWIDTH BYTE IL:FONT))                    (IL:* IL:|And| IL:|move| IL:|the| IL:|selection's| IL:|notion| IL:|of| IL:|our|           IL:X IL:|position| IL:|to| IL:|the| IL:|right| IL:|to| IL:|account| IL:|for|           IL:|that| IL:|character's| IL:|width.|)                           (IL:|replace| IL:XLIM IL:|of| IL:SEL IL:|with| (IL:|fetch| IL:X0                                                                             IL:|of| IL:SEL))))                    (IL:* IL:* IL:|Fix| IL:|up| IL:|the| IL:TEXTSTREAM IL:|so| IL:|that| IL:|the|           IL:FILEPTR IL:|looks| IL:|like| IL:|it| IL:|ought| IL:|to| IL:|after| IL:|the|           IL:BOUT\, IL:|even| IL:|though| IL:|we've| IL:|been| IL:|updating| IL:|the|           IL:|screen| (IL:|which| IL:|usually| IL:|moves| IL:|the| IL:|fileptr....|))                     (IL:SETQ IL:PS (IL:|ffetch| IL:PSTR IL:|of| (IL:SETQ IL:PC (IL:|fetch|                                                                                        IL:\\INSERTPC                                                                                   IL:|of| IL:TEXTOBJ                                                                                       ))))                    (IL:* IL:|This| IL:|piece| IL:|resides| IL:|in| IL:\a IL:STRING.          IL:|Because| IL:|it's| IL:|newly| "typed" IL:|material.|)                     (IL:|replace| (IL:TEXTSTREAM IL:PIECE) IL:|of| STREAM IL:|with| IL:PC)                                                             (IL:* IL:|Remember| IL:|the|                                                              IL:|current| IL:|piece| IL:|for|                                                              IL:|others.|)                     (IL:|replace| (IL:TEXTSTREAM IL:PCNO) IL:|of| STREAM                        IL:|with| (IL:|fetch| IL:\\INSERTPCNO IL:|of| IL:TEXTOBJ))                                                             (IL:* IL:|And| IL:|which| IL:|number|                                                              IL:|piece| IL:|this| IL:|is.|)                     (IL:|freplace| IL:CPPTR IL:|of| STREAM                        IL:|with| (IL:ADDBASE (IL:|ffetch| (IL:STRINGP IL:BASE) IL:|of| IL:PS)                                         (IL:LRSH (IL:SETQ IL:OFFST (IL:|ffetch| (IL:STRINGP IL:OFFST                                                                                        )                                                                       IL:|of| IL:PS))                                                1)))         (IL:* IL:|Pointer| IL:|to| IL:|the|                                                              IL:|actual| IL:|characters| IL:|in|                                                              IL:|the| IL:|string|                                                             (IL:|allowing| IL:|for|                                                              IL:|substrings.|))                     (IL:|freplace| IL:CPAGE IL:|of| STREAM IL:|with| 0)                     (IL:|freplace| IL:COFFSET IL:|of| STREAM IL:|with| (IL:IPLUS (IL:|freplace|                                                                                   (IL:TEXTSTREAM                                                                                    IL:PCSTARTCH)                                                                                     IL:|of| STREAM                                                                                     IL:|with|                                                                                     (LOGAND 1                                                                                             IL:OFFST)                                                                                   )                                                                               (IL:|fetch|                                                                                       IL:\\INSERTLEN                                                                                  IL:|of| IL:TEXTOBJ)                                                                               ))                     (IL:|freplace| (IL:TEXTSTREAM IL:PCSTARTPG) IL:|of| STREAM IL:|with| 0)                                                             (IL:* IL:|Page| IL:\# IL:|within|                                                              IL:|the| "file" IL:|where| IL:|this|                                                              IL:|piece| IL:|starts|)                     (IL:|freplace| IL:CBUFSIZE IL:|of| STREAM IL:|with| (IL:|fetch| IL:COFFSET                                                                            IL:|of| STREAM))                     (IL:|freplace| IL:EPAGE IL:|of| STREAM IL:|with| 1)                     (IL:|freplace| (IL:TEXTSTREAM IL:CHARSLEFT) IL:|of| STREAM IL:|with| 0)                                                             (IL:* IL:|We're,| IL:|perforce,|                                                              IL:|at| IL:|the| IL:|end| IL:|of|                                                              IL:|the| IL:|piece.|)                     (IL:|freplace| (IL:TEXTSTREAM IL:REALFILE) IL:|of| STREAM IL:|with| NIL)                                                             (IL:* IL:|We're| IL:|not| IL:|on|                                                              IL:\a IL:|file....|)                 ))))))(IL:DEFINEQ(IL:TEDITSTREAM.INIT  (IL:LAMBDA (IL:WINDOW IL:MENUFN)                           (IL:* IL:AJB "24-May-85 14:36")                                                             (IL:* IL:|Initialize| IL:|and|                                                              IL:|return| IL:TEDIT IL:TEXTSTREAM)    (PROG* ((IL:TEXTSTREAM (IL:OPENTEXTSTREAM NIL IL:WINDOW NIL NIL '(IL:READONLY T)))            (IL:TEXTOBJ (IL:TEXTOBJ IL:TEXTSTREAM)))                    (IL:* IL:|force| IL:|shift| IL:|select| IL:|typein| IL:|to| IL:|be| IL:|put|           IL:|in| IL:|keyboard| IL:|buffer|)           (IL:TEXTPROP IL:TEXTSTREAM 'IL:COPYBYBKSYSBUF T)           (IL:|replace| IL:STRMBOUTFN IL:|of| IL:TEXTSTREAM IL:|with| 'IL:\\TEXTSTREAMBOUT)           (IL:|replace| SET IL:|of| (IL:|fetch| IL:SEL IL:|of| IL:TEXTOBJ) IL:|with| T)           (IL:|replace| IL:L1 IL:|of| (IL:|fetch| IL:SEL IL:|of| IL:TEXTOBJ)              IL:|with| (LIST (IL:|fetch| IL:DESC IL:|of| (IL:|fetch| IL:THISLINE IL:|of| IL:TEXTOBJ)                                     )))                     (IL:* IL:|hookup| IL:|middle|                                                              IL:|button| IL:|menu| IL:|instead|                                                              IL:|of| IL:TEDIT IL:|menu|)           (IL:WINDOWPROP IL:WINDOW 'IL:TEDIT.TITLEMENUFN IL:MENUFN)           (RETURN IL:TEXTSTREAM))))(IL:TEDITCHAT.MENUFN  (IL:LAMBDA (IL:WINDOW)                                     (IL:* IL:|| "20-Oct-86 15:03")    (DECLARE (IL:GLOBALVARS IL:TEDITCHAT.MENU)           (IL:SPECVARS IL:WINDOW IL:STATE))                 (IL:* IL:MIDDLEBUTTON)    (PROG ((IL:STATE (IL:WINDOWPROP IL:WINDOW 'IL:CHATSTATE))           IL:COMMAND)          (COND             ((NOT IL:STATE)                                 (IL:* IL:N\o IL:|Connection|                                                              IL:|here;| IL:|try| IL:|to|                                                              IL:|reestablish|)              (RETURN (COND                         ((IL:LASTMOUSESTATE IL:MIDDLE)                          (IL:CHAT.RECONNECT IL:WINDOW))                         (T (IL:TOTOPW IL:WINDOW))))))          (IL:|replace| (IL:CHAT.STATE IL:HELD) IL:|of| IL:STATE IL:|with| T)          (IL:\\CHECKCARET IL:WINDOW)          (IL:SELECTQ (IL:SETQ IL:COMMAND (IL:MENU (OR IL:TEDITCHAT.MENU (IL:SETQ IL:TEDITCHAT.MENU                                                                          (IL:|create| IL:MENU                                                                                 IL:ITEMS IL:_                                                                                IL:TEDITCHAT.MENUITEMS                                                                                 )))))                (IL:|Close| (IL:|replace| (IL:CHAT.STATE IL:RUNNING?) IL:|of| IL:STATE                               IL:|with| 'IL:CLOSE)          (IL:* IL:|Ask| IL:CHAT.TYPEIN IL:|to|                                                              IL:|shut| IL:|things| IL:|down.|)                            )                (IL:|New| (IL:|replace| (IL:CHAT.STATE IL:RUNNING?) IL:|of| IL:STATE                             IL:|with| 'IL:CLOSE)                          (IL:WINDOWPROP IL:WINDOW 'IL:KEEPCHAT 'IL:NEW))                (IL:|Suspend| (IL:|replace| (IL:CHAT.STATE IL:RUNNING?) IL:|of| IL:STATE                                 IL:|with| 'IL:CLOSE)                              (IL:WINDOWPROP IL:WINDOW 'IL:KEEPCHAT T))                (IL:|Freeze|                                 (IL:* IL:|Leave| IL:|in| IL:HELD                                                              IL:|state|)                             (RETURN))                (NIL)                (IL:APPLY* IL:COMMAND IL:STATE IL:WINDOW))          (IL:|replace| (IL:CHAT.STATE IL:HELD) IL:|of| IL:STATE IL:|with| NIL)))))(IL:* IL:TEDIT IL:|update| IL:|routines|)(IL:DEFINEQ(IL:TEDIT.DISPLAYTEXT  (IL:LAMBDA (IL:TEXTOBJ IL:CH IL:CHWIDTH IL:LINE IL:XPOINT IL:DS IL:SEL)                                                             (IL:* IL:AJB "10-May-85 15:53")                    (IL:* IL:|This| IL:|function| IL:|does| IL:|the| IL:|actual| IL:|displaying|           IL:|of| IL:|typed-in| IL:|text| IL:|on| IL:|the| IL:|edit| IL:|window.|)    (PROG ((IL:LOOKS (IL:\\TEDIT.APPLY.STYLES (IL:|fetch| IL:CARETLOOKS IL:|of| IL:TEXTOBJ)                            (IL:|fetch| IL:\\INSERTPC IL:|of| IL:TEXTOBJ)                            IL:TEXTOBJ))           (IL:TERMSA (IL:|fetch| IL:TXTTERMSA IL:|of| IL:TEXTOBJ))           IL:DY IL:FONT)          (IL:MOVETO IL:XPOINT (IL:IPLUS (IL:|fetch| IL:YBASE IL:|of| IL:LINE)                                      (OR (IL:|fetch| IL:CLOFFSET IL:|of| IL:LOOKS)                                          0))                 IL:DS)                                      (IL:* IL:|Set| IL:|the| IL:|display|                                                              IL:|stream| IL:|position|)          (COND             (IL:TERMSA                                      (IL:* IL:|Special| IL:|terminal|                                                              IL:|table| IL:|for| IL:|controlling|                                                              IL:|character| IL:|display.|                                                             IL:|Use| IL:|it.|)                    (IL:RESETLST (IL:RESETSAVE IL:\\PRIMTERMSA IL:TERMSA)                           (IL:|replace| (IL:TEXTSTREAM IL:REALFILE) IL:|of| (IL:|fetch|                                                                                     IL:STREAMHINT                                                                                IL:|of| IL:TEXTOBJ)                              IL:|with| IL:DS)                           (COND                              ((IL:STRINGP IL:CH)                               (IL:|for| IL:CHAR IL:|instring| IL:CH                                  IL:|do| (IL:SELCHARQ IL:CHAR                                                (IL:TAB      (IL:* IL:|Put| IL:|down| IL:|white|)                                                        (IL:BITBLT NIL 0 0 IL:DS IL:XPOINT                                                               (IL:|fetch| IL:YBOT IL:|of| IL:LINE)                                                               36                                                               (IL:|fetch| IL:LHEIGHT IL:|of| IL:LINE                                                                      )                                                               'IL:TEXTURE                                                               'IL:REPLACE IL:WHITESHADE)                                                        (IL:RELMOVETO 36 0 IL:DS))                                                (IL:CR (IL:BITBLT NIL 0 0 IL:DS IL:XPOINT                                                              (IL:|fetch| IL:YBOT IL:|of| IL:LINE)                                                              (IL:IMAX 6 (IL:CHARWIDTH IL:CHAR                                                                                 IL:FONT))                                                              (IL:|fetch| IL:LHEIGHT IL:|of| IL:LINE)                                                              'IL:TEXTURE                                                              'IL:REPLACE IL:WHITESHADE))                                                (IL:\\DSPPRINTCHAR (IL:|fetch| IL:STREAMHINT                                                                      IL:|of| IL:TEXTOBJ)                                                       IL:CHAR))))                              (T (IL:SELCHARQ IL:CH                                       (IL:TAB               (IL:* IL:|Put| IL:|down| IL:|white|)                                               (IL:BITBLT NIL 0 0 IL:DS IL:XPOINT                                                      (IL:|fetch| IL:YBOT IL:|of| IL:LINE)                                                      36                                                      (IL:|fetch| IL:LHEIGHT IL:|of| IL:LINE)                                                      'IL:TEXTURE                                                      'IL:REPLACE IL:WHITESHADE)                                               (IL:RELMOVETO 36 0 IL:DS))                                       (IL:CR (IL:BITBLT NIL 0 0 IL:DS IL:XPOINT                                                     (IL:|fetch| IL:YBOT IL:|of| IL:LINE)                                                     (IL:IMAX 6 (IL:CHARWIDTH IL:CH IL:FONT))                                                     (IL:|fetch| IL:LHEIGHT IL:|of| IL:LINE)                                                     'IL:TEXTURE                                                     'IL:REPLACE IL:WHITESHADE))                                       (IL:\\DSPPRINTCHAR (IL:|fetch| IL:STREAMHINT IL:|of|                                                                                           IL:TEXTOBJ)                                              IL:CH))))))             (T                                              (IL:* IL:N\o IL:|special|                                                              IL:|handling;| IL:|just| IL:|use|                                                              IL:|native| IL:|character| IL:|codes|)                (COND                   ((IL:STRINGP IL:CH)                    (IL:|for| IL:CHAR IL:|instring| IL:CH                       IL:|do| (IL:SELCHARQ IL:CHAR                                     (IL:TAB                 (IL:* IL:|Put| IL:|down| IL:|white|)                                             (IL:BITBLT NIL 0 0 IL:DS (IL:DSPXPOSITION NIL IL:DS)                                                    (IL:|fetch| IL:YBOT IL:|of| IL:LINE)                                                    36                                                    (IL:|fetch| IL:LHEIGHT IL:|of| IL:LINE)                                                    'IL:TEXTURE                                                    'IL:REPLACE IL:WHITESHADE)                                             (IL:RELMOVETO 36 0 IL:DS))                                     (IL:CR (IL:BITBLT NIL 0 0 IL:DS (IL:DSPXPOSITION NIL IL:DS)                                                   (IL:|fetch| IL:YBOT IL:|of| IL:LINE)                                                   (IL:IMAX 6 (IL:CHARWIDTH IL:CHAR IL:FONT))                                                   (IL:|fetch| IL:LHEIGHT IL:|of| IL:LINE)                                                   'IL:TEXTURE                                                   'IL:REPLACE IL:WHITESHADE))                                     (IL:BLTCHAR IL:CHAR IL:DS))))                   (T (IL:SELCHARQ IL:CH                            (IL:TAB                          (IL:* IL:|Put| IL:|down| IL:|white|)                                    (IL:BITBLT NIL 0 0 IL:DS (IL:DSPXPOSITION NIL IL:DS)                                           (IL:|fetch| IL:YBOT IL:|of| IL:LINE)                                           36                                           (IL:|fetch| IL:LHEIGHT IL:|of| IL:LINE)                                           'IL:TEXTURE                                           'IL:REPLACE IL:WHITESHADE)                                    (IL:RELMOVETO 36 0 IL:DS))                            (IL:CR                           (IL:* IL:|Blank| IL:|out| IL:|the|                                                              IL:|CR's| IL:|width.|)                                   (IL:BITBLT NIL 0 0 IL:DS (IL:DSPXPOSITION NIL IL:DS)                                          (IL:|fetch| IL:YBOT IL:|of| IL:LINE)                                          (IL:IMAX 6 (IL:CHARWIDTH IL:CH IL:FONT))                                          (IL:|fetch| IL:LHEIGHT IL:|of| IL:LINE)                                          'IL:TEXTURE                                          'IL:REPLACE IL:WHITESHADE))                            (IL:BLTCHAR IL:CH IL:DS))))))))))(IL:DECLARE\: IL:DOEVAL@COMPILE IL:DONTCOPY(IL:GLOBALVARS IL:TEDITCHAT.MENU IL:CHAT.DRIVERTYPES IL:CHAT.DISPLAYTYPES))(IL:RPAQQ IL:TEDITCHAT.MENUITEMS ((IL:|Close| 'IL:|Close| "Closes the connection and returns")                                  (IL:|Suspend| 'IL:|Suspend|                                          "Closes the connection but leaves window up")                                  (IL:|New| 'IL:|New|                                          "Closes this connection and prompts for a new host")                                  (IL:|Freeze| 'IL:|Freeze|                                          "Holds typeout in this window until you bug it again")                                  ("Dribble" (IL:FUNCTION IL:CHAT.TYPESCRIPT)                                         "Starts a typescript of window typeout")                                  ("Input" (IL:FUNCTION IL:CHAT.TAKE.INPUT)                                         "Allows input from a file")                                  ("Option" (IL:FUNCTION IL:DO.CHAT.OPTION)                                         "Do protocol specific option")))(IL:RPAQQ IL:TEDITCHAT.MENU NIL)(IL:ADDTOVAR IL:CHAT.DRIVERTYPES (IL:TEDIT IL:TEDITCHAT.CHARFN IL:NILL))(IL:DECLARE\: IL:EVAL@COMPILE IL:DONTCOPY (IL:FILESLOAD (IL:SOURCE)       IL:CHATDECLS))(IL:PUTPROPS IL:TEDITCHAT IL:COPYRIGHT ("Xerox Corporation" 1985 1986))(IL:DECLARE\: IL:DONTCOPY  (IL:FILEMAP (NIL (1340 16139 (IL:TEDITCHAT.CHARFN 1353 . 2184) (IL:\\TEXTSTREAMBOUT 2186 . 16137)) (16140 20274 (IL:TEDITSTREAM.INIT 16153 . 17655) (IL:TEDITCHAT.MENUFN 17657 . 20272)) (20325 28844 (IL:TEDIT.DISPLAYTEXT 20338 . 28842)))))IL:STOP