<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
    <title>File [phylum]&lt;LISP>Lyric>LIBRARY>HELPSYS!1</title>
  </head>
  <body>
    <pre>
(FILECREATED "10-Oct-86 10:54:27" {ERIS}&lt;LISPCORE&gt;LIBRARY&gt;HELPSYS.;28 28976        changes to:  (VARS HELPSYSCOMS)      previous date: "10-Jun-86 15:22:07" {ERIS}&lt;LISPCORE&gt;LIBRARY&gt;HELPSYS.;27)(* "Copyright (c) 1985, 1986 by Xerox Corporation.  All rights reserved.")(PRETTYCOMPRINT HELPSYSCOMS)(RPAQQ HELPSYSCOMS ((FILES DINFO HASH)                    (DECLARE: EVAL@COMPILE DONTCOPY (RECORDS IRMREFERENCE)                           (FILES (LOADCOMP)                                  DINFO HASH))                    [COMS (FNS HELPSYS IRM.LOOKUP IRM.SMART.LOOKUP IRM.RESET \IRM.INSTALL?DEDITMACRO)                          (INITVARS (IRM.HOST&amp;DIR)                                 (IRM.HASHFILE.NAME))                          (GLOBALVARS IRM.HOST&amp;DIR IRM.HASHFILE.NAME)                          (DECLARE: DONTEVAL@LOAD DOCOPY (P (MOVD (QUOTE HELPSYS)                                                                  (QUOTE XHELPSYS)                                                                  NIL T)                                                            (\IRM.INSTALL?DEDITMACRO]                    (COMS (* * "Interface to DInfo")                          (FNS IRM.GET.DINFOGRAPH IRM.DISPLAY.REF)                          [ADDVARS (DINFO.GRAPHS ("Interlisp-D Reference Manual" (IRM.GET.DINFOGRAPH                                                                                  T]                          (INITVARS (IRM.DINFOGRAPH))                          (GLOBALVARS IRM.DINFOGRAPH)                          (* "Cross reference imageobj")                          (FNS IRM.DISPLAY.CREF IRM.CREF.BOX IRM.PUT.CREF IRM.GET.CREF                                IRM.CREF.BUTTONEVENTFN)                          [INITVARS (IRM.CREF.FONT (FONTCREATE (QUOTE MODERN)                                                          8                                                          (QUOTE MRR)))                                 (\IRM.CREF.IMAGEFNS (IMAGEFNSCREATE (FUNCTION IRM.DISPLAY.CREF)                                                            (FUNCTION IRM.CREF.BOX)                                                            (FUNCTION IRM.PUT.CREF)                                                            (FUNCTION IRM.GET.CREF)                                                            (FUNCTION NILL)                                                            (FUNCTION IRM.CREF.BUTTONEVENTFN]                          (GLOBALVARS IRM.CREF.FONT \IRM.CREF.IMAGEFNS))                    (COMS (* * "Internal functions and variables")                          (FNS \IRM.GET.REF \IRM.SMART.REF \IRM.CHOOSE.REF \IRM.WILD.REF                                \IRM.WILDCARD \IRM.WILD.MATCH \IRM.GET.HASHFILE \IRM.GET.KEYWORDS)                          (INITVARS (\IRM.HASHFILE)                                 (\IRM.KEYWORDS))                          (GLOBALVARS \IRM.HASHFILE \IRM.KEYWORDS))))(FILESLOAD DINFO HASH)(DECLARE: EVAL@COMPILE DONTCOPY [DECLARE: EVAL@COMPILE (RECORD IRMREFERENCE (TYPE ITEM PRIMARYFLG NODE CH#))](FILESLOAD (LOADCOMP)       DINFO HASH))(DEFINEQ(HELPSYS  [LAMBDA (FN PROPS)                                         (* drc: "20-Jan-86 18:05")    (if (NOT IRM.HOST&amp;DIR)        then (PROMPTPRINT "HELPSYS is unavailable.  Set IRM.HOST&amp;DIR.")             NIL      else (SELECTQ PROPS               (ARGS                                         (* HELPSYS is called by SMARTARGLIST                                                              to get args, but this implementation                                                              does not support that.)                     NIL)               (FromDEdit                                    (* from ? under EditCom)                          (IRM.LOOKUP (if (LISTP FN)                                          then (CAR FN)                                        else FN))                          NIL)               (NIL                                          (* called by TTYIN &lt;actually XHELPSYS                                                              is...&gt; when FN...? &lt;CR&gt; is typed.)                    (if (FGETD FN)                        then (IRM.LOOKUP FN (QUOTE Function))                      elseif (for MACRO.TYPE in MACROPROPS thereis (GETPROP FN MACRO.TYPE))                        then (IRM.LOOKUP FN (QUOTE Macro)                                    IRMWINDOW)                      elseif (SELECTQ (CAR (GETPROP FN (QUOTE CLISPWORD)))                                 (NIL)                                 (FORWORD (IRM.LOOKUP FN (QUOTE I.S.Operator)))                                 (RECORDTRAN (IRM.LOOKUP FN (QUOTE RecordOperator)))                                 (PROGN (IRM.LOOKUP FN NIL)))                      else (BEEP)))               NIL])(IRM.LOOKUP  [LAMBDA (KEYWORD TYPE GRAPH SMARTFLG)                      (* drc: "17-Jan-86 14:09")                    (* * Does a lookup in the IRM index for KEYWORD          (optionally of TYPE) and visits the DInfo node in GRAPH containing the           reference. If SMARTFLG is non-NIL, wildcards will be enabled.          GRAPH defaults to IRM.DINFOGRAPH.)    (LET* [(GRAPH (if (type? DINFOGRAPH GRAPH)                      then GRAPH                    else (IRM.GET.DINFOGRAPH)))           (KEYWORD (MKATOM (U-CASE KEYWORD)))           (TYPE (MKATOM TYPE))           (WINDOW (fetch (DINFOGRAPH WINDOW) of GRAPH))           (MONITORLOCK (DINFOGRAPHPROP GRAPH (QUOTE MONITORLOCK]          (OPENW WINDOW)          (if (OBTAIN.MONITORLOCK MONITORLOCK T)              then [RESETLST (RESETSAVE (TTYDISPLAYSTREAM (GETPROMPTWINDOW WINDOW)))                          (RESETSAVE NIL (LIST (QUOTE RELEASE.MONITORLOCK)                                               MONITORLOCK))                          (LET [(REF (if SMARTFLG                                         then (\IRM.SMART.REF KEYWORD WINDOW)                                       else (\IRM.GET.REF KEYWORD TYPE WINDOW]                               (AND REF (IRM.DISPLAY.REF REF GRAPH]            else (FLASHWINDOW WINDOW])(IRM.SMART.LOOKUP  [LAMBDA (KEYWORD GRAPH)                                    (* drc: " 6-Jan-86 14:50")    (IRM.LOOKUP KEYWORD NIL GRAPH T])(IRM.RESET  [LAMBDA NIL                                                (* drc: "27-Jan-86 11:19")    (if (type? DINFOGRAPH IRM.DINFOGRAPH)        then (LET ((W (fetch (DINFOGRAPH WINDOW) of IRM.DINFOGRAPH)))                  (OPENW W)                  (CLOSEW W)))    (SETQ IRM.DINFOGRAPH)    (CLOSEHASHFILE \IRM.HASHFILE)    (SETQ \IRM.HASHFILE)    (SETQ \IRM.KEYWORDS])(\IRM.INSTALL?DEDITMACRO  [LAMBDA NIL                                                (* bvm: " 4-Jun-86 19:01")    [for ITEM in *DEDIT-MENU-COMMANDS* when (EQ (CAR ITEM)                                                (QUOTE EditCom))       do (RETURN (for TAIL on (CDDR ITEM) bind [NEWITEM &larr; (QUOTE (? (HELPSYS (CAR (TOPSELECTION))                                                                            (QUOTE FromDEdit]                     when (STRING-EQUAL (CAR (CAR TAIL))                                 "?=") do (COND                                             ((AND (LISTP (CDR TAIL))                                                   (STRING-EQUAL (CAR (CAR TAIL))                                                          (CAR NEWITEM)))                                                             (* "Replace existing ? def")                                              (RETURN (/RPLACA (CDR TAIL)                                                             NEWITEM)))                                             (T              (*                                                           "Else stuff new def following the ?= macro")                                                (RETURN (/RPLACD TAIL (CONS NEWITEM (CDR TAIL]    (/SET (QUOTE \DEDITMNUW)          NIL]))(RPAQ? IRM.HOST&amp;DIR )(RPAQ? IRM.HASHFILE.NAME )(DECLARE: DOEVAL@COMPILE DONTCOPY(GLOBALVARS IRM.HOST&amp;DIR IRM.HASHFILE.NAME))(DECLARE: DONTEVAL@LOAD DOCOPY (MOVD (QUOTE HELPSYS)      (QUOTE XHELPSYS)      NIL T)(\IRM.INSTALL?DEDITMACRO))(* * "Interface to DInfo")(DEFINEQ(IRM.GET.DINFOGRAPH  [LAMBDA (FROM.BACKGROUND?)                                 (* jow "10-Jun-86 15:21")                    (* * returns the DInfo graph for the IRM)    (DECLARE (GLOBALVARS IRM.DINFOGRAPH IRM.HOST&amp;DIR))    (RESETLST [RESETSAVE NIL (QUOTE (AND RESETSTATE (IRM.RESET]           (LET (FILE W)                (if (type? DINFOGRAPH IRM.DINFOGRAPH)                    then IRM.DINFOGRAPH                  elseif (SETQ FILE (INFILEP (PACKFILENAME (QUOTE NAME)                                                    (QUOTE IRM)                                                    (QUOTE EXTENSION)                                                    (QUOTE DINFOGRAPH)                                                    (QUOTE BODY)                                                    IRM.HOST&amp;DIR)))                    then (SETQ W (CREATEW (GETBOXREGION 540 400 NIL NIL NIL                                                  "Specify region for IRM DInfo Window")                                        "IRM DInfo Graph"))                         [RESETSAVE NIL (BQUOTE (AND RESETSTATE (CLOSEW %, W]                         (SETQ IRM.DINFOGRAPH (DINFO FILE W T (NOT FROM.BACKGROUND?)))                  else (ERROR IRM.HOST&amp;DIR "IRM.DINFOGRAPH not found on IRM.HOST&amp;DIR"])(IRM.DISPLAY.REF  [LAMBDA (REF GRAPH)                                        (* drc: "18-Jan-86 17:17")                    (* * visit the DInfo node of GRAPH containing REF)    (LET [(NODE (FASSOC (fetch (IRMREFERENCE NODE) of REF)                       (fetch (DINFOGRAPH NODELST) of GRAPH]         (if NODE             then (DINFO.UPDATE GRAPH NODE (LIST (fetch (IRMREFERENCE ITEM) of REF)                                                 (fetch (IRMREFERENCE CH#) of REF)))           else (PRINTOUT (GETPROMPTWINDOW WINDOW)                       T "Node not found!"]))(ADDTOVAR DINFO.GRAPHS ("Interlisp-D Reference Manual" (IRM.GET.DINFOGRAPH T)))(RPAQ? IRM.DINFOGRAPH )(DECLARE: DOEVAL@COMPILE DONTCOPY(GLOBALVARS IRM.DINFOGRAPH))(* "Cross reference imageobj")(DEFINEQ(IRM.DISPLAY.CREF  [LAMBDA (IMAGEOBJ STREAM)                                  (* drc: " 7-Jan-86 13:41")    (if (EQ (IMAGESTREAMTYPE STREAM)            (QUOTE DISPLAY))        then (DSPFONT IRM.CREF.FONT STREAM)             (LET* ((STRING (IMAGEOBJPROP IMAGEOBJ (QUOTE ITEM)))                    (STRINGREGION (STRINGREGION STRING STREAM))                    (LEFT (ADD1 (fetch (REGION LEFT) of STRINGREGION)))                    (BOTTOM (fetch (REGION BOTTOM) of STRINGREGION))                    (REGION (create REGION                                   LEFT &larr; LEFT                                   BOTTOM &larr; BOTTOM                                   HEIGHT &larr; (IPLUS (fetch (REGION HEIGHT) of STRINGREGION)                                                   2)                                   WIDTH &larr; (IPLUS (fetch (REGION WIDTH) of STRINGREGION)                                                  6)))                    (TOP (fetch (REGION TOP) of REGION))                    (RIGHT (fetch (REGION RIGHT) of REGION)))                   (IMAGEOBJPROP IMAGEOBJ (QUOTE REGION)                          REGION)                   (CENTERPRINTINREGION STRING REGION STREAM)                   (DRAWLINE LEFT BOTTOM LEFT (SUB1 TOP)                          1                          (QUOTE INVERT)                          STREAM)                   (DRAWLINE LEFT TOP (SUB1 RIGHT)                          TOP 1 (QUOTE INVERT)                          STREAM)                   (DRAWLINE RIGHT TOP RIGHT (ADD1 BOTTOM)                          1                          (QUOTE INVERT)                          STREAM)                   (DRAWLINE RIGHT BOTTOM (ADD1 LEFT)                          BOTTOM 1 (QUOTE INVERT)                          STREAM))      else (PRIN1 "page X.XX" STREAM])(IRM.CREF.BOX  [LAMBDA (IMAGEOBJ STREAM CURRENTX RIGHTMARGIN)             (* drc: " 7-Jan-86 13:42")    (LET ((TYPE (IMAGESTREAMTYPE STREAM)))         (create IMAGEBOX                XSIZE &larr; (SELECTQ TYPE                            (DISPLAY (IPLUS (STRINGWIDTH (IMAGEOBJPROP IMAGEOBJ (QUOTE ITEM))                                                   IRM.CREF.FONT)                                            8))                            (STRINGWIDTH "page X.XX" STREAM))                YSIZE &larr; (SELECTQ TYPE                            (DISPLAY (IPLUS (FONTHEIGHT IRM.CREF.FONT)                                            4))                            (FONTHEIGHT STREAM))                YDESC &larr; (SELECTQ TYPE                            (DISPLAY 4)                            0)                XKERN &larr; 0])(IRM.PUT.CREF  [LAMBDA (IMAGEOBJ STREAM)                                  (* drc: " 7-Jan-86 22:09")    (PRIN2 (CONS (IMAGEOBJPROP IMAGEOBJ (QUOTE ITEM))                 (IMAGEOBJPROP IMAGEOBJ (QUOTE TYPE)))           STREAM])(IRM.GET.CREF  [LAMBDA (FILE TEXTSTREAM)                                  (* drc: " 2-Jan-86 17:45")    (DECLARE (GLOBALVARS \IRM.CREF.IMAGEFNS))    (LET ((DATA (READ FILE))          (IMAGEOBJ (IMAGEOBJCREATE NIL \IRM.CREF.IMAGEFNS)))         (IMAGEOBJPROP IMAGEOBJ (QUOTE ITEM)                (CAR DATA))         (IMAGEOBJPROP IMAGEOBJ (QUOTE TYPE)                (CDR DATA))     IMAGEOBJ])(IRM.CREF.BUTTONEVENTFN  [LAMBDA (IMAGEOBJ WSTREAM SELECTION RELX RELY WINDOW TEXTSTREAM BUTTON)                                                             (* drc: " 8-Jan-86 15:34")                                                             (* (INSPECT IMAGEOBJ))    (LET* ((BOUNDBOX (IMAGEOBJPROP IMAGEOBJ (QUOTE BOUNDBOX)))           (WIDTH (fetch (IMAGEBOX XSIZE) of BOUNDBOX))           (HEIGHT (fetch (IMAGEBOX YSIZE) of BOUNDBOX))           (REGION (create REGION                          HEIGHT &larr; HEIGHT                          WIDTH &larr; WIDTH                          LEFT &larr; 0                          BOTTOM &larr; 0)))          (RESETFORM (TTYDISPLAYSTREAM (GETPROMPTWINDOW WINDOW))                 (BLTSHADE BLACKSHADE WSTREAM 0 0 WIDTH HEIGHT (QUOTE INVERT))                 (bind (N &larr; 0)                       (ITEM &larr; (IMAGEOBJPROP IMAGEOBJ (QUOTE ITEM)))                       (TYPE &larr; (IMAGEOBJPROP IMAGEOBJ (QUOTE TYPE)))                    until [OR (NOT (MOUSESTATE (OR LEFT MIDDLE)))                              (NOT (INSIDEP REGION (CURSORPOSITION NIL WSTREAM]                    do (BLOCK 100)                       (if (EQ (SETQ N (ADD1 N))                               10)                           then (printout T T "Will lookup " (IMAGEOBJPROP IMAGEOBJ (QUOTE ITEM))                                       (if TYPE                                           then (CONCAT " as a " TYPE ".")                                         else ".")))                       (GETMOUSESTATE) finally (CLEARW T)                                             (if (INSIDEP REGION (CURSORPOSITION NIL WSTREAM))                                                 then (ADD.PROCESS (LIST (QUOTE IRM.LOOKUP)                                                                         (KWOTE ITEM)                                                                         (KWOTE TYPE)                                                                         (WINDOWPROP WINDOW                                                                                (QUOTE DINFOGRAPH)))                                                             (QUOTE NAME)                                                             "IRM Cross Reference"))                                             (BLTSHADE BLACKSHADE WSTREAM 0 0 WIDTH HEIGHT                                                    (QUOTE INVERT))                                             NIL]))(RPAQ? IRM.CREF.FONT (FONTCREATE (QUOTE MODERN)                            8                            (QUOTE MRR)))(RPAQ? \IRM.CREF.IMAGEFNS (IMAGEFNSCREATE (FUNCTION IRM.DISPLAY.CREF)                                 (FUNCTION IRM.CREF.BOX)                                 (FUNCTION IRM.PUT.CREF)                                 (FUNCTION IRM.GET.CREF)                                 (FUNCTION NILL)                                 (FUNCTION IRM.CREF.BUTTONEVENTFN)))(DECLARE: DOEVAL@COMPILE DONTCOPY(GLOBALVARS IRM.CREF.FONT \IRM.CREF.IMAGEFNS))(* * "Internal functions and variables")(DEFINEQ(\IRM.GET.REF  [LAMBDA (KEYWORD TYPE WINDOW)                              (* drc: "18-Jan-86 17:13")                    (* * Returns an IRMREFERENCE for KEYWORD of optionally specified TYPE.)    (\IRM.GET.HASHFILE)                                      (* keywords in hashfile are all                                                              uppercased -- make's lookup case                                                              insensitive)    (SETQ KEYWORD (MKATOM (U-CASE KEYWORD)))    (LET (SAMEFLG REFS)         (SETQ REFS (if (EQ KEYWORD (WINDOWPROP WINDOW (QUOTE PREVIOUS.KEYWORD)))                        then                                 (* same keyword as last time, so fetch                                                              cached refs)                             (SETQ SAMEFLG T)                             (WINDOWPROP WINDOW (QUOTE IRM.REFS))                      else (CLEARW T)                           (PRINTOUT T "Fetching reference(s) for " KEYWORD "...")                                                              (* hashfile contains a list of                                                              IRMREFERENCES for each keyword)                           (GETHASHFILE KEYWORD \IRM.HASHFILE)))         (WINDOWPROP WINDOW (QUOTE PREVIOUS.KEYWORD)                KEYWORD)         (WINDOWPROP WINDOW (QUOTE IRM.REFS)                REFS)         (COND            ((NULL REFS)             (PRINTOUT T "None found.")             NIL)            ((NULL TYPE)             (PRINTOUT T "OK.")             (\IRM.CHOOSE.REF REFS KEYWORD))            ((for REF in REFS thereis (if (AND (EQ (fetch (IRMREFERENCE TYPE) of REF)                                                   TYPE)                                               (fetch (IRMREFERENCE PRIMARYFLG) of REF))                                          then (PRINTOUT T "OK.")                                               REF)))            ((SETQ REFS (for REF in REFS join (if (EQ (fetch (IRMREFERENCE TYPE) of REF)                                                      TYPE)                                                  then (LIST REF)                                                else NIL)))             (PRINTOUT T "OK.")             (\IRM.CHOOSE.REF REFS KEYWORD))            (T (PRINTOUT T "none found of type " TYPE ".")               NIL])(\IRM.SMART.REF  [LAMBDA (KEYWORD WINDOW)                                   (* drc: "18-Jan-86 17:40")                    (* * Returns IRMREFERENCE for KEYWORD. Allows wildcards in KEYWORD, and will           try spelling correction.)    (if (while [SETQ POS (STRPOS "*" KEYWORD (AND POS (ADD1 POS] bind POS           when (NEQ (NTHCHAR KEYWORD (SUB1 POS))                     (QUOTE ')) do (RETURN T)           finally                                           (* if not doing wildcarding then                                                              remove quotes when preceding asterisks)                 [SETQ KEYWORD (PACK (for TAIL on (UNPACK KEYWORD)                                        when [NOT (AND (EQ (CAR TAIL)                                                           (QUOTE '))                                                       (EQ (CADR TAIL)                                                           (QUOTE *] collect (CAR TAIL]                 (RETURN NIL))        then                                                 (* there's an unquoted asterisk --                                                             it's wildcardin' time!)             (\IRM.WILD.REF KEYWORD WINDOW)      elseif \IRM.KEYWORDS        then                                                 (* we've got possible matches loaded,                                                              so try spelling correction)             (RESETFORM (TTY.PROCESS (THIS.PROCESS))                    (LET ((CORRECTED (MISSPELLED? KEYWORD 50 \IRM.KEYWORDS T)))                         (if CORRECTED                             then (\IRM.GET.REF CORRECTED NIL WINDOW)                           else (PRINTOUT T T KEYWORD " Not in IRM")                                NIL)))      else                                                   (* default to normal lookup)           (\IRM.GET.REF KEYWORD NIL WINDOW])(\IRM.CHOOSE.REF  [LAMBDA (REFS KEYWORD)                                     (* drc: " 8-Jan-86 15:23")    (if (NULL (CDR REFS))        then (CAR REFS)      else (MENU (create MENU                        CENTERFLG &larr; T                        TITLE &larr; (MKSTRING KEYWORD)                        ITEMS &larr; (for REF in REFS                                   collect (LIST (LET ((TYPE (fetch (IRMREFERENCE TYPE) of REF)))                                                      (if (fetch (IRMREFERENCE PRIMARYFLG)                                                             of REF)                                                          then (PACK* "* " TYPE " *")                                                        else TYPE))                                                 (KWOTE REF)                                                 (CONCAT "Lookup " KEYWORD " as " (fetch (                                                                                         IRMREFERENCE                                                                                          TYPE)                                                                                     of REF])(\IRM.WILD.REF  [LAMBDA (KEYWORD WINDOW)                                   (* drc: "18-Jan-86 17:04")                    (* * Return IRMREFERENCE matching wildcarded KEYWORD.)    (OPENW WINDOW)    (LET* [SAMEFLG (MATCHES (if (EQ KEYWORD (WINDOWPROP WINDOW (QUOTE IRM.WILD.KEYWORD)))                                then                         (* same as last time we wildcarded --                                                             used cached matches.)                                     (SETQ SAMEFLG T)                                     (WINDOWPROP WINDOW (QUOTE IRM.MATCHES))                              else (PROG2 (PRINTOUT (GETPROMPTWINDOW WINDOW)                                                 "...Matching wildcard(s)...")                                          (\IRM.WILDCARD KEYWORD (\IRM.GET.KEYWORDS WINDOW))                                          (PRINTOUT (GETPROMPTWINDOW WINDOW)                                                 "OK"]          (WINDOWPROP WINDOW (QUOTE IRM.WILD.KEYWORD)                 KEYWORD)          (WINDOWPROP WINDOW (QUOTE IRM.MATCHES)                 MATCHES)          (if MATCHES              then [if (NULL (CDR MATCHES))                       then (\IRM.GET.REF (CAR MATCHES)                                   NIL WINDOW)                     else (OR SAMEFLG (WINDOWPROP WINDOW (QUOTE WILD.MENU)                                             (create MENU                                                    ITEMS &larr; (for MATCH in MATCHES                                                               collect (LIST MATCH (KWOTE MATCH)                                                                             (CONCAT "Will lookup "                                                                                     MATCH                                                                                " in IRM if selected."                                                                                    )))                                                    CENTERFLG &larr; T                                                    TITLE &larr; KEYWORD)))                          (LET [(CHOICE (MENU (WINDOWPROP WINDOW (QUOTE WILD.MENU]                               (AND CHOICE (\IRM.GET.REF CHOICE NIL WINDOW]            else (PRINTOUT (GETPROMPTWINDOW WINDOW)                        T "No matches found for " KEYWORD)                 NIL])(\IRM.WILDCARD  [LAMBDA (WILDATOM LIST)                                    (* drc: "18-Jan-86 17:00")                    (* * Returns those atoms in LIST which match WILDATOM.)    (LET ((SCRATCH (CONS))          (WILDLIST (UNPACK WILDATOM)))         (for ATOM in LIST when (\IRM.WILD.MATCH WILDLIST (DUNPACK ATOM SCRATCH)) collect ATOM])(\IRM.WILD.MATCH  [LAMBDA (WILDLIST LIST)                                    (* drc: "18-Jan-86 16:59")                    (* * predicate for whether wildcard containing WILDLIST matches LIST.)    (COND       ((AND (NULL WILDLIST)             (NULL LIST)))       [(AND (EQ (CAR WILDLIST)                 (QUOTE '))             (EQ (CADR WILDLIST)                 (QUOTE *)))                                 (* found a quoted asterisk)        (if (EQ (QUOTE *)                (CAR LIST))            then                                             (* and it matches)                 (\IRM.WILD.MATCH (CDDR WILDLIST)                        (CDR LIST]       [(EQ (CAR WILDLIST)            (QUOTE *))                                       (* found a real wildcard)        (OR (NULL (CDR WILDLIST))            (for TAIL on LIST thereis (\IRM.WILD.MATCH (CDR WILDLIST)                                             TAIL]       ((EQ (CAR WILDLIST)            (CAR LIST))                                      (* first chars match --                                                             keep checking)        (\IRM.WILD.MATCH (CDR WILDLIST)               (CDR LIST)))       (T NIL])(\IRM.GET.HASHFILE  [LAMBDA NIL                                                (* drc: "16-Dec-85 12:09")    (OR (ARRAYP \IRM.HASHFILE)        (SETQ \IRM.HASHFILE (OPENHASHFILE (OR IRM.HASHFILE.NAME (PACKFILENAME (QUOTE NAME)                                                                       (QUOTE IRM)                                                                       (QUOTE EXTENSION)                                                                       (QUOTE HASHFILE)                                                                       (QUOTE BODY)                                                                       IRM.HOST&amp;DIR))                                   (QUOTE INPUT])(\IRM.GET.KEYWORDS  [LAMBDA (WINDOW QUIETFLG)                                  (* drc: "18-Jan-86 17:14")                    (* * keyword list is hidden in hashfile as its key is in lower case)    (OR \IRM.KEYWORDS (PROGN (PRINTOUT (GETPROMPTWINDOW WINDOW)                                    "Loading keyword list...")                             (\IRM.GET.HASHFILE)                             (SETQ \IRM.KEYWORDS (GETHASHFILE (QUOTE irm.keywords)                                                        (\IRM.GET.HASHFILE]))(RPAQ? \IRM.HASHFILE )(RPAQ? \IRM.KEYWORDS )(DECLARE: DOEVAL@COMPILE DONTCOPY(GLOBALVARS \IRM.HASHFILE \IRM.KEYWORDS))(PUTPROPS HELPSYS COPYRIGHT ("Xerox Corporation" 1985 1986))(DECLARE: DONTCOPY  (FILEMAP (NIL (3152 8337 (HELPSYS 3162 . 4993) (IRM.LOOKUP 4995 . 6394) (IRM.SMART.LOOKUP 6396 . 6555) (IRM.RESET 6557 . 6969) (\IRM.INSTALL?DEDITMACRO 6971 . 8335)) (8629 10623 (IRM.GET.DINFOGRAPH 8639 . 9979) (IRM.DISPLAY.REF 9981 . 10621)) (10842 16800 (IRM.DISPLAY.CREF 10852 . 12748) (IRM.CREF.BOX 12750 . 13587) (IRM.PUT.CREF 13589 . 13831) (IRM.GET.CREF 13833 . 14249) (IRM.CREF.BUTTONEVENTFN 14251 . 16798)) (17420 28759 (\IRM.GET.REF 17430 . 19964) (\IRM.SMART.REF 19966 . 22027) (\IRM.CHOOSE.REF 22029 . 23283) (\IRM.WILD.REF 23285 . 25807) (\IRM.WILDCARD 25809 . 26189) (\IRM.WILD.MATCH 26191 . 27476) (\IRM.GET.HASHFILE 27478 . 28198) (\IRM.GET.KEYWORDS 28200 . 28757)))))STOP</pre>
  </body>
</html>
