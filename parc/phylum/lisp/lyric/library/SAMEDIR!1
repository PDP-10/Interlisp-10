(DEFINE-FILE-INFO §READTABLE "INTERLISP" §PACKAGE "INTERLISP")(FILECREATED "31-Oct-86 11:13:05" {ERIS}<LISPCORE>LIBRARY>SAMEDIR.;4 3967         changes to%:  (FNS CHECKSAMEDIR HOST&DIRECTORYFIELD)      previous date%: " 9-Jun-85 23:56:27" {ERIS}<LISPCORE>LIBRARY>SAMEDIR.;3)(* "Copyright (c) 1982, 1984, 1985, 1986 by Xerox Corporation.  All rights reserved.")(PRETTYCOMPRINT SAMEDIRCOMS)(RPAQQ SAMEDIRCOMS ((FNS CHECKSAMEDIR HOST&DIRECTORYFIELD)                    (ADDVARS [MAKEFILEFORMS (OR (NLSETQ (CHECKSAMEDIR FILE))                                                (RETFROM 'MAKEFILE]                           (MIGRATIONS))                    (GLOBALVARS MIGRATIONS)))(DEFINEQ(CHECKSAMEDIR  [LAMBDA (FILE)                                             (* mdd "31-Oct-86 11:12")                                                  (* ;;                                "fixed 31-Oct-86 by mdd to (finally!) do case-insensitive comparisons")    (PROG ((DATES (GETP FILE 'FILEDATES))           HOST/DIR HOST DIR LST NEWV OKHOST/DIRS)      AGAIN          (OR (LISTP DATES)              (RETURN))          [SETQ OKHOST/DIRS (CONS (SETQ HOST/DIR (U-CASE (DIRECTORYNAME T T)))                                  (MKLIST (CDR (FASSOC HOST/DIR MIGRATIONS]          (COND             ((for OLDFILE in DATES bind HOST DIR never (FMEMB (HOST&DIRECTORYFIELD (CDR OLDFILE))                                                               OKHOST/DIRS))              (SELECTQ [ASKUSER 10 'Y (LIST '"You haven't loaded or written" FILE '                                            "in your connected directory" HOST/DIR '                                            "-- should I write it out anyway")                              `((O %, (CONCAT "ops!  Connect to " (SETQ HOST/DIR (HOST&DIRECTORYFIELD                                                                                  (CDAR DATES)))                                             " [confirm] ")                                   CONFIRMFLG T)                                (C "onnect to other directory: ")                                (Y "es, write it here")                                (N "o, abort MAKEFILE"]                  (Y (RETURN))                  (N (ERROR!))                  (C (SETQ HOST/DIR))                  (O)                  (SHOULDNT))              [NLSETQ (CNDIR (OR HOST/DIR (READ T T]              (GO AGAIN))             ((AND [SETQ NEWV (INFILEP (PACKFILENAME 'VERSION NIL 'BODY (CDAR DATES]                   (NEQ NEWV (CDAR DATES)))              (SELECTQ (ASKUSER 15 'Y (LIST (CDAR DATES)                                            "is not the most recent version (version"                                            (MKSTRING (FILENAMEFIELD NEWV 'VERSION))                                            "has since appeared)."                                             "Do you want to make the file anyway"))                  (Y)                  (N (ERROR!))                  (SHOULDNT])(HOST&DIRECTORYFIELD  [LAMBDA (FILENAME)                                         (* mdd "31-Oct-86 10:56")                                                  (* ;;                              "Returns the host&dir fields packed together.  Uppercase them as we go.")    (for TAIL on (UNPACKFILENAME FILENAME) by (CDDR TAIL)       do [COND             ((FMEMB (CAR TAIL)                     '(HOST DIRECTORY DEVICE))              (push $$VAL (CAR TAIL)                    (U-CASE (CADR TAIL] finally (RETURN (PACKFILENAME $$VAL]))(ADDTOVAR MAKEFILEFORMS (OR (NLSETQ (CHECKSAMEDIR FILE))                            (RETFROM 'MAKEFILE)))(ADDTOVAR MIGRATIONS )(DECLARE%: DOEVAL@COMPILE DONTCOPY(GLOBALVARS MIGRATIONS))(PUTPROPS SAMEDIR COPYRIGHT ("Xerox Corporation" 1982 1984 1985 1986))(DECLARE%: DONTCOPY  (FILEMAP (NIL (703 3671 (CHECKSAMEDIR 713 . 3084) (HOST&DIRECTORYFIELD 3086 . 3669)))))STOP