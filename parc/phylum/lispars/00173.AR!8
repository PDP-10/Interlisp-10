Number: 173Date: 18-Mar-84 16':32':56Submitter: Sannella.PASource: Sheil.paSubject: BAD.STATE.FOR.BOUT under GETNEWMAILLisp Version: 1-Mar-84 14':24':22Description: 'Date': 16 Mar 84 09':48 PST'From': Sheil.pa'Subject': Lafite': BAD.STATE. FOR.BOUT under GETNEWMAIL'To': LafiteSupport.pa''Lafite-System-Date': 28-Feb-84 13':10':33'Lisp-System-Date':  1-Mar-84 14':24':22'Machine-Type': Dolphin''Stack is GETNEWMAIL...GV.CLOSEMAILBOX; MS.RETRIEVEOP; \BOUT. Bad state is on a BSP stream, not the mail file being written to.''During the retrieve, Phylum hung for a while, so it may have timed out. I could not proceed it.''Beau'-----'Date': 16 Mar 84 16':01 PST'From': vanMelle.pa'Subject': Re': Lafite': BAD.STATE. FOR.BOUT under GETNEWMAIL'In-reply-to': Sheil.pa''s message of 16 Mar 84 09':48 PST'To': Sheil.pa'cc': LafiteSupport.pa''Yes, this should probably just quietly abort itself.  You can in general ^ out of such breaks.  I''ll fix the Grapevine code to be a little friendlier here.''	Bill''-----''Date': 21 Mar 84 11':09 PST'From': Halvorsen.pa'Subject': Lafite': BSP error'To': LafiteSupport.pa'Lafite-System-Date': 28-Feb-84 13':10':33'Lisp-System-Date': 15-Mar-84 00':13':18'Machine-Type': Dandelion''When I do a get mail and am notified that some of my mail files were open during a file server crash I often (always?) get a BSP error with the message Bad.State.For.Bout. under \BOUT under MS.RETRIEVEOPERATION''-----'''Date': 21 Mar 84 13':15 EST'From': Denber.wbst'Subject': Lafite': GETMAIL'To': LafiteSupport.pa'Lafite-System-Date': 28-Feb-84 13':10':33'Lisp-System-Date':  1-Mar-84 14':24':22'Machine-Type': Dolphin''Doing a get mail from Barbera (over a very slow and obviously overloaded connection) eventually gave a ''BSP error': BAD.STATE.FOR.BOUT'{STREAM}#10,1300''(ERROR broken)''from BSPBOUT from MS.RETRIEVEOPERATION from GV.NEXTMESSAGE from RETRIEVEMESSAGES from GETNEWMAIL1 from GETNEWMAIL.''			- Michel''-----''Date': 27 Apr 84 12':02 PST'From': vanMelle.pa'Subject': Dealing with BAD.STATE.FOR.BOUT under GetMail'To': LafiteUsers^'Reply-to': vanMelle.pa''I''ve noticed recently that people have been getting this error more, and it''s a hard one to fix, so I thought I should say something in the meanwhile until it gets fixed.  This is principally of interest to you folks whose mail files are stored on a file server.''The problem is that if the file server is heavily loaded, there can be a long pause between the time Lafite has retrieved the last message from Grapevine and when your file server has acknowledged receiving the last message in its entirety.  Only then is it safe to tell Grapevine to flush your mailbox.  Unfortunately, that pause can be longer than Grapevine is willing to wait.  So Grapevine times out, and you get a BAD.STATE.FOR.BOUT error.  Your new mail now lives in two places': in your mailbox on Grapevine and in your mail file on the file server.  All you can do when this happens is ^ out of the break and try again.''If "trying again" in the obvious way fails, you can get around your unresponsive file server by retrieving your mail to a mail file stored on your local disk (assuming you have one), rather than your file server.  This won''t work for those Dandelion users who have no local file system yet; in this case, you can improve your chances for success (and slow down Lafite, unfortunately) by setting LAFITEBUFFERSIZE smaller.  The smaller LAFITEBUFFERSIZE takes effect when you first browse a file, and after you Expunge.''I have several things to do to fix this problem, not the least of which is to get rid of the possibly alarming break that you fall into.  Meanwhile, pray for more file server cycles, and rest assured that this misbehavior does not lose you any mail.''	Bill'''Workaround: Test Case: Edit-By: Sannella.PAEdit-Date:  1-May-84 16':13':47Attn: vanMelle.paAssigned To: In/By: Disposition: '[Date':  9 Apr 84 12':38 PST'From': vanMelle.pa'AR 173': Impact Moderate]System: TextSubsystem: LafiteMachine: Disk: Microcode Version: Memory Size: File Server: Server Software Version: Difficulty: ModerateFrequency: Impact: ModeratePriority: HopefullyStatus: OpenProblem Type: BugSource Files: 