Number: 1154Date: 20-May-84 11':33':39Submitter: LE.PASASource: Tom Lipkis <LIPKIS@USC-ISIF.ARPA>Subject: MAKEPRESS, SEE don''t work if EOL = LF, because BIN doesn''t obey EOL conventionLisp Version: Fugue6Description: ' MAKEPRESS and SEE do not work correctly with the new device' sensitive EOL, for files stored on a vax (where EOL = LF).  The problem is'apparently that, while READ and READC do the appropriate translation, BIN'does not, and MAKEPRESS (but not MAKEINTERPRESS, which works ok) uses BIN.'I understand why BIN and BOUT don''t translate, but this has introduced a'real incompatibility.  BIN and BOUT have always been equivalent to READC and'PRIN3 (modulo the character/code conversion), and the use of BIN has been'encouraged for efficiency.  That efficiency is no longer available for'dealing with text files, and that should be documented.  (Granted, BIN and'BOUT are described in the Binary I/O section, but they have been used for'more than that.)''	In addition to the problem with MAKEPRESS and COPYALLBYTES, I don''t'understand what COPYFILE is doing.  If the input file is of type TEXT, it'sets the EOL attribute of the output stream to match the input.  What does'this accomplish?  The EOL attribute disappears when the stream is closed,'leaving a file with (potentially) the wrong kind of EOLs in it for the device'its stored on.  I think the correct behavior would be to check (for TEXT'files) whether the EOL attribute of the input and output are the same, and'if not, use a slower READC/PRIN3 loop (or something) to get the appropriate'translation to happen.''	I should point out that the Unix leaf server has never supported'the TYPE attribute, since there was no convenient place to store it and it'didn''t make any difference anyway.  I''ll look into fixing that, but until'that and the other problems are solved, I recommend you tell people with'Unix file servers NOT to inform the system of that (i.e., don''t put anything'on NETWORKOSTYPES).''Also, the bugs in MAKEPRESS and \HANDLE.RAW.XIP that I reported (and'sent fixes for) a long time ago have not been fixed.''-------''Date':  7 Jun 84 16':20':14 PDT (Thursday)'From': Masinter.PA'Subject': AR#1154, MAKEPRESS, SEE for devices with EOL=LF'To': vanMelle, Lipkis@ISIF, Le.pasa, Kaplan, Sybalsky, Kiewiet.pasa'cc': 1100Support, LispSupport'''I recall some correspondence about this in the past but it is not in the AR. Is this problem resolved? Apparently the symptom is that if you MAKEPRESS a file from a device which has EOL=LF, it generates garbage.''Also, the body of the AR seems to include references to another problem (COPYFILE doing the wrong thing)  and to some old bug reports with MAKEPRESS and \HANDLE.RAW.XIP. Are those separate ARs?''(I''ve marked this AR as Attn': Kaplan, vanMelle, Sybalsky and hope that you folks can sort it out....)''-----''Date':  7 Jun 84 17':06 PDT'From': Kaplan.pa'Subject': Re': AR#1154, MAKEPRESS, SEE for devices with EOL=LF'In-reply-to': Masinter.PA''s message of 7 Jun 84 16':20':14 PDT (Thursday)'To': Masinter.PA'cc': vanMelle.PA, Lipkis@ISIF, Le.pasa, Sybalsky.PA, Kiewiet.pasa, 1100Support.PA, LispSupport.PA''I replied to Raim etc on this awhile ago, asking for more information.  My belief is that SEE and PF were not upgraded to behave properly in Fugue6, but that MAKEPRESS and MAKEINTERPRESS were.  SEE and PF work properly in Harmony.''If MAKEPRESS and MAKEINTERPRESS are generating garbage, I''d like to know what kind, what the EOL convention of the file is (internally, after it is opened), etc.  I think I requested more information of this sort in my previous reply.'.'The behavior of COPYFILE is indeed suboptimal, and will be changed so that, under control of some flag argument, it will change the eol bytes of files that it recognizes as of type TEXT so that they conform to the default EOL convention of the device they are going to.''In the meantime, the desired effect can be obtained by opening the file and using COPYCHARS instead of COPYBYTES to copy the bytes.  (I''m not sure this exists in Fugue6 or Carol, does exist in Harmony, however). ' '--Ron''Return-Path': <LIPKIS@USC-ISIF.ARPA>'Received': from USC-ISIF.ARPA by Xerox.ARPA ; 18 JUN 84 18':23':51 PDT'Date': 18 Jun 84 13':20':23 PDT'Subject': AR#1154 correction'From': Tom Lipkis <LIPKIS@USC-ISIF.ARPA>'To': 1100support.pasa'cc': Kaplan.pa, Masinter.pa, Kiewiet.pasa''My previous message (and the original AR) was wrong; MAKEPRESS DOES work'correctly in Fugue6 for EOL=LF.  I got confused because I now have files in'both formats, and didn''t realize that NETWORKOSTYPES was only consulted when'leaf opens a new connection.''Tom'-------''Workaround: Test Case: [lk 5/20/84':  I have not looked back at the old Pnnnn reports to which Tom refers in the last paragraph (yet).  Lorraine]'Edit-By: Sannella.PAEdit-Date: 17-Aug-84 10':02':48Attn: Assigned To: KaplanIn/By: Disposition: System: Operating SystemSubsystem: Generic File OperationsMachine: 1108Disk: Microcode Version: Memory Size: File Server: Server Software Version: Difficulty: HardFrequency: EverytimeImpact: SeriousPriority: HopefullyStatus: ClosedProblem Type: BugSource Files: 