Number: 506Date:  6-Apr-84  1':34':46Submitter: le.pasaSource: Teknowledge/RaimSubject: Installing Sysout from Vax/DEI to Dlion caused a 915 at very last transferLisp Version: Customer''s own sysouDescription: ''Date': Tue, 3 Apr 84 16':14 PST'From': Raim.pasa'Subject': Teknowledge trip report'To': Pahlavan'cc': VanMelle.PA, Sheil.PA, Raim''Marcel,''I visited Teknowledge on April 2 in response to yet another urgent invitation from Bill White.  There are two pressing problems, both of which are being submitted as AR''s.''1.  0915 abort when installing Lisp from VAX.  The problem is either in Jerry Fungs Install Tool or in DEI version 6.  Jerry and Phil are investigating this.  In the meantime, Teknowledge will try using a potentially unreliable workaround to recover from the 0915.''-----'[JFugn 5-Apr-84]''When downloading SOME sysout from Vax to Dlion, a time-out was noticed on the very last xfer, and yielded a MP 915.  The symptom occurs on some sysouts and not others (correct me if I am wrong, Phil)''-----''Date': Fri, 13 Apr 84 17':15 PST'From': BKorbholz.ES'Subject': DEI 6.0 Bug'To': DEI-Interest^'Reply-To': BKorbholz.ES''A bug has recently been discovered which will cause file transfers of long duration to abort.  The bug will be fixed in DEI 6.1.  System administrators are being informed of a work-around which can be applied immediately to circumvent the problem.''-----''Date': 15 Apr 84 17':42':02 PST (Sunday)'From': JFung.pasa'Subject': PUPFtp problem between Vax/DEI and Dlion'To': 1100Kernel^'cc': BKorbholz.ES, DVale.es, Davirro.pa, Hamilton.es, Masinter.pa, JFung''Folks,''This message explains the problem of downloading a lisp.sysout file from the VAX file server running DEI to the Dlion as originally reported by Teknowledge (AR# 506).''The origianl problem was Dlion crashed at MP 915 during Install lisp.sysout.  This was due to a an error raised from Pilot''s Stream interface that the tool failed to catch and was fixed quickly . Then three different symptoms were observed during tracking the problem in El Segundo, they were':  1) "Connection rejected by remote host, while connected to Taos",  2) "Connection timed out, while connected to Taos", and 3) "Opening connection to Taos... and "Connection timed out".'''1.)	"Connection rejected by remote host, while connected to Taos"''	This is a logic error in the InstallLispTool in determining the termination of data transfer.  The tool was using the file size (byte count) to control the termination of end of data transfer.  It turns out this file size is not an accurate data count but an estimate.  The tool was than waiting for more data to come even when Vax has sent over an "end of message" packet, thus it timed out.  The correct way to terminate is to use the "end of stream" completion code returned by Stream interface.  '	'	How did this works previously with DEI software and with SDD''s IFS are beyond my understanding. ''	'2). 	"Connection timed out, while connected to Taos"	''	This one is a bug in the DEI 6.0.  As I understood from Don Vale is that the DEI uses the data packets when in "store" or "retrieve" to re-set their connection timer, currently set at 5 minutes.  DEI 6.0 neglected to use "ack" packet to reset their connection timer, in the retrieve case there are no data packets as in store, and for very large files (especially takes more than 5 minutes to retrieve) the connection got broken.   DEI 6.1 has a quick patch in extending the timer to 10 minutes.  (see attached Bill''s message).'	'	'3)	"Opening connection to Taos... and "Connection timed out"''	This symptom showed up many times in Wednesday.  Don Vale collected tha packets exchanged between Dlion and Vax, and believed Pilot is not hanling the RFC properly at a certain state.  Since this problem did not show up after we put in out patches, I presume it is not a problem any more.  If it shows up again, I will submit an AR against System Software together with the trace Don collected.'	'		/Jerry''-----''Date': 16 Apr 84 17':01':01 PST (Monday)'From': JFung.pasa'Subject': AR# 506': "PupFtp problem between Vax/DEI & Dlion" _ Fixed'To': LispSupport.pa, 1100Support'cc': LispCore^.pa, Raim, PYoung, JFung'Reply-To': JFung.pasa''Mike,''Please move [rose]<lisp>fugue6>InstallLispTool.bcd!3       90624 16-Apr-84 15':39':57 PST to phylum.  It fixed AR# 506.''In addition it has the following stuffs':''	1.	Cant have space in Domain token is fixed.'	2.	User may boot/start a non-lisp volume, by selecting volume type _ NonLisp.  The volume type will be made transparent in the future.'	'	Note': This version also requires the DEI''s patch to prevent the connection timed out in retrieving large files, esp. one that will take more than "5" minutes.  Contact Phil for DEI''s patch.'	'	/Jerry''-----''Date': 17 Apr 84 17':08':51 PST (Tuesday)'From': JFung.pasa'Subject': AR': 506 closed'To': 1100Support, LispSupport.pa'cc': Agadoni, Pahlavan, Sheil.pa, JFung, DEI-Support^.es''I just spoke to Bill White, he has tried the latest Lisp Tool several times, and said "so far so good", it has not broken yet.  Also he is happy to use the Profile tool which sets up a lot of defualt paramenters, and he likes that.''Thought you would be interested to hear.''-----''Sender': Sannella.PA'Date': 17 Apr 84 17':10':07 PST (Tuesday)'Subject': DEI patch'To': PYoung.pasa'cc': LispSupport.pa'From': LispSupport.pa'Reply-To': LispSupport.pa''Could you please give me a pointer to the "DEI patch" referred to below?  I assume that this is a patch to the VAX code, that you will give to customers.  We might as well have a copy up here, too.''-----''Date': Wed, 18 Apr 84 12':26 PST'From': PYoung.pasa'Subject': Re': DEI patch'In-reply-to': "Sannella.PA''s message of 17 Apr 84 17':10':07 PST (Tuesday)"'To': Sannella.PA'cc': PYoung, LispSupport.PA''The "DEI patch" is not to code but to a command file that contains VMS logical name assignments. So in the file DEI.COM the line that defines DEI$FTPQUIESCE should be changed to have a value of at least 10 instead of 5.''Phil ''Workaround: [JFugn 5-Apr-84] It turns out that ALL bytes are received even with 915 crash.  To work around this, first do SetVMem! command then do Install File! command.Test Case: Edit-By: Sannella.PAEdit-Date: 18-Apr-84 17':03':18Attn: ReleaseAssigned To: JFung.pasaIn/By: 16-Apr-84 15':39':57 Disposition: '[Date': 16 Apr 84 17':01':01 PST (Monday)'From': JFung.pasa'Subject': AR# 506': "PupFtp problem between Vax/DEI & Dlion" _ Fixed]'[fixed per InstallLispTool.bcd 16-Apr-84 15':39':57 PST]'[4/18/84 tl': closed Ar according to -- ....]'[4/18/84 mjs': status_fixed]'System: CommunicationsSubsystem: VAX ServerMachine: 1108Disk: Microcode Version: Memory Size: File Server: VAX/VMS - 3MbServer Software Version: Difficulty: ModerateFrequency: IntermittentImpact: FatalPriority: AbsolutelyStatus: FixedProblem Type: BugSource Files: 