<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
    <title>File [phylum]&lt;LispARs>02023.AR!6</title>
  </head>
  <body>
    <pre>
Number: 2023Date: 29-Aug-84 15':47':45Submitter: Wogulis.pasaSource: dcatton.rx, Wogulis.pasaSubject: printing on A4 paper; document NSPRINT.DEFAULT.MEDIUM'Assigned To: MasinterAttn: ReleaseStatus: FixedIn/By: Problem Type: DocumentationImpact: SeriousDifficulty: Frequency: EverytimePriority: HopefullySystem: CommunicationsSubsystem: NS ProtocolsMachine: 1108Disk: Lisp Version: CarolSource Files: Microcode Version: Memory Size: File Server: 8037Server Software Version: services8.0Disposition: '["Sannella.PA" "29-Aug-84 17':32':39" Status':(New-&gt;Open) Problem% Type':(-&gt;Bug) Impact':(-&gt;Serious) Priority':(-&gt;Hopefully)]'["vanMelle" "14-Sep-84 17':54':06" Subject': Attn': Problem% Type':(Bug-&gt;Documentation) Description':]'["Masinter" "18-Sep-84 17':38':17" Assigned% To': Attn':]'["Masinter" "18-Sep-84 20':30':47" Source': Subject': Assigned% To': Attn': Status':(Open-&gt;Fixed) In/By': Disposition': Edit-By': Edit-Date':]'["Sannella.PA" "19-Sep-84 18':52':32" In/By': Description':]Description: 'From': dcatton.rx'Date': 28-Aug-84 10':41':28'Subject': AIL AR 60'To': 1100support.pa'cc': DCatton.rx''Problems with Services 8 printing from Interlisp-D''I experimented with upgrading our RAVEN to services8.0, our OS4.2 stations didn''t seem to mind but Interlisp-DCelease did.'Lisp reported error MEDIA UNAVAILABLE so I  tried advising'(ADVISE  '' (COURIER.OPEN   OPEN.NS.PRINTING STREAM)'	''AFTER'	''(SETQ PROPERTIES [COURIER.CALL  !VALUE  ''PRINTING  '									''GET.PRINTER.PROPERTIES]]'this piece of advice is a red-herring the following advice fixes the problem but it raises a point of interest...''(ADVISE  ''OPEN.NS.PRINTING STREAM'	''BEFORE'	''(COND [(NULL MEDIUM)(SETQ MEDIUM ''(PAPER (KNOWN.SIZE A4]]]''only to get the message "no procedures for GET.PRINTER.PROPERTIES"'I then looked at (DUMP.COURIERPROGRAM   ''printing)' and found that there was indeed no GET.PRINTER.PROPERTIES definition.'BUT (NSPRINTER.PROPERTIES) can and does get hold of the required data'INSPECTCODE of the relevant COURIER.CALL shows that NSPRINTER.PROPERTIES makes an un-named COURIER procedure call. What is this and why?'This  reque-named courier calls is our reference AIL 60. Please advise of any XSIS AR  number assigned.''Regards'' Will Pickles  at AIL'------''Date': 14 Sep 84 17':51 PDT'From': vanMelle.pa''The GET.PRINTER.PROPERTIES procedure is probably missing because a large number of key atoms were smashed in the XNS implementation code in an attempt to keep the code proprietary.  This will not be so in Harmony (for printing anyway), as the printing protocols have been made public.''As for your specific problem and resulting advice, in Harmony there will be a global variable NSPRINT.DEFAULT.MEDIUM, which can be set to (PAPER (KNOWN.SIZE A4)) to get around the problem that the printer stupidly refuses to print on its own default paper.''-----''Date': 18 Sep 84 18':26 PDT'From': Masinter.pa'Subject': AR#2023, default printing medium'To': vanMelle, LispSupport'cc': Masinter.pa''I tried resetting the paper size on the trays of our printer to A4. I could then no longer hardcopy anything.''I attempted to fix this, and there is a new version of NSPRINT on &lt;lispcore&gt;Sources&gt;, but it is yet untested with A4 paper.''-----''Date': 18 Sep 84 18':30 PDT'From': Masinter.pa'Subject': Re': AR#2023, default printing medium'In-reply-to': Masinter.pa''s message of 18 Sep 84 18':26 PDT'To': Masinter.pa'cc': vanMelle.pa, LispSupport.pa''I also changed it so that if you said staple and the printer couldn''t staple, it just put out a warning message and went on.... (also if medium unrecognized).''-----''Date': 18 Sep 84 20':27 PDT'From': Masinter.pa'Subject': AR#2023, Problem with A4 paper; document NSPRINT.DEFAULT.MEDIUM'To': LispSupport'cc': DCatton.RX, Wogulis.pasa, vanMelle''I''ve stored a new version of NSPRINT &amp; .DCOM on {eris}&lt;LispCore&gt;Sources&gt; for inclusion in the Harmony release. This fixes AR#2023 (AIL AR#60), with printing on Services 8.0 print servers when paper size is set to A4. ''An earlier message from van Melle mentioned NSPRINT.DEFAULT.MEDIUM. However, the code in the system didn''t handle NSPRINT.DEFAULT.MEDIUM correctly.''I have extended the interpretation of''NSPRINT.DEFAULT.MEDIUM ''NIL			use whatever the printer gives you'			We believe it is a bug in Services 8.0'			that giving no paper size defaults'			to "US Letter" rather than whatever'			the printer has, but....''T			use the first paper size the printer'			says it has. On 8044s, that''s usually'			what''s in the top paper tray.''Any paper size (A4, US.LETTER, J5 etc) that the printer has. ''Invalid values for medium  will merely cause a warning in the prompt window.''Note that the availability of OPTIONS inside the call to SEND.FILE.TO.PRINTER is probably undocumented, as is the fact that you can specify (MEDIUM papersize TWO.SIDED T ...). (Documenting them is probably not high priority as long as no customers have printers that have any of those capabilities...)'''Workaround: Test Case: Edit-By: Sannella.PAEdit-Date: 19-Sep-84 18':52':33</pre>
  </body>
</html>
