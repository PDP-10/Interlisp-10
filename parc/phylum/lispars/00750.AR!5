Number: 750Date: 19-Apr-84  5':37':30Submitter: le.pasaSource: Mark Rosenstein <mbr@nprdc.ARPA>, Wogulis.pasaSubject: Can''t access {DSK1} ... {DSK5} on DoradoLisp Version: Fugue4Description: ''DESCRIPTION':' in our sysout any use of {dskn} n in [1,5] screws up.which means we can''t do copyfiles to other partitions which is a major inconvience.''Workaround: Test Case: ' (Note': "our sysout" refers to a sysout THEY made using SYSOUT function.) ''Return-Path': mbr@nprdc'Received': from nprdc (NPRDC.ARPA) by Xerox.ARPA ; 14 APR 84 14':26':24 PST'Date': 14 Apr 84 14':21':40 PST'From': Mark Rosenstein <mbr@nprdc.ARPA>'Reply-To': mbr@nprdc.ARPA'To': Wogulis.pasa'Subject': Re': problems with sysouts and files'Cc': hollan@nprdc.ARPA, mccand@nprdc.ARPA, mbr@nprdc.ARPA''Hi':''This note summarizes the actions (which you suggested) that I took.' (which were successful!)''State of the world before actions':''Partition 1': a vanilla sysout, and just enough stuff to boot alto '             executive. Also some of our development files.''Partition 2': Lisp Users and Lisp Library''Partition 3': Our Sysout and enough stuff to boot lisp''Partition 4': essentially the same as 3''Partition 5': No sysout but a viable virtualmem''actions':''booted lisp in partition 5':''(copyfile ''{dsk}createfile.run ''{dsk1}createfile.run)'(logout)''tried to boot partition 1. It cleared screen and wouldn''t boot.''did a remote scavenge of 1, which had directory errors, which'when fixed allowed it to boot.''did createfile''went back to lisp in partiton 5 and copied over other files needed.'did a scavenge, which indicated the directory was a mess. Essentially'all the files I transfered over didn''t get put in the directory, also'the original transfer createfiles got munged. Scavenger did the'trick. ''I did a lisp/i fugue4.vanilla.sysout''and had a working lisp. ''did (copyfile ''{dsk}fugue4.vanilla.sysout ''{dsk5}lisp.sysout)'which returned {dsk5}lisp.sysout''(dir {dsk5}*sysout*) returned lisp.sysout'(logout)''lisp/i in partition 5'did a (dir *) and all the deleted files that were showing up in'our sysout were no longer there.''did a (dir {dsk4}) which came back correct''did a (copyfile ''{dsk5}somefile ''{dsk4}ohtestme)'did a (see {dsk4}ohtestme) which came back correct.''(logout)''went to partition 4 which still had our sysout and 'started up lisp''(dir {dsk4}*oh*) returned nil (was expecting ohtestme)''(dir {dsk}*oh*) returned ohtestme)''(conn {dsk4})'(dir *oh*) returned nil''(dir *) still returned a list containing files that had been deleted.'''SUMMARY':''1) Scavenger wins the program of the year award!''2) in our sysout any use of {dskn} n in [1,5] screws up.'   which means we can''t do copyfiles to other partitions'   which is a major inconvience.''Thanks for your help.'                    Mark'''-----''Date': 21 May 84 15':01 PDT'From': Wogulis.pasa'Subject': [wogulis.pasa': [Mark Rosenstein <mbr@NPRDC.ARPA>': dorado partition/file problem]]'To': Lispcore^.pa, LispSupport.pa, 1100Support.pasa'cc': Wogulis.pasa''I have not received any response to this question. NPRDC needs to have a work around. To access files put on one partition from another through Lisp, they have to re-initialize Lisp in that partition. This is a very unsatisfactory work around. What can he do? Thank you for help.''Jim'     ----- Forwarded Messages -----''Date': 11 May 84 13':55 PDT'From': wogulis.pasa'Subject': [Mark Rosenstein <mbr@NPRDC.ARPA>': dorado partition/file problem]'To': Masinter.pa, VanMelle.pa'cc': wogulis.pasa'''This is very much the same as ar#750. Is there any way we can help him?  I know the difficulty has been assigned as HARD but that does not help him do what he wants to do.''Jim'     ----- Forwarded Messages -----''Return-Path': mbr@nprdc'Received': from nprdc (NPRDC.ARPA) by Xerox.ARPA ; 11 MAY 84 10':36':53 PDT'Date': 11 May 84 10':28':59 PDT'From': Mark Rosenstein <mbr@NPRDC.ARPA>'Reply-To': mbr@NPRDC.ARPA'To': 1100support.PA'Subject': dorado partition/file problem'Cc': mccand@NPRDC.ARPA, hollan@NPRDC.ARPA, mbr@NPRDC.ARPA''machine':  dorado'severity': very'fugue 4''Conduct the following experiment':'in partition 4':'do':'lisp/i to alto executive'for greet file use {dsk1}init.nonet'(directory ''{dsk1})'(logout)''in partition 5':'do'lisp/i to alto executive'for greet file use {dsk1}init.nonet'put a file out to partition 5 say call it junk'(copyfile ''{dsk5}junk ''{dsk1}junk)'(copyfile ''{dsk5}junk ''{dsk2}junk)'(logout)''in partition 4'lisp to alto executive'(directory ''{dsk1}junk*)'note': the file won''t be there''(directory ''{dsk2}junk*)'note': the file will be there''Hypothesis': lisp caches the directory of a partition, the first time'            it access the partition, and doesn''t notice that another'            partition''s lisp has changed it.''Why this is bad': If you try to write out files from partition 1'                 to partition 4 it munges partition 1''s directory,'                 since it has an incorrect view of the directories'                 contents.''I think this caching was the actual cause of an earlier bug,'where we couldn''t write sysouts on the dorado. (the sysout'cached the file system as it knew it. When you did a lisp/i'on the sysout it assumed the file system was just like when it'was made a sysout.)''Immediate Help': If this isn''t fixed in fugue 6, we need to know'                what software flag (or function) can be reset,'                so that lisp will reread the actual physical '                directory.''Thanks.''Mark Rosenstein'nprdc''     ----- End of Forwarded Messages -----''     ----- End of Forwarded Messages -----''-----''Date': 28 May 84 15':42 PDT'From': vanMelle.pa'Subject': Re': Wogulis''s partition problem 'In-reply-to': Sheil.pa''s message of 28 May 84 15':28 PDT'To': Sheil.pa'cc': sannella''Only just recently....''-------'Date': 25 May 84 23':48 PDT'From': vanMelle.pa'Subject': Re': AR#750': Problems with Dorado partitions'To': Wogulis.pasa'cc': vanMelle.pa, Masinter, JonL, 1100Support.pasa''Running in the LispCore loadup, I am unable to replicate the problems described by Mark Rosenstein.  This is not the same as Fugue4, but I don''t believe there have been any substantive changes to the Dolphin/Dorado disk code since Fugue4.  We no longer have the Fugue4 sources up here, so I can''t verify this belief; you might try replicating their problem with Fugue6 or Carol.  Otherwise, my inability to replicate the problems, and the fact that none of our many Dorado users up here have reported anything like this (although some Dolphin users have reported being unable to access the other partition at all), would lead me to believe that the fault is hardware, presumably the disk controller or its interaction with the microcode.''Mark''s conjecture that Lisp is retaining directory information over logout has some appeal given the evidence, but in fact Lisp NEVER retains directory information over logout; it always rereads the directory.  The best I could do at bug finding was discovering a bug that, as I read it, would result in Lisp retaining information about the DiskDescriptor over logout for the boot partition or another partition IF there were files open on that partition over logout.  The only affect of this bug would be to get DISKFREEPAGES, and the number the Alto exec reports, wrong. ''	Bill''Edit-By: Sannella.PAEdit-Date: 28-Jun-84 15':34':21Attn: vanMelleAssigned To: In/By: Disposition: System: Operating SystemSubsystem: Dolphin/Dorado DiskMachine: 1132Disk: Microcode Version: Memory Size: File Server: Server Software Version: Difficulty: HardFrequency: EverytimeImpact: ModeratePriority: HopefullyStatus: OpenProblem Type: BugSource Files: 