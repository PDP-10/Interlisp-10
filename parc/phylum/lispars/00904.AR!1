Number: 904Date:  1-May-84 18':05':15Submitter: Sannella.PASource: Jeffrey Shulman <SHULMAN@RUTGERS.ARPA>Subject: Document XNS packets that 1108 sends outLisp Version: Description: 'Received': from RUTGERS.ARPA by PARC-MAXC.ARPA;  5 APR 84 18':16':56 PST'Date': 5 Apr 84 21':16':44 EST'From': Jeffrey Shulman <SHULMAN@RUTGERS.ARPA>'Subject': Need to know a few XNS things'To': LispSupport.pa'cc': SHULMAN@RUTGERS.ARPA, marantz@RUTGERS.ARPA'''	Roy Marantz has gotten up a preliminary 3Mb to 10MB packet'"transmorgifyer" so our DLions can talk to our DEC-20 3Mb Pup based'software (this all runs on an 11/60 running as a gateway between the'two.)  There are only a few problems':''	1) What XNS does the "Install Lisp Tool" send out before it will'	   do a PupFtp "install"?  What should we say back to start the'	   Pup based transfer?''	2) Every second or so the DLion sends out an XNS packet for I believe'	   routing info.  What should we send back to shut it up?''	3) During a "1 boot" when it asks for the time (code 937 on the'	   display panel) it does this with an XNS packet.  What is'	   the format of an XNS date/time request?''	Item 1 is critical to our continuing use of DLions since we'generate our own images to use daily.  Thanks.''							Jeff'-------''Date':  6 Apr 84 17':01':58 PST (Friday)'From': JFung.pasa'Subject': Re': Questions from Shulman'In-reply-to': Sannella.PA''s message of 6 Apr 84 12':19':43 PST (Friday)'To': Sannella.PA'cc': JFung, LispSupport.pa''Mike,''I hate to "speculate" on item 1, I can collect XNS packets with the CourierPeekTool (SDD''s tool).   If you can wait, I''ll try to gather these packets for you.  But, I will be in El Segundo testing DEI-DLion file transfer (teknowledge''s crisis), next monday, tuesday....''Here is the speculation if you can''t wait.''1).	What XNS does the "Install Lisp Tool" send out before it will'	do a PupFtp "install"?  What should we say back to start the'	Pup based transfer?'	'	The Install Lisp Tool does not send XNS packets on PupFtp install. When Dlion is power-up, the pilot boot file sends some XNS packets, like CH''s BroaadcastForServers (pkt-exchange), CH''s Retrieve Item(courier), Time-request/response(pkt-exchange), Router-request(Routing Info) packets.'	'When you retrieve sysout from NS file server, you will then encounter some XNS packets like':'	a.	Open-Connection {SPP system packets, sst=0} Pkt'	b.	Series of Filing (Courier) packets (Logon, Open-Directory, Open-Drawer, Open-Folder, Store, followed by proper Closes)'		I am not certain whether BulkData Transfer protocol is used in Pilot 10.'	c.	I am not sure whether Close-Connection packets (SPP with sst 254, 255) are used.	'		'Is this what they want?	(Im not sure whether I answered to the point)''''3).	The XNS Time-Request packet is documented in XSIS Misc. Standards.  This may still be Xerox private.  Here is the format':''Time-Request Packet Format':''	Level-1':'		word 0':		Checksum'		word 1':		packet length'		word 2':		transport control/packet type'		word 3-7':	destination address (net/host)'		word 8':		destination socket'		word 9-13':	Source address	'		word 14':	source socket (time-socket =8)		''	Level-2':'		word 0-1':	packet-exchange ID'		word 2':		client type (1=Time packet)'		'    '	Level-3':'		word 0':		Protocol version'		word 1':		Request type (1)'		'''Time-Response Packet Format':''	Level-1':'		word 0':		Checksum'		word 1':		packet length'		word 2':		transport control/packet type'		word 3-7':	destination address (net/host)'		word 8':		destination socket'		word 9-13':	Source address	'		word 14':	source socket (time-socket =8)		''	Level-2':'		word 0-1':	packet-exchange ID'		word 2':		client type (1=Time packet)'		'    '	Level-3':'		word 0':		Protocol version'		word 1':		Response type (2)'		word 2-3':	Current Time (GMT)'		word 4':		Offset direction'		word 5':		Offset hours'		word 6':		Offset minutes'		word 7':		Start of DST'		word 8':		End of DST'		word 9':		Tolerance flag'		word 10-11':	Tolerance (+/- msec).'	'-----''Date': 11 Apr 84 15':05 PST'From': vanMelle.pa'Subject': Re': Questions from Shulman'In-reply-to': Sannella.PA''s message of 10 Apr 84 17':13':15 PST (Tuesday)'To': Sannella.PA'cc': vanMelle.pa, Masinter.PA, Sheil.PA''Aside from containing potentially private data, his answer is not even correct.''(1) is the problem that Mesa is sending out the XNS packet requesting the Dandelion''s Pup identity.''(2) I''m inclined to believe this is related to 1 or 3.''(3) His answer is only half correct.  The protocol he describes is indeed the official XNS time server protocol (which might be private, but is easy to infer); however, Mesa boot uses a nonstandard variant of it.''Chuck Hedrick at Rutgers has asked some of the same questions.  And I long ago sent Hedrick the protocol for (1).  Recommend Shulman and Hedrick get together.  There ought to be a single site liaison over there!''	Bill''-----''Date': 25 Apr 84 11':26 PST'From': vanMelle.pa'Subject': Re': Need to know a few XNS things'To': Shulman@Rutgers'cc': LispSupport.pa, vanMelle.pa''	1) What XNS does the "Install Lisp Tool" send out before it will'	   do a PupFtp "install"?  What should we say back to start the'	   Pup based transfer?''This is the request for pup identity.  I long ago sent the specs to Chuck Hedrick.  Recommend you coordinate with him.''	2) Every second or so the DLion sends out an XNS packet for I believe'	   routing info.  What should we send back to shut it up?''Could you clarify?  Is this when running Lisp or the install tool?  Is it really continuous?  Any hint as to what the packet contains?  It''s conceivable it''s a request for NS routing info (a packet whose format is documented in the publicly available NS transport protocols document), but Lisp sends these only every 3 seconds and times out after 15 seconds or so if nobody responds.''	3) During a "1 boot" when it asks for the time (code 937 on the'	   display panel) it does this with an XNS packet.  What is'	   the format of an XNS date/time request?''It''s a "packet exchange" packet.''In the NS header':'Type = 4, Socket = 8''In the NS body':'Word 0,1':	ID (chosen by requestor, copied by responder)'Word 2':	Client type = 1'Word 3':	Version = 1'Word 4':	Operation = {Request(1), Reply(2)}'In the response only (values essentially same as in Pup time ops)':'Word 5,6':	Date&Time (GMT)'Word 7':	Offset sign = {west of Greenwich(0), east(1)}'Word 8':	Hours offset from GMT'Word 9':	Minutes offset (usually zero)'Word 10':	Start of DST'Word 11':	End of DST'Word 12,13':	Clock tolerance (msecs; ignored by Lisp)''There is an unofficial variant of this protocol which is similar, but is type = 123 and omits words 2 and 3 of the body.   I think this protocol is used by at least some versions of the install tool.'Workaround: Test Case: Edit-By: Edit-Date:  1-May-84 18':01':08Attn: ReleaseAssigned To: In/By: Disposition: System: DocumentationSubsystem: Internal System DocumentationMachine: Disk: Microcode Version: Memory Size: File Server: Server Software Version: Difficulty: HardFrequency: EverytimeImpact: AnnoyingPriority: UnlikelyStatus: FixedProblem Type: DocumentationSource Files: 