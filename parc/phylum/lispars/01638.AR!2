Number: 1638Date: 12-Jul-84 12':06':42Submitter: Sannella.PASource: AHenderson.paSubject: Suspicious hard disk error on Dorado local disk after disk full errorAssigned To: Attn: vanMelle, jonlStatus: OpenIn/By: Problem Type: BugImpact: SeriousDifficulty: ModerateFrequency: OncePriority: HopefullySystem: Operating SystemSubsystem: Dolphin/Dorado DiskMachine: Disk: Lisp Version: Source Files: Microcode Version: Memory Size: File Server: Server Software Version: Disposition: '["Sannella.PA" "26-Sep-84 14':33':52" Subject': Description':]Description: 'Date': 12 Jul 84 11':46 PDT'From': AHenderson.pa'Subject': Lisp': Suspect hard disk error on Dorado local disk.'To': LispSupport.pa'cc': AHenderson.pa''Lisp System Date': 10-Jun-84 18':41':09'Machine': Dorado (AHenderson)'Microcode version': 24,4'Memory size': 10000'Frequency': Once'Impact': Serious''Facts':''Moving a message from one lafite mailfolder to another. Both mailfolders on a partition of the local Dorado disk, but not the partition in which I was running (a "remote partition"). Ran out of space in the "to" mailfolder (and the whole remote partition). Got a break': "File system resources exceeded". Used DELFILE to delete some files in the remote partition. Typed OK to the break and immediately got another break "Hard disk error" in the remote partition. ''I was subsequently able to able to create new files on the remote partition. Also I was ablt to COPYFILE from the file on which the hard disk error had been reported without trouble. However, any attempt to write that folder (specifically, attempts by Lafite to CLOSEF that file) produced further Hard Disk Error breaks.''I then COPYFILE''d all files worth saving off the remote partition, logged out, went to the remote partition, and certified the disk. No troubles (count them, zero!) were encountered in ten (10) passes through the read/write cycle! I then COPYFILE''d the saved files back onto the partition, have sussessfully added more meesages to the original "to" mailfolder without problem, and am proceeding happily.''Suspicion': There is an interaction between running out of space on a partition on the local disk and a subsequent report of Hard Disk Error after making space. Two specifics of this case may or may not be important': using a Dorado, and the remoteness of the partition. ''Certainly, the analogous activity on a file system on an IFS file server does not produce this problem': you run out of space, and then, while in the break, CHAT to the server and delete some files, quit out of CHAT, and then OK out of the break and all is well. Come to think of it, I haven''t tried the closer analogy': instead of using CHAT, use DELFILE. ''All the best,''Austin''-----''Date': 25 Sep 84 14':50 PDT'From': Masinter.pa'Subject': graceless failure for disk full when creating {DSK}EMPRESS.SCRATCH'To': LispSupport, Kaplan, vanMelle''on Dorado, I tried to (LISTFILES DWIMIFY). It spawned a process to do the listfiles, which eventually broke because there wasn''t enough room for {DSK}EMPRESS.SCRATCH.''It was under SETXY.IP (why .PRESS for interpress files?). The error FILE SYSTEM RESOURCES EXCEEDED was not marked as "continuable" (the call to \LISPERROR didn''t have \CONTINUEOK set to T). I tried to delete files from {DSK} and then do a REVERT, but it caused a HARD DISK ERROR and then a hard disk error under uninterruptable system code (RAID).''I recall that this used to be more graceful -- i.e., you could delete files from {DSK} and continue.''-----''Date': 25 Sep 84 17':30 PDT'From': Kaplan.pa'Subject': Re': graceless failure for disk full when creating {DSK}EMPRESS.SCRATCH'In-reply-to': Masinter.pa''s message of 25 Sep 84 14':50 PDT'To': Masinter.pa'cc': LispSupport.pa, vanMelle.pa''Don''t understand "was under SETXY.IP (why .PRESS for interpress files?)".  Don''t see any .PRESS there?  Were you trying to make a press file, and you are surprised about the .IP?''I don''t think there is anything to do in the printing code on this--must be deep inside the disks bout function.''--Ron''-----''Date': 25 Sep 84 20':52 PDT'From': vanMelle.pa'Subject': Re': graceless failure for disk full when creating {DSK}EMPRESS.SCRATCH'In-reply-to': Masinter.pa''s message of 25 Sep 84 14':50 PDT'To': Masinter.pa'cc': LispSupport.pa, Kaplan.pa, vanMelle.pa''I''m not sure it ever was more graceful.  The FILE SYSTEM RESOURCES EXCEEDED error is generated down in the bowels of the code that writes out buffers, a place where OK will not revert to the right place.  It would take some work to restructure the code so it could effectively "catch" that error and resume.  That certainly qualifies for an AR.''The graceful behavior you''re probably thinking of is for remote file servers, which generate the error on OPENFILE, which is easily resumable.''	Bill'''Workaround: Test Case: Edit-By: Sannella.PAEdit-Date: 26-Sep-84 14':33':53