<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
    <title>[eris]&lt;Lisp>fugue.5>Sources>dlion>IOPMain.mc!1</title>
  </head>
  <body>
    <div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif">{File name:  IOPMain.mc<br>Last edited by Jim August 20, 1981  2:20 PM: Fix for new assembler. <br> Last Edited by Jim Frandeen: March 23, 1981  2:07 PM: Fix bug in WriteSwapped that caused grief when transferring only one word.<br> Last Edited by Sandman: January 22, 1981  11:32 AM<br> Last Edited by Roy Ogus: July 8, 1980  12:04 AM<br> Description: Microcode to implement the IOP-CPport functions.<br> Author: Roy Ogus,<br>}</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif"><br>{NOTES:<br>-  Word counter is used.  Must be an even number of bytes.<br>-  BYTE ORDER:</span><span class="tab" val="79"></span><span style="font: 8pt serif">normal byte order is low byte, high byte.  <br>-  </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 8pt serif">swapped byte order is high byte, low byte.<br>-  Memory addresses are real.<br>-  The inner loop uses a maximum buffer address as terminator.}</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif"><br>{Register usage:<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">IOP</span><span class="tab" val="79"></span><span style="font: 8pt serif">-</span><span class="tab" val="79"></span><span style="font: 8pt serif">Memory address<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">rhIOP</span><span class="tab" val="79"></span><span style="font: 8pt serif">-</span><span class="tab" val="79"></span><span style="font: 8pt serif">High memory address<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">rTmp</span><span class="tab" val="79"></span><span style="font: 8pt serif">-</span><span class="tab" val="79"></span><span style="font: 8pt serif">Temp accumulator<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">uBufMax</span><span class="tab" val="79"></span><span style="font: 8pt serif">-</span><span class="tab" val="79"></span><span style="font: 8pt serif">Maximum buffer address}<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
</div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif">Set[IOPTask, 5];<br>{set in Dandelion.df<br>  Set[IOPOutMode, 2];</span><span class="tab" val="46"></span><span class="tab" val="46"></span><span style="font: 8pt serif">{IOP port output mode}<br>  Set[IOPAWMode, 3];</span><span class="tab" val="46"></span><span class="tab" val="46"></span><span style="font: 8pt serif">{IOP port alwaysWU mode}}<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif">{  loaded into L7<br>   COMMANDS:<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">0 - Write Memory Block<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">1 - Read Memory Block<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">2 - Do Naked Notify<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">3 - (unimplemented)<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">4 - (unimplemented)<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">5 - Write Swapped Block<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">6 - Read Swapped Block}<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif">{IOP  Task code}</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: justify">
<span style="font: 8pt serif"><br></span><span class="tab" val="46"></span><span style="font: 8pt serif">SetTask[IOPTask], StartAddress[IOPIdle];<br><br>{Top of the IOP code.  The code is started at this point for a new command.<br>  IOP Control should be set to InMode.}</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif"><br>IOPIdle:</span><span class="tab" val="46"></span><span style="font: 8pt serif">CANCELBR[$,0F],</span><span class="tab" val="46"></span><span style="font: 8pt serif">c1; {Dispatch}<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">Xbus &larr; IOPIData, XDisp,</span><span class="tab" val="46"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">L7 &larr; 0, DISP3[IOPCmd],</span><span class="tab" val="46"></span><span style="font: 8pt serif">c3;</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif"><br><br>{**************************************************************************}</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif"><br>{COMMAND 0:  Write memory block.<br>     Format of transfer (bytes):<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">command (2 bits), low addr (10:17), mid. addr (2:9), high addr (0:1), <br></span><span class="tab" val="46"></span><span style="font: 8pt serif"> low count-1 (8:15), high count-1 (0:7),<br></span><span class="tab" val="46"></span><span style="font: 8pt serif"> low data, high data, .....<br><br>    IOP Control is in InMode}</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif"><br>{return from IOPSub}<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">rTmp &larr; rTmp + rIOP,</span><span class="tab" val="46"></span><span style="font: 8pt serif">c3, at[0,10,IOPRet];<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif">WFirst:</span><span class="tab" val="46"></span><span style="font: 8pt serif">uBufMax &larr; rTmp, GOTO[WLo2],</span><span class="tab" val="46"></span><span style="font: 8pt serif">c1;<br><br>WLo:</span><span class="tab" val="46"></span><span style="font: 8pt serif">MAR &larr; [rhIOP, rIOP], rIOP&larr;rIOP+1,</span><span class="tab" val="46"></span><span style="font: 8pt serif">c1;<br>WLo2:</span><span class="tab" val="46"></span><span style="font: 8pt serif">MDR &larr; rTmp, rTmp &larr; IOPIData, LOOPHOLE[mdrok], CANCELBR[$, 0],</span><span class="tab" val="46"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">rTmp &larr; rTmp LRot8,</span><span class="tab" val="46"></span><span style="font: 8pt serif">c3; </span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif"><br>WHiByte:</span><span class="tab" val="46"></span><span style="font: 8pt serif">[] &larr; rIOP xor uBufMax, ZeroBr,</span><span class="tab" val="46"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">rTmp &larr; rTmp or IOPIData, BRANCH[$,WLo3Last],</span><span class="tab" val="46"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">rTmp &larr; rTmp LRot8, GOTO[WLo],</span><span class="tab" val="46"></span><span style="font: 8pt serif">c3; </span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: justify">
<span style="font: 8pt serif"><br>{This byte is the last byte.  Since we have to do one more click, set AlwaysWakeMode.  Have to put in an extra click to get everything done.  **Try to fix**.  There will be no page crossing, so do the memory reference and then go back to top of the loop.}<br><br>WLo3Last:</span><span class="tab" val="46"></span><span style="font: 8pt serif">IOPCtl &larr; IOPAWMode,</span><span class="tab" val="46"></span><span style="font: 8pt serif">c3;<br><br></span><span class="tab" val="46"></span><span style="font: 8pt serif">rTmp &larr; rTmp LRot8,</span><span class="tab" val="46"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">Noop,</span><span class="tab" val="46"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">Noop,</span><span class="tab" val="46"></span><span style="font: 8pt serif">c3;<br><br>WLoLast:</span><span class="tab" val="46"></span><span style="font: 8pt serif">MAR&larr; [rhIOP, rIOP+0],</span><span class="tab" val="46"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">MDR &larr; rTmp,</span><span class="tab" val="46"></span><span style="font: 8pt serif">c2;<br>IOPDone:</span><span class="tab" val="46"></span><span style="font: 8pt serif">IOPCtl &larr; IOPInMode, GOTO [IOPIdle],</span><span class="tab" val="46"></span><span style="font: 8pt serif">c3;</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif"><br><br>{**************************************************************************}</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif"><br>{COMMAND 1:  Read memory block.<br>     Format of transfer (bytes):<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">command (4 bits), low addr (10:17), mid. addr (2:9), high addr (0:1),<br></span><span class="tab" val="46"></span><span style="font: 8pt serif"> low count-1 (8:15), high count (0:7)<br></span><span class="tab" val="46"></span><span style="font: 8pt serif"> =&gt; returns:   low data, high data, .....<br><br>    IOP Control is in InMode}</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif"><br>CReadMem:</span><span class="tab" val="46"></span><span style="font: 8pt serif">rIOP &larr; IOPIData, CALL[IOPSubc2],</span><span class="tab" val="46"></span><span style="font: 8pt serif">c1, at [1,4,IOPCmd];<br><br></span><span class="tab" val="46"></span><span style="font: 8pt serif">rTmp &larr; rTmp + rIOP, IOPCtl &larr; IOPOutMode,</span><span class="tab" val="46"></span><span style="font: 8pt serif">c3, at[1,10,IOPRet];<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif">RLo:</span><span class="tab" val="46"></span><span style="font: 8pt serif">MAR &larr; [rhIOP, rIOP+0], BRANCH[RFirst, RRest],</span><span class="tab" val="46"></span><span style="font: 8pt serif">c1;<br>RFirst:</span><span class="tab" val="46"></span><span style="font: 8pt serif">uBufMax &larr; rTmp, GOTO[RFetch],</span><span class="tab" val="46"></span><span style="font: 8pt serif">c2;<br>RRest:</span><span class="tab" val="46"></span><span style="font: 8pt serif">GOTO[RFetch],</span><span class="tab" val="46"></span><span style="font: 8pt serif">c2;<br>RFetch:</span><span class="tab" val="46"></span><span style="font: 8pt serif">IOPOData &larr; rTmp &larr; MD,</span><span class="tab" val="46"></span><span style="font: 8pt serif">c3;</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif"><br>RHigh:</span><span class="tab" val="46"></span><span style="font: 8pt serif">IOPOData &larr; rTmp LRot8,</span><span class="tab" val="46"></span><span style="font: 8pt serif">c1; <br></span><span class="tab" val="46"></span><span style="font: 8pt serif">[] &larr; rIOP xor uBufMax, ZeroBr,</span><span class="tab" val="46"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">rIOP &larr; rIOP+1, NZeroBr, BRANCH[RLo, RDone],</span><span class="tab" val="46"></span><span style="font: 8pt serif">c3;</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif"><br>RDone:</span><span class="tab" val="46"></span><span style="font: 8pt serif">CANCELBR[IOPDonec2,1],</span><span class="tab" val="46"></span><span style="font: 8pt serif">c1;<br><br><br><br>{**************************************************************************}<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif">{COMMAND 2:  Do Naked Notify.<br>     Format of command:<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">command (2 bits), low interrupt mask, high interrupt mask.<br><br>    IOP Control is in InMode}<br><br>{return from IOPSub with mask in rTmp; need to do another click}<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">IOPCtl &larr; IOPAWMode,</span><span class="tab" val="46"></span><span style="font: 8pt serif">c3, at[2,10,IOPRet];<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif">{OR into wakeup U-register.  This must be done in one click.}<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">rIOP &larr; uWP, MesaIntRq,</span><span class="tab" val="46"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">rTmp &larr; rTmp or rIOP, IOPCtl &larr; IOPInMode,</span><span class="tab" val="46"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">uWP &larr; rTmp, GOTO [IOPIdle],</span><span class="tab" val="46"></span><span style="font: 8pt serif">c3;<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif"><br>{**************************************************************************}<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif">{COMMAND 3:  (unimplemented)}<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif">Command3:</span><span class="tab" val="46"></span><span style="font: 8pt serif">Noop,</span><span class="tab" val="46"></span><span class="tab" val="46"></span><span style="font: 8pt serif">c1, at[3,10,IOPCmd];<br>IOPDonec2:</span><span class="tab" val="46"></span><span style="font: 8pt serif">CANCELBR [IOPDone, 2],</span><span class="tab" val="46"></span><span class="tab" val="46"></span><span class="tab" val="46"></span><span style="font: 8pt serif">c2;<br><br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif"><br>{**************************************************************************}<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif">{COMMAND 4:  (unimplemented)}<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif">Command4:<br>IOPDonec1:</span><span class="tab" val="46"></span><span style="font: 8pt serif">GOTO[IOPDonec2],</span><span class="tab" val="46"></span><span class="tab" val="46"></span><span style="font: 8pt serif">c1, at[4,10,IOPCmd];<br><br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif"><br>{**************************************************************************}<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif">{COMMAND 5:  Write Swapped Block}<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif">WriteSwapped:</span><span class="tab" val="46"></span><span style="font: 8pt serif">rIOP &larr; IOPIData, CALL[IOPSubc2],</span><span class="tab" val="46"></span><span class="tab" val="46"></span><span style="font: 8pt serif">c1, at[5,10,IOPCmd];<br><br></span><span class="tab" val="46"></span><span style="font: 8pt serif">rTmp &larr; rTmp + rIOP,</span><span class="tab" val="46"></span><span style="font: 8pt serif">c3, at[5,10,IOPRet];<br><br></span><span class="tab" val="46"></span><span style="font: 8pt serif">uBufMax &larr; rTmp, GOTO[WSHighx],</span><span class="tab" val="46"></span><span style="font: 8pt serif">c1;<br><br>WSHigh:</span><span class="tab" val="46"></span><span style="font: 8pt serif">rIOP &larr; rIOP+1, BRANCH[$,WSDone],</span><span class="tab" val="46"></span><span style="font: 8pt serif">c1;<br>WSHighx:</span><span class="tab" val="46"></span><span style="font: 8pt serif">rTmp &larr; IOPIData, </span><span class="tab" val="46"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">rTmp &larr; rTmp LRot8,</span><span class="tab" val="46"></span><span style="font: 8pt serif">c3; </span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif"><br>WSLo:</span><span class="tab" val="46"></span><span style="font: 8pt serif">MAR &larr; [rhIOP, rIOP+0],</span><span class="tab" val="46"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">MDR &larr; rTmp or IOPIData, CANCELBR[$, 0],</span><span class="tab" val="46"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">[] &larr; rIOP xor uBufMax, ZeroBr, GOTO [WSHigh],</span><span class="tab" val="46"></span><span style="font: 8pt serif">c3; </span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif"><br>WSDone:</span><span class="tab" val="46"></span><span style="font: 8pt serif">GOTO[IOPDone],</span><span class="tab" val="46"></span><span style="font: 8pt serif">c2;<br><br><br>{**************************************************************************}<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif">{COMMAND 6:  Read Swapped Block}<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif">ReadSwapped:</span><span class="tab" val="46"></span><span style="font: 8pt serif">rIOP &larr; IOPIData, CALL[IOPSubc2],</span><span class="tab" val="46"></span><span class="tab" val="46"></span><span style="font: 8pt serif">c1, at[6,10,IOPCmd];<br><br></span><span class="tab" val="46"></span><span style="font: 8pt serif">rTmp &larr; rTmp + rIOP, IOPCtl &larr; IOPOutMode,</span><span class="tab" val="46"></span><span style="font: 8pt serif">c3, at[6,10,IOPRet];<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif">RSLo:</span><span class="tab" val="46"></span><span style="font: 8pt serif">MAR &larr; [rhIOP, rIOP+0], BRANCH[RSFirst, RSRest],</span><span class="tab" val="46"></span><span style="font: 8pt serif">c1;<br>RSFirst:</span><span class="tab" val="46"></span><span style="font: 8pt serif">uBufMax &larr; rTmp, GOTO[RSFetch],</span><span class="tab" val="46"></span><span style="font: 8pt serif">c2;<br>RSRest:</span><span class="tab" val="46"></span><span style="font: 8pt serif">IOPOData &larr; rTmp LRot0, GOTO[RSFetch],</span><span class="tab" val="46"></span><span style="font: 8pt serif">c2;<br>RSFetch:</span><span class="tab" val="46"></span><span style="font: 8pt serif">rTmp &larr; MD,</span><span class="tab" val="46"></span><span style="font: 8pt serif">c3;</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif"><br>RSHigh:</span><span class="tab" val="46"></span><span style="font: 8pt serif">IOPOData &larr; rTmp LRot8,</span><span class="tab" val="46"></span><span style="font: 8pt serif">c1; <br></span><span class="tab" val="46"></span><span style="font: 8pt serif">[] &larr; rIOP xor uBufMax, ZeroBr,</span><span class="tab" val="46"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">rIOP &larr; rIOP+1, NZeroBr, BRANCH[RSLo, RSDone],</span><span class="tab" val="46"></span><span style="font: 8pt serif">c3;</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif"><br>RSDone:</span><span class="tab" val="46"></span><span style="font: 8pt serif">IOPOData &larr; rTmp LRot0, CANCELBR[IOPDonec2,1],</span><span class="tab" val="46"></span><span style="font: 8pt serif">c1;<br><br><br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
</div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif">{**************************************************************************<br>Address and count fetching subroutine<br>**************************************************************************}<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif">{Read the low address (10:17)}<br>IOPCmd:<br>IOPSubc1:</span><span class="tab" val="46"></span><span style="font: 8pt serif">rIOP &larr; IOPIData,</span><span class="tab" val="46"></span><span style="font: 8pt serif">c1, at [0,10,IOPCmd];<br>IOPSubc2:</span><span class="tab" val="46"></span><span style="font: 8pt serif">rIOP &larr; rIOP LRot8,</span><span class="tab" val="46"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">Noop,</span><span class="tab" val="46"></span><span class="tab" val="46"></span><span class="tab" val="46"></span><span style="font: 8pt serif">c3;</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif"><br>{Read the middle address (2:9)}<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">rIOP &larr; rIOP or IOPIData,</span><span class="tab" val="46"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">rIOP &larr; rIOP LRot8,</span><span class="tab" val="46"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">Noop,</span><span class="tab" val="46"></span><span class="tab" val="46"></span><span class="tab" val="46"></span><span style="font: 8pt serif">c3;</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif"><br>{Read the high address (0:1) into rhIOP}<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">rhIOP &larr; IOPIData,</span><span class="tab" val="46"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">Noop,</span><span class="tab" val="46"></span><span class="tab" val="46"></span><span class="tab" val="46"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">Noop,</span><span class="tab" val="46"></span><span class="tab" val="46"></span><span class="tab" val="46"></span><span style="font: 8pt serif">c3;</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: justify">
<span style="font: 8pt serif"><br>{Next comes the next parameter.  It is count-1 for write and read and mask for naked notify.}</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif"><br>IOPSub2:</span><span class="tab" val="46"></span><span style="font: 8pt serif">rTmp &larr; IOPIData,</span><span class="tab" val="46"></span><span style="font: 8pt serif">c1, at[2,10,IOPCmd];<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">rTmp &larr; rTmp LRot8,</span><span class="tab" val="46"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">Noop,</span><span class="tab" val="46"></span><span class="tab" val="46"></span><span class="tab" val="46"></span><span style="font: 8pt serif">c3;</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif"><br></span><span class="tab" val="46"></span><span style="font: 8pt serif">rTmp &larr; rTmp or IOPIData, L7Disp,</span><span class="tab" val="46"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="46"></span><span style="font: 8pt serif">rTmp &larr; rTmp LRot8, RET[IOPRet],</span><span class="tab" val="46"></span><span style="font: 8pt serif">c2;<br><br><br>{END}</span></div>
<script>function do_tabs() { // unit = px
  var tabs = document.getElementsByClassName("tab");
  for (var i = 0; i < tabs.length; ++i) {
    var span = tabs[i];
    var val = span.getAttribute("val");
    if (val == null) console.log("Couldn't get val");
    var rect = span.getBoundingClientRect();
    var tabstop;
    if (val > 0) tabstop = Math.ceil(rect.left / val) * val;
    else tabstop = -val;
    console.log("do_tabs", val, tabstop)
    if (tabstop > 0) {
      var width = tabstop - rect.left;
      span.style.display = "inline-block";
      span.style.width = width + "px";
    }
  }
}
do_tabs();
</script>
  </body>
</html>
