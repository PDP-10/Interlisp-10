<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
    <title>File [eris]&lt;Lisp>fugue.5>Sources>dlion>InitLisp.mc!1</title>
  </head>
  <body>
    <pre>
{File name nInitLisp.mc;    DandeLion Interlisp Emulator - InitializationAuthor: PurcellLast edited: 15-Jul-83 11:45:48 by don -- added uLispOptions &larr; 0Last edited: April 6, 1983  1:35 PM; dont move display in new sysoutCreated: January 17, 1983 out of NewLisp.mcLast edited: February 5, 1983  11:42 AM}EFCHaveLink:  CANCELBR[$, 0F],    {from StartMesa with dispatch pending}{**************************************************STALL to test display and maintpanel: 			**************************************************}	Rx &larr; 040{~15 sec}{10/sec},	c1;	rhTT &larr; 41, TT &larr; 41-1,	c2;	TT{14000} &larr; TT LRot8,	c3;	TT{14041} &larr; TT +41,	c1;	Noop,	c2;	Noop,	c3;Stall:	MAR &larr; [rhTT, TT+0], BRANCH[Stall0, Stall1],	c1;Stall0:	MDR &larr; Rx, GOTO[StallJn],	c2;Stall1:	MDR &larr; Rx &larr; Rx  - 1, ZeroBr, GOTO[StallJn],	c2;StallJn:	Q &larr; Q  - 1, ZeroBr, BRANCH[Stall, $],	c3;SkipBurd:	Noop, CANCELBR[SkipBurdock, 0F],	c1;Burdock:	IOPCtl &larr; 1, CANCELBR[$, 0F],	c1;	Noop, GOTO[Burd3],	c2;SkipBurdock:	Noop,	c2;Burd3:	Noop,	c3;{ShowDisplay:}BegSD:	Noop, CANCELBR[$, 0F],	c1;	Rx &larr; 1 RRot1, rhRx &larr; 1, {CANCELBR[$, 1],}	c2;	Rx{4000} &larr; Rx RShift1,	c3;	MAR &larr; [rhRx, 0EB+0],	c1;	Noop{MDR &larr; 0},	c2;	TT &larr; 88,	c3;	MAR &larr; [rhRx, 0EC+0],	c1;	MDR &larr; 0{Q &larr; 41},	c2;	TT &larr; TT LRot8,	c3;	MAR &larr; [rhRx, 0ED{0EF}+0],	c1;	MDR &larr; TT{88} or 22,	c2;	PC &larr; 1 + PC + PC16,	c3;	Noop, {MAR &larr; [rhRx, 0E9+0],}	c1;	Q &larr; 41, {MDR &larr; 0,} {IBDisp,}	c2;	DCtl&larr;Q LRot0, {L2 &larr; L2.0, DISPNI[OpTable],}	c3;Begin:	Rx{182} &larr; 0C1 LRot1,	c1;	Rx &larr; Rx LRot1,	c2;	uPcBreak &larr; Rx{304},	c3;	Rx &larr; VALspace,	c1;	uValHigh &larr; Rx,	c2;	stackP &larr; 0,	c3;BegA:	Rx &larr; Rx xor ~Rx,	c1;	unboundPvar &larr; Rx,	c2;	unboundFvar &larr; Rx,	c3;BegB:	uStkLimO &larr; Rx,	c1;	uWP &larr; 0,	c2;	uWDC &larr; 0{uWDC inited by mesaInit},	c3;	Rx &larr;  ~0FD,	c1;	Rx &larr; Rx LRot8,	c2;	uBfResidualRhmask &larr; Rx{2FF},	c3;	Rx &larr;  0A0,	c1;	Rx &larr; Rx LRot8,	c2;	uFreeStackBlock &larr; Rx{0A000},	c3;	Rx &larr;  0FF + 1,	c1;	uFxNoPushReturn &larr; Rx{100h},	c2;	Rx &larr;  LShift1(Rx + Rx), SE&larr;0,	c3;BegBB:	uFxInCall &larr; Rx{400h},	c1;	Rx &larr;  7F,	c2;	u7F &larr; Rx{7F},	c3;BegBBB:	Rx &larr;  ~0FF,	c1;	u0FF &larr; ~Rx{~0FF},	c2;	uFF00 &larr; Rx{~0FF},	c3;BegC:	TT &larr; Rx{0FF00} or 1,	c1;	TT &larr; TT LRot8,	c2;	u1FF &larr; TT{1FF},	c3;	TT &larr; Rx{0FF00} or 3,	c1;	TT &larr; TT LRot8,	c2;	uTT3FF &larr; TT{3FF},	c3;	TT &larr; Rx{0FF00} or 3,	c1;	TT &larr; TT LRot8,	c2;	u3FF &larr; TT{3FF},	c3;	TT &larr; Rx{0FF00} or 0F,	c1;	TT &larr; TT LRot8,	c2;	u0FFF &larr; TT{0FFF},	c3;	TT &larr; Rx{0FF00} or 1F,	c1;	TT &larr; TT LRot8,	c2;	u1FFF &larr; TT{1FFF},	c3;	TT &larr; Rx{0FF00} or 3F,	c1;	TT &larr; TT LRot8,	c2;	uTT3FFF &larr; TT{3FFF},	c3;	TT &larr; Rx{0FF00} or 3F,	c1;	TT &larr; TT LRot8,	c2;	u3FFF &larr; TT{3FFF},	c3;	TT &larr; Rx{0FF00} or 7F,	c1;	TT &larr; TT LRot8,	c2;	u7FFF &larr; TT{7FFF},	c3;defered:	TT &larr; Rx{0FF00} or 7,	c1;	TT &larr; TT LRot8,	c2;	u7FF &larr; TT{7FF},	c3;	{TT}u7FF &larr; TT{7FF},	c1;	TT &larr; TT xor 1,	c2;	u7FE &larr; TT{7FF},	c3;	TT &larr; 0,	c1;	uLispOptions &larr; TT,	c2;	c3;	{rCount}RCnt &larr; 0,	c1;	{rY}RAdr &larr; 0,	c2;	Rx &larr; 80,	c3;BegD:	Rx &larr;  Rx LRot8,	c1;	Noop,	c2;	uBFmark &larr; Rx{8000},	c3;{compliance: using uSTACKspace with duplicated high byte for bind ptr}BegE:	Rx &larr; STACKspace,	c1;	Rx &larr; Rx LRot8,	c2;	Rx &larr; Rx or STACKspace,	c3;	Noop,	c1;	uSTACKspace &larr; Rx,	c2;	Rx &larr; 0C0,	c3;BegF:	Rx &larr;  Rx LRot8,	c1;	Noop,	c2;	uFXmark &larr; Rx{C000},	c3;	Set[UFNTablePageHalf, Rshift[UFNTablebase, 9]];BegFF:	Rx &larr;  UFNTablePageHalf,	c1;	Rx &larr;  Rx LRot8,	c2;	uUFNTableBaseHalf &larr; Rx,	c3;{Map IOPage to 0,FF00     %%why was it smashed?}	rhTT &larr;  0, CANCELBR[$, 1],	c1;	TT &larr; 0FF,	c2;	TT{0FF00} &larr; TT LRot8,	c3;	Rx &larr; 40,	c1;	Rx &larr; Rx LRot8,	c2;	uPageFault &larr; 0{notFaulting},	c3;	Map &larr; [rhTT,TT],	c1;	MDR &larr; Rx{4000} or 0B1,	c2;	Q &larr; 0,	c3;{change to context Q{fxp}}FXP:	rhTT &larr;  INTERFACEspace, CANCELBR[$, 1],	c1;	TT &larr; INTERFACEbasePage{20'b}{INTERFACEbase=10000'b},	c2;	TT &larr; TT LRot8,	c3;FXP1:	Map &larr; [rhTT,TT],	c1;	rhS &larr; nRhS,	c2;	Rx &larr; rhRx &larr; MD,{ XRefBr,}	c3;	TOSH &larr; 0,{sysout returns true}	c1;	TOS &larr; KTval,	c2;	Noop,	c3;FXP2:	MAR&larr; [rhRx, Q + 0],	c1;	rhPV &larr; nRhS,	c2;	PV{FXP} &larr; MD, GOTO[RTN2],	c3;Reset:	Noop, {CANCELBR[$, 0F],}	c1;Reset2:	uPageFault &larr; 0,	c2;	Q &larr; 1, GOTO[FXP],	c3;	{ E N D }</pre>
  </body>
</html>
