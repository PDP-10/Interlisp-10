TEditKeyGreg NuyensMAY 7, 1985Description:TEditKey is a package which provides a keyboard interface to TEdit.   On a Dandelion, the interface takes advantage of the special keys to the left, top and right of the main keyboard. On Dorados and Dolphins, a window mimicking the Dlion function keys provides some of the same abilities.  The abilities provided include allowing the user to alter the caret looks (the looks of characters typed in) or the selection looks.  These commands are given using the Dlion function keys  and/or metacodes (keys typed while a meta key is held down. The default meta key is the tab key, to alter this see User Switches, below).  Other metacodes and control codes move the cursor within the document (beginning/end of line, back/forward character, up/down a line, etc.)Thus, many of the special Dlion keys are made to function in TEdit the way they are labeled.  The following keys change their behaviour once TEditKey is loaded.CENTER	modifies the justification of the paragraph(s) containing the current selection.  If the selection was left justified, then hitting the CENTER key makes it centered.  Hitting it again produces right and left justification.  BOLD	makes the selection bold.  All other properties remain unchanged.  Holding the shift key down while hitting BOLD, will make the selection become un-bold.ITALICS	makes the selection italicized.  Shift-ITALICS is the opposite.UNDERLINE	makes the selection underlined.  Shift-UNDERLINE is the opposite.SUPERSCRIPT	superscripts the selection by a constant amount.  Any relative superscripts (or subscripts) are maintained.  Thus if "Xi" is selected in "the set Xi is empty" then pressing the SUPERSCRIPT button produces "the set Xi is empty". See USER SWITCHES below for how to set the increment.  Shift-SUPERSCRIPT is the same as SUBSCRIPT SUBSCRIPT	analogous to SUPERSCRIPT.SMALLER	decreases the font size of the selection.  All relative size differences are maintained.  e.g. "this is bigger than that" produces "this is bigger than that".  shift-SMALLER (labelled LARGER) does the opposite.DEFAULTS	makes the selection have default looks.  N.B. The default looks can be set to the current caret looks by typing shift-DEFAULTS.The above keys all affect the caret looks if the keyboard key is held down when they are hit.  Thus holding down KEYBOARD, and then hitting UNDERLINE, makes the caret looks be underlined.FONT	change the font of the selection or caret looks according to the following table:  (to alter this table see USER SWITCHES below:)1	timesroman 2	helvetica 3	gacha4	modern5	classic6	terminal7	symbol8	hippo	Thus, to change the font of the selection to Classic, hold down FONT and hit '5'.  To change the caret font to Classic, hold down FONT (to signal the font change) and KEYBOARD (to direct the change to the caret looks) then hit '5'.  Note that this table is part of the menu displayed when the HELP button is pressed.	On a Dorado, Middle-blank is the FONT key.KEYBOARD 	apply any changes that occur while this key is down to the caret looks instead of the selection. 	On a Dorado, Bottom-blank is the KEYBOARD key.AGAIN 	invokes the redo facility in TEdit.  A wide variety of operations can be repeated very simply by making a selection, performing an operation (for instance, an insertion) then picking a new selection and hitting the AGAIN key. The AGAIN key is an ESCape key, which acts as the TEdit REDO syntax class.  (see p 20.22 Interlisp Reference Manual)OPEN 	Opens a blank line at the current cursor position.  OPEN is also used to type a linefeed outside of TEDIT.  (for example to the function FILES?)FIND 	prompts the user for a target string, then searches from the selection forward.NEXT 	acts as the TEdit NEXT syntax class.  (Goes to the next field to be filled-in. These fields are marked as follows: >>text to be substituted<< )shift-NEXT 	transfers the TTY (which window will receive typed characters) to the next window which can accept typein.  Thus one can cycle through the open text windows (mail windows, top level lisp windows, TEdit windows, etc.) without using the mouse.EXPAND 	expands TEdit abbreviations. (see p. 20.31 IRM)HELP 	displays a menu of the keybindings until a mouse key is clicked.UNDO 	acts as the TEdit UNDO syntax class.  Note that it still retains its TELERAID function as does STOP.   There are TEditKey operations (such as Transpose Characters) which are implemented with multiple TEdit operations.  Since TEdit will UNDO only single operations, it does not fully UNDO these operations.RightArrow 	enters \, and | when shifted.  (Recall that AGAIN is an escape key)MARGINS 	Indents the margins of the paragraph selected.  Shift-MARGINS exdents the margins. If the right margin is a floating margin, it is left unchanged.  To control the amount by which the margins are moved, see USER SWITCHES. As well as the previous functions available on the Dandelion's special keys, the following functions are available on the standard keyboard (thus usable on the Dandelion, Dolphin and Dorado).  Each function is shown with the key that invokes it (in conjunction with the control (denoted ^) or meta (denoted #) key).   Thus, for the sixth entry, holding down the metakey and hitting f (or "F") would move the caret one word forward.  (To find out how to get a metakey see USER SWITCHES below.)#/	default the caret looks #=	query caret looks#9	smaller caret font #0	larger caret font^b	back char  ^f	forward char#b	back word#f	forward word^p	previous line^n	next line^a	beginning of line^e	end of line#<	beginning of document#>	end of document^k	kill line (delete from caret to end of line)^o	open line^d	delete character forward (also on shift backspace)#d	delete word forward (as always ^w deletes word backward)^t	transpose characters#[	indent paralooks.  also available on the MARGINS key.#]	exdent paralooks.  also available as shift-MARGINS.#j	justification  change (same as CENTER key)#u	uppercasify selection#l	lowercasify selection#o	insert object into document #?	show keybindings (same as HELP)#r	restore the displayNote that the positions of any of these functions can be individually changed using TEDIT.SETFUNCTION (see p. 20.30 IRM).  For wholesale customization see User Switches below.Interrupts: Any operation can be aborted by typing the STOP key.  This can be used to abort font changes, GETs, PUTs, etc.   A stronger form of interrupt is available as shift-STOP, which prompts the user for a menu of processes to interrupt.^G is available as a synonym for hitting the STOP key within TEditKey.  Outside of TEdit, however, ^G will continue to have the meaning specified in the user's init file.  This is often the HELP interrupt, which acts as shift-STOP.Users who are accustomed to typing ^E as a soft interrupt should note that ^E moves to the end of line.  As discussed above, hitting the STOP key (or equivalently, typing ^G) accomplishes what ^E did.Since ^H is defined to be the Backspace action in TEditKey, users can not type ^A to erase characters even outside of TEditKey (Interlisp-D currently does not allow multiple backspace characters).  In addition to the changed functionality mentioned above (provided courtesy of TEditKey), the user should be aware of the following standard Interlisp-D/Tedit behaviour:SAME operates as a LooksCopy mode key.   First make a selection.  Now to copy the looks from some other text simply hold down the SAME key, then select the source for the looks.  (paragraph looks can be copied the same way, but by making the final selection while in the left margin.  This is the standard way to select a whole paragraph in TEdit.)MOVE and COPY act as mode keys for the selection mechanism.   Thus the user can select the destination , then hold down the MOVE key and make a second selection.  This selection will be moved (or COPY'd depending on the mode key used) to the (original) caret position.CONTROL operates as a mode key to signal deletion.   This means that holding down the CONTROL key and selecting some text will delete that text when the CONTROL key is released.DELETE deletes the current selection when pressed.Dorado Equivalences:Dlion Key:	Equivalent key on Dorado:OPEN	^o ( or ^O)SAME	METAFIND	find item in TEdit menuAGAIN	ESCDELETE	DELCOPY	SHIFTMOVE	CTRL-SHIFTPROP'S	META or LOCK depending on switchesNEXT	#n ( or #N)EXPAND	^x (or ^X)HELP	#?MARGINS	#[	(unnest (which is shift-MARGINS on the DLion) is #] )FONT	top blank KEYBOARD	middle blank UNDO	bottom blankSTOP	^Gshift-STOP	#^S (intentionally difficult to type accidently)The function keys (CENTER, BOLD, etc.) are all available on the fn key window brought up when TEditKey is loaded on a Dorado.Note that the function key window can be rebuilt on a Dorado by selecting "Function Keys" in the default TEdit menu (obtaining by buttoning in the title bar of a TEdit window).User Switches:TEDITKEY.METAKEY	The user must choose a metakey to make use of TEditKey.  The value of the variable TEDITKEY.METAKEY is the name of the key which will be your metakey.  For instance to make TAB (the default) your metakey, (SETQ TEDITKEY 'TAB) before loading TEditKey.   (note that even in the standard system, TAB is available as Control-I).	NOTE: METASHIFT (see p 18.9 of the IRM) is redefined to operate on TEDITKEY.METAKEY instead of on the bottom-blank key of the Dorado.The operation of TEditKey is controlled by the following (INITVARed) variables:TEDITKEY.LOCKTOGGLEKEY This is the key which will be turned into a lock-toggle.  If it is non-NIL, that key is set to act as a lock-toggle.  Thus hitting this switches the case of the typein.  For those users who have removed the spring from their lock key,  TEDITKEY.LOCKTOGGLEKEY is usually PROP'S.  The action of LOCK is then made to be '(CTRLDOWN . CTRLUP) providing the user with a control key where LOCK is located and a lock toggle where PROP'S is located.TEDITKEY.FONTS  This is an eight element list of the fonts that are invoked by meta-1 through meta-8.  The defaults are listed above.TEDIT.DEFAULT.CHARLOOKS  This defines the looks that result when the DEFAULTS key is pressed or when default caret looks are requested.  It is an instance of the CHARLOOKS datatype.  To preset it, for instance, to TIMESROMAN 10 type the following to the lisp top level.(SETQ TEDIT.DEFAULT.CHARLOOKS (CHARLOOKS.FROM.FONT (FONTCREATE 'TIMESROMAN 10)))However, a much simpler method is to select an instance of the desired looks, and type shift-DEFAULTS.TEDITKEY.VERBOSE	if T (the default), the functions which modify the caret looks print feedback in the (TEdit) promptwindow.TEDITKEY.NESTWIDTH 	the distance (in points) that the indent and exdent functions move the margins.  Initially 36 points (0.5 inches).\TK.SIZEINCREMENT	the amount (in points) which the LARGER function increases the selection.  (and conversely for SMALLER)  Initially 2 points.TEDITKEY.OFFSETINCREMENT	the amount (in points) which the SUBSCRIPT function raises the selection. (and conversely for SUPERSCRIPT)  Initially 3 points.TEDITKEY.KEYBINDINGS	the list which controls the mapping of keys to functions for the functions that are common to the Dlion, Dorado and Dolphin.  It consists of triples of function name, list of CHARCODE-style character specifications, and a comment describing what the function does.  (the comments are used by the automated menu building tools and their inclusion is encouraged) TEDITKEY.DLION.KEYACTIONS 	the list which specifies the keyactions of the non-Alto keys (to the left and right) on the DLion.  It is the format acceptable to MODIFY.KEYACTIONS (p. 18.9 of the IRM)TEDITKEY.DLION.KEYBINDINGS 	the list specifying the functions to be tied to the characters generated from above.  The keynames in the CAR of each element are comments.  Note that TEDIT.DLION.KEYACTIONS and TEDIT.DLION.KEYBINDINGS must be coordinated (similarly for TEDITKEY.FNKEYACTIONS and TEDITKEY.FNKEYBINDINGS).TEDIT.DLION.KEYSYNTAX 	the list of syntax classes to be applied to the DLION keys.TEDITKEY.FNKEYACTIONS 	the list which specifies the keyactions of the function keys (center, bold, etc.).TEDITKEY.FNKEYBINDINGS 	analogous to TEDIT.DLION.KEYBINDINGS but for the fn keys.TEDITKEY.DORADO.KEYACTIONS	The keyactions unique to the Dorado (and Dolphin).TEDITKEY.DORADO.KEYSYNTAX	analogous to TEDIT.DLION.KEYSYNTAXThe previous variables in conjunction with the following functions specify the effect of TEditKey.(TEDITKEY.INSTALL readtable)	invokes the keyactions and bindings as specified by the above variables on readtable.  (readtable defaults to TEDIT.READTABLE).(\TK.BUILD.MENU)	function which automagically builds the help menu from the values of the above variables.       $ $   
                             
       x                    $ „   
       `                          
                       $ $                           $ $                                                           `   
       `                      `   
       `                          
                                                           	HELVETICA          
TIMESROMAN        € 	HELVETICA 
         GACHA 
         	HELVETICA         GACHA         
TIMESROMAN 
        
TIMESROMAN          
TIMESROMAN         GACHA 
        GACHA          
TIMESROMAN         
TIMESROMAN          
TIMESROMAN 
        
TIMESROMAN 
ÿý      
TIMESROMAN 
ÿý       GACHA 
        GACHA 
         
TIMESROMAN 
        
TIMESROMAN 
         
TIMESROMAN 
                                               
  $          
   >           	   #             h          
   ¡          	          ˆ              R                 	          l              )                 	          '                               	   	                     !       	                        	          w                                                               A                                   	                    	                                         §                                                w                                     
   q                     	       '                    ƒ                                                                 	             
                          	                                              @              >              !              v                                         !                                  d                    !                                  Ù              
              l                    “                    R                    ’             
       ô                    2                    C                   4             
       F                    8                            ‹                       
  ~              n                                                                                                                                                                                                                                                        0                          6             <                                       9             7             "                                                                                                                                               
   °          
                       ç             è             É             Ç          
                ª                    ~              ×                                  o              D              E                    O              <                                  -                                                     $                                                                                                                                                                                    $                                                                                :                                                                                                           2                                         _             ±                                                        	          S              j              D                               	                        _          	   P          	          ì                                                        .              $                        	          x          	          .              U       	       +       
                     +             Q             ]                        	          l          	          u          	          "              8                        	          "       	       4                        	         j          	          …                        	          ™                            $                                      	          >          	          U          	                                  	          4          	                                  	             	             	   c          	          	    
                    	   L       	    
          	    
                           	             	          Y      2#÷z¹