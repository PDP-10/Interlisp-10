<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
    <title>[eris]&lt;Lisp>Harmony>DlionInitial>Shugart>Klamath>DISKBOOTIOCBS.BRAVO!1</title>
  </head>
  <body>
    <div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">;DiskBootIOCBs.bravo  last edited by Jim Frandeen November 9, 1981  1:04 PM: Move the IncrementDataPgNum bit back one word<br>;IOCB&rsquo;s used for disk booting. Heads have been moved to cylinder 0 by phase 0<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">@100</span><span class="tab" val="79"></span><span style="font: 10pt serif">;data area<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">B</span><span class="tab" val="79"></span><span style="font: 10pt serif">;special block type, ignore<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">FE</span><span class="tab" val="79"></span><span style="font: 10pt serif">;word count<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">0</span><span class="tab" val="79"></span><span style="font: 10pt serif">;not used<br>#02</span><span class="tab" val="79"></span><span style="font: 10pt serif">0000</span><span class="tab" val="79"></span><span style="font: 10pt serif">;final IOCB status word, set by DiskDlion ucode<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">0000</span><span class="tab" val="79"></span><span style="font: 10pt serif">;next IOCB (should always be 0)<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[01</span><span class="tab" val="79"></span><span style="font: 10pt serif">;address of seek IOCB<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[25</span><span class="tab" val="79"></span><span style="font: 10pt serif">;address of transfer IOCB<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[30</span><span class="tab" val="79"></span><span style="font: 10pt serif">;address of verify read read parameter area<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[20</span><span class="tab" val="79"></span><span style="font: 10pt serif">;address of verify verify read parameter area<br>#03</span><span class="tab" val="79"></span><span style="font: 10pt serif">0000</span><span class="tab" val="79"></span><span style="font: 10pt serif">;header</span><span class="tab" val="79"></span><span style="font: 10pt serif">cylinder[0..15]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">0000</span><span class="tab" val="79"></span><span style="font: 10pt serif">;      2</span><span class="tab" val="79"></span><span style="font: 10pt serif">head[0..7],, sector[0..7]<br>#04</span><span class="tab" val="79"></span><span style="font: 10pt serif">0000</span><span class="tab" val="285"></span><span style="font: 10pt serif">;label</span><span class="tab" val="361"></span><span style="font: 10pt serif">ID[ 0..15]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">0000</span><span class="tab" val="79"></span><span style="font: 10pt serif">;      2</span><span class="tab" val="361"></span><span style="font: 10pt serif">ID[16..31]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">0000</span><span class="tab" val="79"></span><span style="font: 10pt serif">;      3</span><span class="tab" val="361"></span><span style="font: 10pt serif">ID[32..47]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">0000</span><span class="tab" val="79"></span><span style="font: 10pt serif">;      4</span><span class="tab" val="361"></span><span style="font: 10pt serif">ID[48..63]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">0000</span><span class="tab" val="79"></span><span style="font: 10pt serif">;      5</span><span class="tab" val="361"></span><span style="font: 10pt serif">ID[64..89]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">0000</span><span class="tab" val="79"></span><span style="font: 10pt serif">;      6</span><span class="tab" val="79"></span><span style="font: 10pt serif">page[7..22]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">0000</span><span class="tab" val="79"></span><span style="font: 10pt serif">;      7</span><span class="tab" val="79"></span><span style="font: 10pt serif">page[0..6],, unused[0..5]&larr; 0 ,, flags[0..2]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">0000</span><span class="tab" val="79"></span><span style="font: 10pt serif">;      8 type[0..15]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">0000</span><span class="tab" val="79"></span><span style="font: 10pt serif">;      9 bootChainLink[0..15]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">0000</span><span class="tab" val="79"></span><span style="font: 10pt serif">;     10<br><br>;align on 16 word boundary<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">0 0 0<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">0 0 0 0<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">0 0 0 0<br><br>;verify verify read parameter area (must be 16 word aligned)<br>#20</span><span class="tab" val="79"></span><span style="font: 10pt serif">00</span><span class="tab" val="79"></span><span style="font: 10pt serif">;# sectors to write, set at run time<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">31</span><span class="tab" val="79"></span><span style="font: 10pt serif">;(number of sectors that may be skipped in<br></span><span class="tab" val="285"></span><span style="font: 10pt serif">;looking for the proper sector) + 1<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">0432</span><span class="tab" val="79"></span><span style="font: 10pt serif">;control word to verify header field<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">1</span><span class="tab" val="79"></span><span style="font: 10pt serif">;word count for verify of header field<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[03</span><span class="tab" val="79"></span><span style="font: 10pt serif">;address of header template in IOCB<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">1C</span><span class="tab" val="79"></span><span style="font: 10pt serif">;abort if NotReady, WriteFault or Overrun after header<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">3</span><span class="tab" val="79"></span><span style="font: 10pt serif">;skip to next sector if CRC or Verify error on header<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">0432</span><span class="tab" val="79"></span><span style="font: 10pt serif">;control word to verify label field<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">0B</span><span class="tab" val="79"></span><span style="font: 10pt serif">;word count for label field verify<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[04</span><span class="tab" val="79"></span><span style="font: 10pt serif">;address of label field in IOCB<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">1f</span><span class="tab" val="79"></span><span style="font: 10pt serif">;abort if NotReady, WriteFault, Overrun, CRC or<br></span><span class="tab" val="285"></span><span style="font: 10pt serif">;Verify error after label<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">0430</span><span class="tab" val="79"></span><span style="font: 10pt serif">;control word to Read data field<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">8100</span><span class="tab" val="79"></span><span style="font: 10pt serif">;word count for Read of data field (256)<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">3</span><span class="tab" val="79"></span><span style="font: 10pt serif">;virtual page # for data buffer<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">1e</span><span class="tab" val="79"></span><span style="font: 10pt serif">;abort if NotReady, WriteFault, Overrun or CRC<br></span><span class="tab" val="285"></span><span style="font: 10pt serif">;error after data<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">0420</span><span class="tab" val="79"></span><span style="font: 10pt serif">;control word used halt hardware after each field<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">0426</span><span class="tab" val="79"></span><span style="font: 10pt serif">;control word used to find sector mark for header<br><br>;align on 16 word boundary<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">0 0 0<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">0 0 0 0<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">0 0 0 0<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">0 0 0 0<br><br>;verify read read parameter area (must be 16 word aligned)<br>#30</span><span class="tab" val="79"></span><span style="font: 10pt serif">00</span><span class="tab" val="79"></span><span style="font: 10pt serif">;# sectors to write, set at run time<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">31</span><span class="tab" val="79"></span><span style="font: 10pt serif">;(number of sectors that may be skipped in<br></span><span class="tab" val="285"></span><span style="font: 10pt serif">;looking for the proper sector) + 1<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">0432</span><span class="tab" val="79"></span><span style="font: 10pt serif">;control word to verify header field<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">1</span><span class="tab" val="79"></span><span style="font: 10pt serif">;word count for verify of header field<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[03</span><span class="tab" val="79"></span><span style="font: 10pt serif">;address of header template in IOCB<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">1C</span><span class="tab" val="79"></span><span style="font: 10pt serif">;abort if NotReady, WriteFault or Overrun after header<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">3</span><span class="tab" val="79"></span><span style="font: 10pt serif">;skip to next sector if CRC or Verify error on header<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">0430</span><span class="tab" val="79"></span><span style="font: 10pt serif">;control word to Read label field<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">0C</span><span class="tab" val="79"></span><span style="font: 10pt serif">;word count for label field read<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[04</span><span class="tab" val="79"></span><span style="font: 10pt serif">;address of label field in IOCB<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">1e</span><span class="tab" val="79"></span><span style="font: 10pt serif">;abort if NotReady, WriteFault, Overrun or<br></span><span class="tab" val="285"></span><span style="font: 10pt serif">;CRC error after label<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">0430</span><span class="tab" val="79"></span><span style="font: 10pt serif">;control word to Read data field<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">8100</span><span class="tab" val="79"></span><span style="font: 10pt serif">;word count for Read of data field (256)<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">2</span><span class="tab" val="79"></span><span style="font: 10pt serif">;virtual page # for data buffer<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">1e</span><span class="tab" val="79"></span><span style="font: 10pt serif">;abort if NotReady, WriteFault, Overrun or CRC<br></span><span class="tab" val="285"></span><span style="font: 10pt serif">;error after data<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">0420</span><span class="tab" val="79"></span><span style="font: 10pt serif">;control word used halt hardware after each field<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">0426</span><span class="tab" val="79"></span><span style="font: 10pt serif">;control word used to find sector mark for header<br>;Seek IOCB<br>#01</span><span class="tab" val="79"></span><span style="font: 10pt serif">0000</span><span class="tab" val="79"></span><span style="font: 10pt serif">; -(number of cylinders to move) supplied at run time<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">8000 0422</span><span class="tab" val="79"></span><span style="font: 10pt serif">;insure that Seek Complete<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">7 0000</span><span class="tab" val="79"></span><span style="font: 10pt serif">;Set the IOCBDone bit in UField and clear the<br></span><span class="tab" val="285"></span><span style="font: 10pt serif">;UStatus register.  Otherwise, they will return spurious<br></span><span class="tab" val="285"></span><span style="font: 10pt serif">;status bits not valid for a Seek operation into the<br></span><span class="tab" val="285"></span><span style="font: 10pt serif">;final status word.<br>#06</span><span class="tab" val="79"></span><span style="font: 10pt serif">8000 0000 8000 0000</span><span class="tab" val="79"></span><span style="font: 10pt serif">;Send step pulse (two words supplied at run time)<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">0 [01</span><span class="tab" val="79"></span><span style="font: 10pt serif">;increment the remaining distance, Zero yet?<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">2 [06</span><span class="tab" val="79"></span><span style="font: 10pt serif">;no, send another step pulse<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">6 0 0 0400 [02</span><span class="tab" val="79"></span><span style="font: 10pt serif">;yes, quit now.<br><br>;transfer IOCB<br>#25</span><span class="tab" val="79"></span><span style="font: 10pt serif">5 0</span><span class="tab" val="79"></span><span style="font: 10pt serif">;load the parameters.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">8000 0422</span><span class="tab" val="79"></span><span style="font: 10pt serif">;wait for SeekComplete<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">800</span><span class="tab" val="79"></span><span style="font: 10pt serif">;yes, transfer run of pages<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">2 [26</span><span class="tab" val="79"></span><span style="font: 10pt serif">;if had error, finish anyway<br>#26</span><span class="tab" val="79"></span><span style="font: 10pt serif">6 0 0 0400 [02</span><span class="tab" val="79"></span><span style="font: 10pt serif">;finish up IOCB<br><br></span></div>
<script>function do_tabs() { // unit = px
  var tabs = document.getElementsByClassName("tab");
  for (var i = 0; i < tabs.length; ++i) {
    var span = tabs[i];
    var val = span.getAttribute("val");
    if (val == null) console.log("Couldn't get val");
    var rect = span.getBoundingClientRect();
    var tabstop;
    if (val > 0) tabstop = Math.ceil(rect.left / val) * val;
    else tabstop = -val;
    console.log("do_tabs", val, tabstop)
    if (tabstop > 0) {
      var width = tabstop - rect.left;
      span.style.display = "inline-block";
      span.style.width = width + "px";
    }
  }
}
do_tabs();
</script>
  </body>
</html>
