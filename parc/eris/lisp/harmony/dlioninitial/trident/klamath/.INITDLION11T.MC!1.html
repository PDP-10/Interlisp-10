<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
    <title>[eris]&lt;Lisp>Harmony>DlionInitial>Trident>Klamath>INITDLION11T.MC!1</title>
  </head>
  <body>
    <div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 8pt serif">{F</span><span style="font: italic 8pt serif">ile name:  InitDLion11T.mc<br>D</span><span style="font: 8pt serif">escription: Mesa Emulator initialization,<br><br>Lichtenberg  2-Aug-8</span><span style="font: italic 8pt serif">4 19:07:53 Initial</span><span style="font: 8pt serif">ization of MCtl changed <br>Lichtenberg   Changes for Lisp installed.  old definitions of UxC04 preserved for moonboot.<br><br>Last Edited by Amy Fasnacht: 13-Sep-83 16:03:33 Add support for 24-bit VA space<br>Last Edited by Daniels:  5-Aug-83 10:57:41 uPMask &larr; uPMask2 &larr; 1FF8 (was 0FFC)<br>Last Edited by Amy Fasnacht: September 22, 1982  5:12 PM Add uTMErRst initialization for MagTape<br>Last Edited by Amy Fasnacht: September 22, 1982  5:12 PM Delete uStartScan initialization<br>Last Edited by Amy Fasnacht: August 5, 1982  1:49 PM Change IOPage references<br>Last Edited by Amy Fasnacht: June 29, 1982  9:11 AM Add LSEP initializations<br>Last Edited by Amy Fasnacht: May 18, 1982  10:19 AM Change display registers<br>Last Edited by Amy Fasnacht: February 9, 1982  10:48 AM Replace Trident/Shugart conditional assembly initializations with branches based on CPBootDevice (accomodates etherbooting).<br>Last Edited by Jim Frandeen: February 2, 1982  1:22 PM Initialize uE3FF.<br>Last Edited by Amy Fasnacht: January 6, 1982  4:01 PM Bug fix - branch to DisplayInit after initializing SAx000 registers<br>Last Edited by Jim Frandeen: December 17, 1981  1:03 PM Use only two registers for initialization.<br>Last Edited by J. Furst: December 8, 1981  2:07 PM, Added new Trident reg. UF000<br>Sandman : November 17, 1981  1:24 PM New instruction set<br>Last Edited by Jim Frandeen: November 8, 1981  5:00 PM initialize new display registers for smooth scrolling<br>Last Edited by Neely: October 13, 1981  11:20 AM Trident Integration<br>Last Edited by Jim Frandeen: April 1, 1981  2:09 PM: initialize UtbFlags<br>Author: Sandman,<br>}<br><br>Reserve[0F6F]; Reserve[0F78]; Reserve[0F7F,0FFF];</span><span class="tab" val="79"></span><span style="font: 8pt serif">{Kernel}<br><br><br>SetTask[0];<br><br>{NOTE: we must use only two regisers (dY and dZ) for initialization so that register usage will not conflict with booting. For example, Protected.mc uses three registers to check for Ethernet timeout. We do Display initialization last since the Display microcode counts on two of its registers being initialized, and we use these two registers for all other initialization.}<br><br><br>IfEqual[Config, 3, SkipTo[SetEtherBoot],];<br>IfEqual[Config, 2, SkipTo[SetTrident],];<br><br>OnceOnlyInit:</span><span class="tab" val="79"></span><span style="font: 8pt serif">CPBootDevice &larr; 0,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">Noop,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br><br>SkipTo[SkipSetTrident];<br><br>SetTrident!<br><br>OnceOnlyInit:</span><span class="tab" val="79"></span><span style="font: 8pt serif">dY &larr; 0C,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">CPBootDevice &larr; dY,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br><br>SkipSetTrident!<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">Noop,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; LShift1 0FF, SE&larr;1, CANCELBR[$,0F],</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br><br>SkipTo[StartInit];<br><br>SetEtherBoot!<br><br>OnceOnlyInit:</span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; LShift1 0FF, SE&larr;1, CANCELBR[$,0F],</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br><br>StartInit!<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; LShift1 dZ, SE&larr;1,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">u3FF &larr; dZ, dZ &larr; dZ LShift1, SE&larr;1,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">MCtl &larr; dZ + 1,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">u7FF &larr; dZ, dZ &larr; dZ LShift1, SE&larr;1,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; dZ LShift1, SE&larr;1,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">u1FFF &larr; dZ, dZ &larr; dZ LShift1, SE&larr;1,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">u3FFF &larr; dZ,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; 64,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; dZ LRot8, Refresh,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">UtbFlags &larr; dZ,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; LShift1 0F, SE&larr;1,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; dZ LRot8, ClrIntErr,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; dZ or 0F8,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">uPMask &larr; dZ,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">uPMask2 &larr; dZ, Refresh,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; 0E,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; dZ LRot12,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">uPPMask &larr; dZ, Refresh,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; RShift1 0, SE &larr; 1,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">u8000 &larr; dZ,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif"><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">MCtl &larr; dZ or 2, c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">, c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">, c3;<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dY &larr; 0, Refresh,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br> </span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; IOPage,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; dZ LRot8, </span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">rhdZ &larr; IOPageHigh,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br> </span><span class="tab" val="79"></span><span style="font: 8pt serif">uIOPage &larr; dZ,</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">Noop,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br><br>{clear I/O page, TOS = 0}<br>IOPageLoop:<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">MAR &larr; [rhdZ, dZ+0],</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">MDR &larr; dY{=0}, dZ &larr; dZ + 1, PgCrOvDisp,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">uPCCross &larr; 0, BRANCH[IOPageLoop,$,1],</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br><br>{=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=}<br>{&gt;&gt; </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 8pt serif">NEW FOR LISP - NEW FOR LISP</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 8pt serif">&lt;&lt;}<br></span><span class="tab" val="79"></span><span style="font: 8pt serif"><br>{clear MESA (2nd) I/O page, TOS = 0}<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">rhdZ &larr; 1{2}{IOPageHigh},</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br> </span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; 40{0},</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">{uIOPage &larr; 0{dZ},}dZ &larr; dZ LRot8, {Noop,}</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br><br>IOPageLoop2:<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">MAR &larr; [rhdZ, dZ+0],</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">MDR &larr; dY{=0}, dZ &larr; dZ + 1, PgCrOvDisp,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">uPCCross &larr; 0, BRANCH[IOPageLoop2,$,1],</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br><br>{&gt;&gt;      END OF NEW FOR LISP - END OF NEW FOR LISP</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 8pt serif">&lt;&lt;}<br>{=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=}<br><br>EtherInit:<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">Refresh,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; 55,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; dZ LRot8 or dZ,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">uEPreamble &larr; dZ, Refresh,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; dZ or 0C0,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">uELastPreamble &larr; dZ,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; LShift1 0FF, SE &larr; 1 {1FF},</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; LShift1 dZ, SE &larr; 1 {3FF},</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">uE3FF &larr; dZ,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br><br>MagTapeInit:<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">rTWc &larr; CTClrMEr,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">rTWc &larr; rTWc LRot8,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">uTMErRst &larr; rTWc,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif"><br>DiskInit:<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">Xbus &larr; CPBootDevice, XDisp,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">BRANCH[SAx000Init, TridentInit, 7],</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br><br>SAx000 Init:<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">Noop,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br><br>{initialize 16 bit const used to clear mem errorflags}<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; CClearMemError,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; dZ LRot8,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">U0C00 &larr; dZ,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">{form top byte of status mask, bottom byte depends on drive connected}<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dY &larr; CHeadMsk,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dY &larr; dY LRot8,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">Xbus &larr; KStatus, XwdDisp,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; CSA1MaxSectTst, BRANCH[SetSA1Const, SetSA4Const,2],</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br><br>SetSA4Const:<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">{sector test number}<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; CSA4MaxSectTst, </span><span class="tab" val="79"></span><span style="font: 8pt serif">c2, at[3,4,SetSA1Const];<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">UMaxSectTst &larr; dZ,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">{synchronization word and error mask}<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; dZ xor ~dZ,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dY &larr; dY or CSA4ErrMsk, GOTO[SetURegs],</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br><br>SetSA1Const:<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">UMaxSectTst &larr; dZ,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2, at[2,4,SetSA4Const];<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; CAddrMkHi,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">{address mark and error mask}<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; dZ LRot8,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dY &larr; dY or CSA1ErrMsk,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br>SetURegs:</span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; dZ or CAddrMkLo,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">{save sync word or address mark; set status mask}<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">USyncAdrMk &larr; dZ, Refresh,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">UStatusMsk &larr; dY,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">GOTO[DisplayInit],</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br><br>TridentInit:<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">Noop,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br><br>{Initialization of U0C00 -- A 16 bit constant used to clear memory error flags}<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; 0C</span><span class="tab" val="79"></span><span style="font: 8pt serif">,c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; dZ LRot8</span><span class="tab" val="79"></span><span style="font: 8pt serif">,c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">U0C00 &larr; dZ</span><span class="tab" val="79"></span><span style="font: 8pt serif">,c3;<br><br><br><br>{Initialization of U0C04 -- A 16 bit constant used to reset Control Tag in the Command register}<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; dZ or 4</span><span class="tab" val="79"></span><span style="font: 8pt serif">,c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">U0C04 &larr; dZ</span><span class="tab" val="79"></span><span style="font: 8pt serif">,c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">oldU0C04 &larr; dZ   ,c3;     {** New to keep moonboot happy **}<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; 2C</span><span class="tab" val="79"></span><span style="font: 8pt serif">,c1;<br><br><br>{Initialization of U2C04 -- A 16 bit constant used to set the Head Tag in the Command register}<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; dZ LRot8</span><span class="tab" val="79"></span><span style="font: 8pt serif">,c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; dZ or 4</span><span class="tab" val="79"></span><span style="font: 8pt serif">,c3;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">oldU2C04 &larr; dZ   ,c1;   {** New to keep moonboot happy **}<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">Noop, c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">U2C04 &larr; dZ</span><span class="tab" val="79"></span><span style="font: 8pt serif">,c3;<br><br><br><br>{Initialize U2C05 register and prepare initializing UCStatMask.}<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; dZ or 1</span><span class="tab" val="79"></span><span style="font: 8pt serif">,c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">U2C05 &larr; dZ</span><span class="tab" val="79"></span><span style="font: 8pt serif">,c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; 4E</span><span class="tab" val="79"></span><span style="font: 8pt serif">,c3;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif"><br>{=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=}<br>{&gt;&gt; </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 8pt serif">NEW FOR LISP - NEW FOR LISP</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 8pt serif">&lt;&lt;}<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif"><br>{Initialize U8C02}<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; 8C, c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; dZ LRot8, c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; dZ or 2, c3;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">U8C02 &larr; dZ, c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">, c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; 4E, c3;<br><br><br>{&gt;&gt;      END OF NEW FOR LISP - END OF NEW FOR LISP</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 8pt serif">&lt;&lt;}<br>{=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=}<br><br><br>{Initialize UCStatMask with 4E06.}<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; dZ LRot8</span><span class="tab" val="79"></span><span style="font: 8pt serif">,c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; dZ or 6</span><span class="tab" val="79"></span><span style="font: 8pt serif">,c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">UCStatMask &larr; dZ</span><span class="tab" val="79"></span><span style="font: 8pt serif">,c3;<br><br><br>{Initialization of UF001 -- A 16 bit constant used to turn on "Sequence" for all four drives in the Control register}<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; 0F0</span><span class="tab" val="79"></span><span style="font: 8pt serif">,c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; dZ LRot8</span><span class="tab" val="79"></span><span style="font: 8pt serif">,c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">UF000 &larr; dZ</span><span class="tab" val="79"></span><span style="font: 8pt serif">,c3;<br><br><br>{Initialization of UF001 -- A 16 bit constant used to turn on "Sequence" for all four drives in the Control register}<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; 1F</span><span class="tab" val="79"></span><span style="font: 8pt serif">,c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; dZ LRot12</span><span class="tab" val="79"></span><span style="font: 8pt serif">,c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">UF001 &larr; dZ</span><span class="tab" val="79"></span><span style="font: 8pt serif">,c3;<br><br><br>{Initialize U0400 register}<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; 4</span><span class="tab" val="79"></span><span style="font: 8pt serif">,c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; dZ LRot8</span><span class="tab" val="79"></span><span style="font: 8pt serif">,c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">U0400 &larr; dZ</span><span class="tab" val="79"></span><span style="font: 8pt serif">,c3;<br><br><br><br>{Initialization of U4000 and KCmd register (TestCtl = 1) and USIP with 0.}<br><br>KRegInit:</span><span class="tab" val="79"></span><span style="font: 8pt serif">KCmd &larr; dZ &larr; dZ LRot4</span><span class="tab" val="79"></span><span style="font: 8pt serif">,c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">U4000 &larr; dZ</span><span class="tab" val="79"></span><span style="font: 8pt serif">,c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">USIP &larr; 0</span><span class="tab" val="79"></span><span style="font: 8pt serif">,c3;<br><br><br>{Initialize KCtl with 0F000 .}<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; 0F</span><span class="tab" val="79"></span><span style="font: 8pt serif">,c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">KCtl &larr; dZ  LRot12</span><span class="tab" val="79"></span><span style="font: 8pt serif">,c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; 0FF + 1</span><span class="tab" val="79"></span><span style="font: 8pt serif">,c3;<br><br><br>{Initialize  U0100.}<br><br>EndInit:</span><span class="tab" val="79"></span><span style="font: 8pt serif">U0100 &larr; dZ, Refresh</span><span class="tab" val="79"></span><span style="font: 8pt serif">,c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">Noop</span><span class="tab" val="79"></span><span style="font: 8pt serif">,c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">Noop, </span><span class="tab" val="79"></span><span style="font: 8pt serif">,c3;<br><br>DisplayInit:<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">rhdY &larr; IOPageHigh, Refresh,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; uIOPage,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">Noop,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">Noop,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; dZ + IOPage.DCSB.cursorMap,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">uInitCurMapAddr &larr; dZ,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; 88,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; dZ LRot8,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; dZ or 22 {8822},</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">uInitBorder &larr; dZ, Refresh,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; PicLenShifted,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dY &larr; dZ LRot8,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">uInitCurBufAddr &larr; dY,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; LRot1 dZ,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; LRot1 dZ, rhdZ &larr; 0,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">uInitPicLength &larr; dZ {328&rsquo;x}, Refresh,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">uClockBits &larr; 0,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">Noop,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">ClrDPRq,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dZ &larr; uPatchCount &larr; 0,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dY &larr; 7,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">uCopyCount &larr; dY, Refresh,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">uPatchLine &larr; dZ xor ~dZ,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dY &larr; 3F,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dY &larr; dY LRot4,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">u3F0 &larr; dY,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dY &larr; 0FC,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dY &larr; dY LRot8,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">uNormalFifo &larr; dY,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br>LsepInit:</span><span class="tab" val="79"></span><span style="font: 8pt serif">dY &larr; 10,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">uDisableLSEP &larr; dY,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dY &larr; 15,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">uEndBandScan &larr; dY,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br><br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dY &larr; 1B,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c1;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">uStartActive &larr; dY,</span><span class="tab" val="79"></span><span style="font: 8pt serif">c2;<br></span><span class="tab" val="79"></span><span style="font: 8pt serif">dY &larr; 1, GOTO[DoneOnceOnlyInit]</span><span class="tab" val="79"></span><span style="font: 8pt serif">c3;<br><br></span></div>
<script>function do_tabs() { // unit = px
  var tabs = document.getElementsByClassName("tab");
  for (var i = 0; i < tabs.length; ++i) {
    var span = tabs[i];
    var val = span.getAttribute("val");
    if (val == null) console.log("Couldn't get val");
    var rect = span.getBoundingClientRect();
    var tabstop;
    if (val > 0) tabstop = Math.ceil(rect.left / val) * val;
    else tabstop = -val;
    console.log("do_tabs", val, tabstop)
    if (tabstop > 0) {
      var width = tabstop - rect.left;
      span.style.display = "inline-block";
      span.style.width = width + "px";
    }
  }
}
do_tabs();
</script>
  </body>
</html>
