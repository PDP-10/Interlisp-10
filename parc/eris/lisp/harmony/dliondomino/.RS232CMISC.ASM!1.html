<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
    <title>[eris]&lt;Lisp>Harmony>DLionDomino>RS232CMISC.ASM!1</title>
  </head>
  <body>
    <div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">{ File: RS232CMisc.asm<br>Modification History:<br>Last change by Chuck Fay :  9-Jan-83 19:04:04: Fix send break command.<br>Last change by Jim Frandeen : September 8, 1982  4:56 PM: Change handling of abort.<br>Last change by Jim Frandeen : August 5, 1982  10:36 AM: new IO Page format<br>Created by Jim Frandeen : March 25, 1982  1:53 PM<br>}<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">Get "SysDefs"</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">Get "CommonDefs"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">Get "RS232CDefs"<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">AsyncRS232CInterrupt</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From Rs232CInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">AbortGetFlag</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From RS232CGet<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">AbortPutFlag</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From RS232CPut<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">AsyncGetLoop</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From RS232CGet<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">AsynchronousDivisor</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From SIOSubs<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">BEL1</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">BEL6</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInput<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">BisyncGetLoop</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From RS232CGet<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">BisyncRS232CInterrupt</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From Rs232CInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">BisyncTimerTable</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From SIOSubs<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">Copy</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From CPSubs<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">DisableRST</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From Common<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">DisableRxCRC1</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInput<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">DisableRxCRC2</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInput<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">DisableRxCRC3</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInput<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">DisableTxCRC1</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">DisableTxCRC2</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">DisableTxCRC3</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">DisableTxCRC4</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">DisableTxCRC5</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">DisableTxCRC6</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">DisableTxCRC7</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">EnableRST</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From Common<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">EnableRxCRC1</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInput<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">EnableRxCRC2</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInput<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">EnableRxCRC3</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInput<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">EnableRxCRC4</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInput<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">EnableTxCRC1</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">EnableTxCRC2</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">EnableTxCRC3</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">EnableTxCRC4</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">EnableTxCRC5</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">EndOfBisyncFrame</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInput<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">ENQ1</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">ENQ2</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">ENQ4</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">ENQ6</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInput<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">ENQ9</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInput<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">ENQ10</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInput<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">ENQ11</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInput<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">ENQ12</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">EnterHuntMode1</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInput<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">EnterHuntMode2</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInput<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">EOT1</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">EOT6</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInput<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">EOTEndFrameSwitch</span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInput<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">EOT3270</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInput<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">ETB2</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">ETB4</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">ETB5</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">ETB6</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">ETB7</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInput<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">ETB8</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInput<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">ETB9</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInput<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">ETB10</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInput<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">ETB11</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInput<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">ETB12</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">GetModeSwitch</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From RS232CGet<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">GetTaskResumeAddress</span><span class="tab" val="79"></span><span style="font: 10pt serif">;From RS232CGet<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">GetTaskQuiet</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From RS232CGet<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">HLPlus2A</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From SIOSubs<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">NAK1</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">NAK6</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInput<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">OneSecondTimerLow</span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">OneSecondTimerHigh</span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">PortBusyFlag</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From CPSubs<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">PrevAsyncDCD</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From RS232CInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">PrevCTS</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From RS232CInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">PrevBisyncDCD</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From RS232CInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">PrevSdlcDCD</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">PutAsyncMode</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From RS232CPut<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">PutBisyncMode</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From RS232CPut<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">PutSdlcMode</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From RS232CPut<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">PutModeSwitch</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From RS232CPut<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">PutTaskResumeAddress</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From RS232CPut<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">PutTaskQuiet</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From RS232CPut<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">ReadCPBuffer</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From CPSubs<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">ResetChannels</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From SIOSubs<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CGetFlag</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BookKeepingTask<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CInterruptSwitch</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From Common<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CPutFlag</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BookKeepingTask<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CMiscFlag</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BookKeepingTask<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CMiscCommand</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BookKeepingTask<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">SdlcGetLoop</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From RS232CGet<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">SdlcRS232CInterrupt</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From Rs232CInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">SetAsyncTimer</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From RS232CSubs<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">SetBaudRate</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From SIOSubs<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">SetRS366</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From SIOSubs<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">StartGetTask</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From RS232CGet<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">StartPutTask</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From RS232CPut<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">SYN1</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">SYN2</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">SYN3</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">SYN4</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">SYN5</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">SYN6</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">SYN7</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInput<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">SYN8</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInput<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">SYN9</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInput<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">SYN10</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInput<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">SYN11</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInput<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">SYN12</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From BisyncInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">SynchronousDivisor</span><span class="tab" val="79"></span><span style="font: 10pt serif">;From SIOSubs<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">WriteCPBuffer</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From CPSubs<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">ZeroCommand</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;From Common<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">EXP</span><span class="tab" val="79"></span><span style="font: 10pt serif">CurrentCharLengthMask</span><span class="tab" val="79"></span><span style="font: 10pt serif">;Parameter<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">EXP</span><span class="tab" val="79"></span><span style="font: 10pt serif">CurrentRS366Status</span><span class="tab" val="79"></span><span style="font: 10pt serif">;Parameter<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">EXP</span><span class="tab" val="79"></span><span style="font: 10pt serif">CurrentSyncCharacter</span><span class="tab" val="79"></span><span style="font: 10pt serif">;Parameter<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">EXP</span><span class="tab" val="79"></span><span style="font: 10pt serif">CurrentSyncCount</span><span class="tab" val="79"></span><span style="font: 10pt serif">;Parameter<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">EXP</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CMode</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;Parameter<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">EXP</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CTaskWakeMask<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">EXP</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxWR1</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;Parameter<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">EXP</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxWR3</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;Parameter<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">EXP</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxWR4</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;Parameter<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">EXP</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxWR1</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;Parameter<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">EXP</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxWR4</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;Parameter<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">EXP</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxWR5</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;Parameter<br>;<br>RS232CMiscTask:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">PortBusyFlag<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ORA</span><span class="tab" val="79"></span><span style="font: 10pt serif">A<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JNZ</span><span class="tab" val="79"></span><span style="font: 10pt serif">MiscYield<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">opJMP<br>MiscTaskResumeAddress:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DW</span><span class="tab" val="79"></span><span style="font: 10pt serif">CheckMiscFlag<br>;</span><span class="tab" val="79"></span><span style="font: 10pt serif">JMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">WaitForGetAbort<br>;</span><span class="tab" val="79"></span><span style="font: 10pt serif">JMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">WaitForPutAbort<br><br>CheckMiscFlag:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CMiscFlag<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ORA</span><span class="tab" val="79"></span><span style="font: 10pt serif">A<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JP</span><span class="tab" val="79"></span><span style="font: 10pt serif">MiscYield</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,ReadMiscCSB<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CALL</span><span class="tab" val="79"></span><span style="font: 10pt serif">ReadCPBuffer<br><br>{The Misc Task implements the following commands. The command numbers are defined in IOPInterfaceDefs.mesa.}<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CMiscCommand</span><span class="tab" val="79"></span><span style="font: 10pt serif"> <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ORA</span><span class="tab" val="79"></span><span style="font: 10pt serif">A<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JZ</span><span class="tab" val="79"></span><span style="font: 10pt serif">DoOn</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;Zero is On command<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CPI</span><span class="tab" val="79"></span><span style="font: 10pt serif">1<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JZ</span><span class="tab" val="79"></span><span style="font: 10pt serif">DoOff<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CPI</span><span class="tab" val="79"></span><span style="font: 10pt serif">2<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JZ</span><span class="tab" val="79"></span><span style="font: 10pt serif">DoBreakOn<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CPI</span><span class="tab" val="79"></span><span style="font: 10pt serif">3<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JZ</span><span class="tab" val="79"></span><span style="font: 10pt serif">DoBreakOff<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CPI</span><span class="tab" val="79"></span><span style="font: 10pt serif">4<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JZ</span><span class="tab" val="79"></span><span style="font: 10pt serif">DoAbortInput<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CPI</span><span class="tab" val="79"></span><span style="font: 10pt serif">5<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JZ</span><span class="tab" val="79"></span><span style="font: 10pt serif">DoAbortOutput<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CPI</span><span class="tab" val="79"></span><span style="font: 10pt serif">6<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JZ</span><span class="tab" val="79"></span><span style="font: 10pt serif">DoSetRS366Status<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CPI</span><span class="tab" val="79"></span><span style="font: 10pt serif">7<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JZ</span><span class="tab" val="79"></span><span style="font: 10pt serif">DoGetStatus<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CPI</span><span class="tab" val="79"></span><span style="font: 10pt serif">8<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JZ</span><span class="tab" val="79"></span><span style="font: 10pt serif">DoMajorSetParameters<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CPI</span><span class="tab" val="79"></span><span style="font: 10pt serif">14<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JZ</span><span class="tab" val="79"></span><span style="font: 10pt serif">DoMinorSetParameters<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">BREAK<br><br>{Continue if IOP Command is invalid.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">ResetMiscTaskFlag<br>;<br>RS232CMiscCSB:<br>RS232CParameter4:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DS</span><span class="tab" val="79"></span><span style="font: 10pt serif">2</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;1402C<br>RS232CParameter3:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DS</span><span class="tab" val="79"></span><span style="font: 10pt serif">1</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;1402D low<br>RS232CParameter3Hi:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DS</span><span class="tab" val="79"></span><span style="font: 10pt serif">1</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;1402D  high<br>RS232CParameter2:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DS</span><span class="tab" val="79"></span><span style="font: 10pt serif">1</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;1402E<br>RS232CParameter2Hi:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DS</span><span class="tab" val="79"></span><span style="font: 10pt serif">1</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;1402E high<br>RS232CParameter1:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DS</span><span class="tab" val="79"></span><span style="font: 10pt serif">1</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;1402F low<br>RS232CParameter1Hi:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DS</span><span class="tab" val="79"></span><span style="font: 10pt serif">1</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;1402F high<br>RS232CTaskWakeMask:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DS</span><span class="tab" val="79"></span><span style="font: 10pt serif">2</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;14030<br><br>RS232CParameter:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DS</span><span class="tab" val="79"></span><span style="font: 10pt serif">1</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;14036 low<br>RS232CParameterHi:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DS</span><span class="tab" val="79"></span><span style="font: 10pt serif">1</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;14036 high<br><br><br>RS232CDeviceStatus:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DS</span><span class="tab" val="79"></span><span style="font: 10pt serif">1</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;14035 low<br>RS232CDeviceStatusHi:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DS</span><span class="tab" val="79"></span><span style="font: 10pt serif">1</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;14035 high<br><br><br>CurrentParameters:<br>; Channel A is the Rx Channel on the Z80 SIO chip<br>RxWR1: DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br>RxWR3: DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br>RxWR4: DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br>RxWR5: DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br><br>; Channel B is the Rx Channel on the Z80 SIO chip<br>TxWR1: DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br>TxWR4: DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br>TxWR5: DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br><br>CurrentCode:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;0 = Ascii, 1 = Ebcdic<br><br>{The following characters will be replaced by the Ebcdic or Ascii values, depending on the code used.}<br>BEL:</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br>ENQ:</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br>EOT:</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br>ETB:</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br>NAK:</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br>SYN:</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br>CurrentRS366Status:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">; RS366 Test Status Storage (LocalTim+SIOLpEn)<br>CurrentParametersSize EQU CurrentRS366Status-RxWR1+1<br><br><br>SdlcDefaultParameters:<br>{</span><span class="tab" val="79"></span><span style="font: 10pt serif">Default Values for Sdlc mode. These will be moved into CurrentParameters above.}<br><br>{RxWR1:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">IntOnAllRxCharacters+ExternalIntEnable</span><span class="tab" val="79"></span><span style="font: 10pt serif"><br>{RxWR3:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxCRCEnable</span><span class="tab" val="79"></span><span style="font: 10pt serif"><br>{RxWR4:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">X1ClockMode+SdlcMode<br>{RxWR5:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br><br>{TxWR1:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">StatusAffectsVector+ExternalIntEnable+TxIntEnable<br>{TxWR4:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">X1ClockMode+SdlcMode<br>{TxWR5:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxCRCEnable+TxEnable</span><span class="tab" val="79"></span><span style="font: 10pt serif"><br><br>{Code:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br>{BEL:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br>{ENQ:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br>{EOT:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br>{ETB:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br>{NAK:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br>{SYN:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br>{Rs366Status:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0</span><span class="tab" val="79"></span><span style="font: 10pt serif"><br><br><br>AsyncDefaultParameters:<br>{</span><span class="tab" val="79"></span><span style="font: 10pt serif">Default Values for Async mode. These will be moved into CurrentParameters above.}<br><br>{RxWR1:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">IntOnAllRxCharacters+ExternalIntEnable<br>{RxWR3:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br>{RxWR4:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">X16ClockMode<br>{RxWR5:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br><br>{TxWR1:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">StatusAffectsVector+ExternalIntEnable+TxIntEnable<br>{TxWR4:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">X16ClockMode<br>{TxWR5:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxEnable<br><br>{Code:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br>{BEL:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br>{ENQ:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br>{EOT:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br>{ETB:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br>{NAK:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br>{SYN:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br>{RS366Status:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">LocalTim<br><br><br>BisyncDefaultParameters:<br>{Default values for Bisync mode. These will be moved into CurrentParameters above.}<br><br>{RxWR1:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">IntOnAllRxCharacters+ExternalIntEnable<br>{RxWR3:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br>{RxWR4:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">X1ClockMode+SyncCharacter16Bits<br>{RxWR5:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">BisyncCRC<br><br>{TxWR1:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">StatusAffectsVector+ExternalIntEnable+TxIntEnable<br>{TxWR4:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">X1ClockMode+SyncCharacter16Bits<br>{TxWR5:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxEnable+BisyncCRC</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br><br>{Code:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">Ebicdic<br>{BEL:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">EbcdicBELL<br>{ENQ:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">EbcdicENQ<br>{EOT:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">EbcdicEOT<br>{ETB:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">EbcdicETB<br>{NAK:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">EbcdicNAK<br>{SYN:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">EbcdicSYN<br>{RS366Status:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br>;<br>{ Other Parameters}<br><br>RS232CMode:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">; current mode (0=Sdlc, 1=Bisync, 2=Async)<br><br>CurrentCorrespondents:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">  {0 = xerox800<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">  1 = xerox850<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">  2 = system6<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">  3 = cmcII<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">  4 = ttyHost<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">  5 = oisSystemElement<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">  6 = ibm3270Host<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">  7 = ibm2770Host<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">  8 = ibm6670Host<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">  9 = ibm6670<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">  10 = xerox860<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">  11 = oisSystemElementBSC} <br><br>CurrentSyncCount:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;Set from RS232CParameter2<br>CurrentSyncCharacter:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;Set from RS232CParameter3</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"> <br>CurrentBaudRate:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;Set from RS232CParameter1<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">{0 = 50 Baud<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">1 = 75 Baud<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">2 = 110 Baud<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">3 = 134.5 Baud<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">4 = 150 Baud<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">5 = 300 Baud<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">6 = 600 Baud<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">7 = 1200 Baud<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">8 = 2400 Baud<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">9 = 3600 Baud<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">10 = 4800 Baud<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">11 = 7200 Baud<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">12 = 9600 Baud<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">13 = 19200 Baud<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">14 = 48000 Baud<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">15 = 56000 Baud}<br><br>{CurrentCharLengthMask will be replaced by one of the entries from the table below.}<br>CurrentCharLengthMask:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0FFH</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">; character length mask<br><br>CurrentCharLengthMaskTable:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">01FH</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">; 5 bits<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">03FH</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">; 6 bits<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">07FH</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">; 7 bits<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0FFH</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">; 8 bits<br><br>{This character length table is set up for WR3.}<br>CharLengthTable:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">; 0=Character Length 5 of SIO Command<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">80H</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">; 80H=Character Length 6 of SIO Command<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">40H</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">; 40H=Character Length 7 of SIO Command<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0C0H</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">; 0C0H=Character Length 8 of SIO Command<br><br>AsciiCodeTable:<br>{Code:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">Ascii<br>{BEL:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">AsciiBELL<br>{ENQ:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">AsciiENQ<br>{EOT:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">AsciiEOT<br>{ETB:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">AsciiETB<br>{NAK:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">AsciiNAK<br>{SYN:}</span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">AsciiSYN<br>AsciiCodeTableSize  EQU 7<br><br>ReadMiscCSB:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DW</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CMiscCSBLoc</span><span class="tab" val="79"></span><span style="font: 10pt serif">; CP Buffer Pointer Low<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DW</span><span class="tab" val="79"></span><span style="font: 10pt serif">CPIOPageHi</span><span class="tab" val="79"></span><span style="font: 10pt serif">; CP Buffer Pointer Hi<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DW</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CMiscCSBSize</span><span class="tab" val="79"></span><span style="font: 10pt serif">; CP Buffer Count in bytes<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DW</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CMiscCSB</span><span class="tab" val="79"></span><span style="font: 10pt serif">; Pointer to IOP Buffer<br><br>ZeroMiscFlag:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DW</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CMiscFlagLoc</span><span class="tab" val="79"></span><span style="font: 10pt serif">; CP Buffer Pointer Low<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DW</span><span class="tab" val="79"></span><span style="font: 10pt serif">CPIOPageHi</span><span class="tab" val="79"></span><span style="font: 10pt serif">; CP Buffer Pointer Hi<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DW</span><span class="tab" val="79"></span><span style="font: 10pt serif">2</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">; CP Buffer Count in bytes<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DW</span><span class="tab" val="79"></span><span style="font: 10pt serif">ZeroCommand</span><span class="tab" val="79"></span><span style="font: 10pt serif">; Pointer to IOP Buffer<br><br>SendDeviceStatus:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">; to transfer RS232C Device Status to CP IOPage<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DW</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CDeviceStatusLoc</span><span class="tab" val="79"></span><span style="font: 10pt serif">; CP Buffer Pointer Low<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DW</span><span class="tab" val="79"></span><span style="font: 10pt serif">CPIOPageHi</span><span class="tab" val="79"></span><span style="font: 10pt serif">; CP Buffer Pointer Hi<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DW</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CDeviceStatusSize</span><span class="tab" val="79"></span><span style="font: 10pt serif">; CP Buffer Count in bytes<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DW</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CDeviceStatus</span><span class="tab" val="79"></span><span style="font: 10pt serif">; Pointer to IOP Buffer<br><br>SendParameter:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">; to transfer RS232C Parameter Outcome to IOPage<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DW</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CParameterLoc</span><span class="tab" val="79"></span><span style="font: 10pt serif">; CP Buffer Pointer Low<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DW</span><span class="tab" val="79"></span><span style="font: 10pt serif">CPIOPageHi</span><span class="tab" val="79"></span><span style="font: 10pt serif">; CP Buffer Pointer Hi<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DW</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CParameterSize</span><span class="tab" val="79"></span><span style="font: 10pt serif">; CP Buffer Count in bytes<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DW</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CParameter</span><span class="tab" val="79"></span><span style="font: 10pt serif">; Pointer to IOP Buffer<br>;<br>{ Local subroutines}<br><br>CopyParameters:<br>{Copy default parameters into CurrentParameters. On entry, DE points to default parameters, and HL points to the address to be used for RS232C interrupts. Set up the interrupt table address first.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">SHLD</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CInterruptSwitch<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">XCHG</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;HL &larr; address of parameters<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">D,CurrentParameters<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">A,CurrentParametersSize</span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">Copy</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;Copy and RET<br><br>CheckResetRingHeard:<br>{If ResetRingHeard bit is set, reset the RingHeardLatch.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CParameter2Hi</span><span class="tab" val="79"></span><span style="font: 10pt serif">; Reset Ring Hard, if required<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ANI</span><span class="tab" val="79"></span><span style="font: 10pt serif">CPRRHMask<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">RZ</span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">XRA</span><span class="tab" val="79"></span><span style="font: 10pt serif">A<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RingHeardLatch<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">RET<br><br>UpdateTxWR5:<br>{This procedure is called whenever WR5 changes. We update the value of WR5 with and without CRCEnable for the Bisync interrupt routine.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxWR5</span><span class="tab" val="79"></span><span style="font: 10pt serif">;Update WR5<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">DisableTxCRC1<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">DisableTxCRC2<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">DisableTxCRC3<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">DisableTxCRC4<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">DisableTxCRC5<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">DisableTxCRC6<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">DisableTxCRC7<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ORI</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxCRCEnable<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">EnableTxCRC1<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">EnableTxCRC2<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">EnableTxCRC3<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">EnableTxCRC4<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">EnableTxCRC5<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">RET<br>;<br>DoOn:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">A,Rst65DisableMsk<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CALL</span><span class="tab" val="79"></span><span style="font: 10pt serif">EnableRST</span><span class="tab" val="79"></span><span style="font: 10pt serif"><br><br>{Initialize state of Clear To Send and Data Carrier Detect so we will know if they change.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">XRA</span><span class="tab" val="79"></span><span style="font: 10pt serif">A<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">PrevAsyncDCD<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">PrevCTS<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">PrevBisyncDCD<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">PrevSdlcDCD<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">ResetMiscTaskFlag<br><br><br>DoAbortInput:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">AbortGetFlag<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,WaitForGetAbort<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">SaveMiscResumeAddressAndYield<br><br>WaitForGetAbort:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">AbortGetFlag</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">; the last thing it does is reset the abort flag<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ORA</span><span class="tab" val="79"></span><span style="font: 10pt serif">A<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JNZ</span><span class="tab" val="79"></span><span style="font: 10pt serif">MiscYield</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">; if not stopped, keep waiting<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">RestoreMiscResumeAddress</span><span class="tab" val="79"></span><span style="font: 10pt serif">; if so, quit now.<br><br><br>{Break key handling -- a break is defined to be holding the serial data transmit line low for 190 milliseconds or more.  To send a break, you have to tell the SIO chip to hold the transmit line low, wait for 190 milliseconds or more, and then tell the SIO chip to stop holding the line low.  The SIO chip will hold the transmit line low if you turn on the "Send Break" bit in write register 5.  It stops holding it low when you turn off the bit.  The waiting is done in the Dandelion RS232C head.}<br><br>DoBreakOff:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,TxCont+8000H</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;HL points to TxCont register<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxWR5<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DI<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">M,PointToWR5</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;Send address of WR5</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MOV</span><span class="tab" val="79"></span><span style="font: 10pt serif">M,A</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;Send turn break off command<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">EI<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">ResetMiscTaskFlag<br><br>DoBreakOn:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,TxCont+8000H</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;HL points to TxCont register<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxWR5<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ORI</span><span class="tab" val="79"></span><span style="font: 10pt serif">SendBreak<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DI<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">M,PointToWR5</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;Send address of WR5</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MOV</span><span class="tab" val="79"></span><span style="font: 10pt serif">M,A</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;Send turn break on command<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">EI<br>{Now abort any puts in progress -- fall through to DoAbortOutput}<br><br><br>DoAbortOutput:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">AbortPutFlag<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,WaitForPutAbort<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">SaveMiscResumeAddressAndYield<br><br>WaitForPutAbort:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">AbortPutFlag<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ORA</span><span class="tab" val="79"></span><span style="font: 10pt serif">A</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">; the last thing it does is reset the abort flag<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JNZ</span><span class="tab" val="79"></span><span style="font: 10pt serif">MiscYield</span><span class="tab" val="79"></span><span style="font: 10pt serif">; if not stopped, keep waiting<br>RestoreMiscResumeAddress:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,CheckMiscFlag<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">SHLD</span><span class="tab" val="79"></span><span style="font: 10pt serif">MiscTaskResumeAddress<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">ResetMiscTaskFlag</span><span class="tab" val="79"></span><span style="font: 10pt serif">; if so, quit now.<br><br><br>DoOff:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">A,Rst65DisableMsk<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CALL</span><span class="tab" val="79"></span><span style="font: 10pt serif">DisableRST</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">; Disable Rst 6.5 interrupt<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CALL</span><span class="tab" val="79"></span><span style="font: 10pt serif">ResetChannels</span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,GetTaskQuiet<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">SHLD</span><span class="tab" val="79"></span><span style="font: 10pt serif">GetTaskResumeAddress<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,PutTaskQuiet<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">SHLD</span><span class="tab" val="79"></span><span style="font: 10pt serif">PutTaskResumeAddress<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">ResetMiscTaskFlag</span><span class="tab" val="79"></span><span style="font: 10pt serif"><br>;<br>DoMajorSetParameters:<br>{Set CurrentParameters depending on RS232CParameter2Hi:<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif"> (mask 3):<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">0 =&gt; Sdlc<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">1 =&gt; Bisync<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">2 =&gt; Async<br>}<br>{Set the mode.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CParameter2Hi</span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ANI</span><span class="tab" val="79"></span><span style="font: 10pt serif">CPLineTypeMask<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CMode<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JZ</span><span class="tab" val="79"></span><span style="font: 10pt serif">SetSdlcParameters</span><span class="tab" val="79"></span><span style="font: 10pt serif">;Zero is Sdlc mode<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CPI</span><span class="tab" val="79"></span><span style="font: 10pt serif">CPBisyncMode<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JZ</span><span class="tab" val="79"></span><span style="font: 10pt serif">SetBisyncParameters<br><br>SetAsyncParameters:<br>{Set up the Async timer.}<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LHLD</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CParameter4</span><span class="tab" val="79"></span><span style="font: 10pt serif">; get user-supplied timeout value<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">A,1</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">; Set timer not running<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CALL</span><span class="tab" val="79"></span><span style="font: 10pt serif">SetAsyncTimer<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H, PutAsyncMode<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">SHLD</span><span class="tab" val="79"></span><span style="font: 10pt serif">PutModeSwitch</span><span class="tab" val="79"></span><span style="font: 10pt serif">; Set JMP instruction<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,AsyncGetLoop<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">SHLD</span><span class="tab" val="79"></span><span style="font: 10pt serif">GetModeSwitch<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,AsyncRS232CInterrupt<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">D,AsyncDefaultParameters</span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CALL</span><span class="tab" val="79"></span><span style="font: 10pt serif">CopyParameters<br><br>{In Async mode, check for one or two Stop bits and set up WR4 depending on RS232CParameter2Hi:<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif"> (mask 4):<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">0 =&gt; 1 Stop bit<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">1 =&gt; 2 Stop bits}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">D,StopBits1</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CParameter2Hi<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ANI</span><span class="tab" val="79"></span><span style="font: 10pt serif">CPStopBitsMask</span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JZ</span><span class="tab" val="79"></span><span style="font: 10pt serif">SetStopBits<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">D,StopBits2<br>SetStopBits:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxWR4</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ORA</span><span class="tab" val="79"></span><span style="font: 10pt serif">D<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxWR4<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxWR4<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ORA</span><span class="tab" val="79"></span><span style="font: 10pt serif">D<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxWR4<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,AsynchronousDivisor<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">SetBaud</span><span class="tab" val="79"></span><span style="font: 10pt serif"><br><br>SetBisyncParameters:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H, PutBisyncMode<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">SHLD</span><span class="tab" val="79"></span><span style="font: 10pt serif">PutModeSwitch</span><span class="tab" val="79"></span><span style="font: 10pt serif">; Set JMP instruction<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,BisyncGetLoop<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">SHLD</span><span class="tab" val="79"></span><span style="font: 10pt serif">GetModeSwitch<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,BisyncRS232CInterrupt<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">D,BisyncDefaultParameters</span><span class="tab" val="79"></span><span style="font: 10pt serif"> <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CALL</span><span class="tab" val="79"></span><span style="font: 10pt serif">CopyParameters<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,SynchronousDivisor<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">SetBaud<br><br>SetSdlcParameters:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,PutSdlcMode<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">SHLD</span><span class="tab" val="79"></span><span style="font: 10pt serif">PutModeSwitch</span><span class="tab" val="79"></span><span style="font: 10pt serif">; Set JMP instruction<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,SdlcGetLoop</span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">SHLD</span><span class="tab" val="79"></span><span style="font: 10pt serif">GetModeSwitch<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,SdlcRS232CInterrupt<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">D,SdlcDefaultParameters</span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CALL</span><span class="tab" val="79"></span><span style="font: 10pt serif">CopyParameters<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,SynchronousDivisor<br><br>SetBaud:<br>{Set the baud rate. HL points to Divisor table.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CParameter1Hi</span><span class="tab" val="79"></span><span style="font: 10pt serif">; Set Baud Rate<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ANI</span><span class="tab" val="79"></span><span style="font: 10pt serif">CPLineSpeedMask</span><span class="tab" val="79"></span><span style="font: 10pt serif">; Async:x16, Sync or Sdlc:x1<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">CurrentBaudRate<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CALL</span><span class="tab" val="79"></span><span style="font: 10pt serif">SetBaudRate</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br><br>SetSyncCharacter:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CParameter3<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">CurrentSyncCharacter<br><br>{If ResetRingHeard bit is set, reset the RingHeardLatch.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CALL</span><span class="tab" val="79"></span><span style="font: 10pt serif">CheckResetRingHeard<br><br>{Set up the parity parameters in WR4 depending on RS232CParameter2 (mask 0E0):<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">0 =&gt; no parity<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">20H (1) =&gt; odd parity<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">40H (2) =&gt; even parity<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">60H (3) =&gt; one parity (no parity specified, but add "1" bit)<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">80H (4) =&gt; zero parity (no parity specified, but add "0" bit)<br>Set up B to contain the bits to OR into WR4.}<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">D,0</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">; Assume no parity<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CParameter2<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ANI</span><span class="tab" val="79"></span><span style="font: 10pt serif">CPParityMask<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JZ</span><span class="tab" val="79"></span><span style="font: 10pt serif">SetParity</span><span class="tab" val="79"></span><span style="font: 10pt serif">;zero =&gt; no parity<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CPI</span><span class="tab" val="79"></span><span style="font: 10pt serif">CPOneParity<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JZ</span><span class="tab" val="79"></span><span style="font: 10pt serif">SetParity<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CPI</span><span class="tab" val="79"></span><span style="font: 10pt serif">CPZeroParity<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JZ</span><span class="tab" val="79"></span><span style="font: 10pt serif">SetParity<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">D,ParityOdd</span><span class="tab" val="79"></span><span style="font: 10pt serif">;if parity is specified<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CPI</span><span class="tab" val="79"></span><span style="font: 10pt serif">CPOddParity</span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JZ</span><span class="tab" val="79"></span><span style="font: 10pt serif">SetParity<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">D,ParityEven</span><span class="tab" val="79"></span><span style="font: 10pt serif"><br><br>SetParity:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxWR4<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ORA</span><span class="tab" val="79"></span><span style="font: 10pt serif">D<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxWR4<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxWR4<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ORA</span><span class="tab" val="79"></span><span style="font: 10pt serif">D<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxWR4<br><br>{Set the character length depending on the character length  (mask 18):<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">0 =&gt; char length = 5</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">8H (1) =&gt; char length = 6</span><span class="tab" val="79"></span><span style="font: 10pt serif">80<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">10H (2) =&gt; char length = 7</span><span class="tab" val="79"></span><span style="font: 10pt serif">40<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">18H (3) =&gt; char length = 8</span><span class="tab" val="79"></span><span style="font: 10pt serif">C0}<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CParameter2</span><span class="tab" val="79"></span><span style="font: 10pt serif">; Charcter Length Check<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ANI</span><span class="tab" val="79"></span><span style="font: 10pt serif">CPCharLMask</span><span class="tab" val="79"></span><span style="font: 10pt serif">;A &larr; LLxxx<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">RRC</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;A &larr; LLxx<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">RRC</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;A &larr; LLx<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">RRC</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;A &larr; LL<br><br>{Pick up the character length code that we will use to set WR3, and set up WR3.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MOV</span><span class="tab" val="79"></span><span style="font: 10pt serif">E,A</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;DE &larr; character length code * 2<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">D,0<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,CharLengthTable<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DAD</span><span class="tab" val="79"></span><span style="font: 10pt serif">D</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;HL &larr; CharLengthTable + length code<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxWR3</span><span class="tab" val="79"></span><span style="font: 10pt serif">; Set Character Length<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ORA</span><span class="tab" val="79"></span><span style="font: 10pt serif">M<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxWR3<br><br>{The character length code for WR5 is the character length code for WR3 shifted right one position. Set up WR5.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ANI</span><span class="tab" val="79"></span><span style="font: 10pt serif">Rx8BitsPerCharacter</span><span class="tab" val="79"></span><span style="font: 10pt serif">;A &larr; character length for WR3<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">RRC</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;A &larr; character length for WR5<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MOV</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,A<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxWR5<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ORA</span><span class="tab" val="79"></span><span style="font: 10pt serif">H<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxWR5<br><br>{Set up the character length mask.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,CurrentCharLengthMaskTable<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DAD</span><span class="tab" val="79"></span><span style="font: 10pt serif">D</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;HL &larr; CurrentCharLengthMaskTable + length code<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MOV</span><span class="tab" val="79"></span><span style="font: 10pt serif">A,M<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">CurrentCharLengthMask<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br><br>{Set Data Terminal Ready (DTR) in WR5 if this bit is set in the parameter.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CParameter2Hi</span><span class="tab" val="79"></span><span style="font: 10pt serif">; Check Command<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ANI</span><span class="tab" val="79"></span><span style="font: 10pt serif">CPDTRMask</span><span class="tab" val="79"></span><span style="font: 10pt serif">;Mask = 8<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JZ</span><span class="tab" val="79"></span><span style="font: 10pt serif">CheckRTS<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxWR5</span><span class="tab" val="79"></span><span style="font: 10pt serif">; Set DTR bit if command bit is 1<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ORI</span><span class="tab" val="79"></span><span style="font: 10pt serif">DTR<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxWR5<br><br>CheckRTS:<br>{Set Clear To Send (CTS) in WR5 if this bit is set in the parameter.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CParameter2Hi</span><span class="tab" val="79"></span><span style="font: 10pt serif">; Check Command<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ANI</span><span class="tab" val="79"></span><span style="font: 10pt serif">CPRTSMask</span><span class="tab" val="79"></span><span style="font: 10pt serif">;Mask = 10H<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JZ</span><span class="tab" val="79"></span><span style="font: 10pt serif">CheckRingHeard<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxWR5</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">; Set DTR bit if command bit is 1<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ORI</span><span class="tab" val="79"></span><span style="font: 10pt serif">RTS<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CALL</span><span class="tab" val="79"></span><span style="font: 10pt serif">UpdateTxWR5<br><br>CheckRingHeard:<br>{Turn off RingHeardLatch if ResetRingHeard is set in the parameter.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CParameter2Hi</span><span class="tab" val="79"></span><span style="font: 10pt serif">; Reset Ring Hard, if required<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ANI</span><span class="tab" val="79"></span><span style="font: 10pt serif">CPRRHMask<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JZ</span><span class="tab" val="79"></span><span style="font: 10pt serif">CheckCorrespondent<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">XRA</span><span class="tab" val="79"></span><span style="font: 10pt serif">A<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RingHeardLatch<br><br>CheckCorrespondent:<br>{Check the Correspondent specified in RS232CParameter3Hi:<br>  0 = xerox800<br>  1 = xerox850<br>  2 = system6<br>  3 = cmcII<br>  4 = ttyHost<br>  5 = oisSystemElement<br>  6 = ibm3270Host<br>  7 = ibm2770Host<br>  8 = ibm6670Host<br>  9 = ibm6670<br>  10 = xerox860<br>  11 = oisSystemElementBSC<br><br>If we are running in BiSync mode, we assume the code is EBCDIC. Check to see if we have a correspondent that requires an ASCII code.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CParameter3Hi</span><span class="tab" val="79"></span><span style="font: 10pt serif">; Set Correspondents<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">CurrentCorrespondents<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CPI</span><span class="tab" val="79"></span><span style="font: 10pt serif">IBM3270Host<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,EndOfBisyncFrame</span><span class="tab" val="79"></span><span style="font: 10pt serif">;Assume not 3270 host<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JNZ</span><span class="tab" val="79"></span><span style="font: 10pt serif">SetEOTEndFrameSwitch<br><br>{If the host is a 3270, it requires special treatment for EOT EndOfFrame.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,EOT3270<br><br>SetEOTEndFrameSwitch:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">SHLD</span><span class="tab" val="79"></span><span style="font: 10pt serif">EOTEndFrameSwitch<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CPI</span><span class="tab" val="79"></span><span style="font: 10pt serif">Xerox850<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JZ</span><span class="tab" val="79"></span><span style="font: 10pt serif">SetAsciiCode<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CPI</span><span class="tab" val="79"></span><span style="font: 10pt serif">xerox860<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JNZ</span><span class="tab" val="79"></span><span style="font: 10pt serif">SaveSynCount<br><br>SetAsciiCode:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,AsciiCodeTable<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">D,CurrentCode<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">A,AsciiCodeTableSize</span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CALL</span><span class="tab" val="79"></span><span style="font: 10pt serif">Copy<br><br>SaveSynCount:<br>{Save the number of SYN characters to send.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CParameter2</span><span class="tab" val="79"></span><span style="font: 10pt serif">; Save Sync Count value<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ANI</span><span class="tab" val="79"></span><span style="font: 10pt serif">CPSyncCntMask<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">CurrentSyncCount<br><br>{Perform common initialization for Get and Put tasks.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">XRA</span><span class="tab" val="79"></span><span style="font: 10pt serif">A</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">AbortGetFlag<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">AbortPutFlag<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,StartGetTask<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">SHLD</span><span class="tab" val="79"></span><span style="font: 10pt serif">GetTaskResumeAddress<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,StartPutTask<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">SHLD</span><span class="tab" val="79"></span><span style="font: 10pt serif">PutTaskResumeAddress<br>;<br>{Initialize depending on the current Mode.} <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CMode<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ORA</span><span class="tab" val="79"></span><span style="font: 10pt serif">A<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JZ</span><span class="tab" val="79"></span><span style="font: 10pt serif">InitializeSdlcMode<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CPI</span><span class="tab" val="79"></span><span style="font: 10pt serif">CPAsyncMode<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JZ</span><span class="tab" val="79"></span><span style="font: 10pt serif">InitializeAsyncMode<br><br>InitializeBisyncMode:<br>{Continue if mode is Bisync. Initialize character values for parsing depending on the character set.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">BEL<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">BEL1<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">BEL6<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">ENQ<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">ENQ1<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">ENQ2<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">ENQ4<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">ENQ6<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">ENQ9<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">ENQ10<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">ENQ11<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">ENQ12<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">EOT<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">EOT1<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">EOT6<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">ETB<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">ETB2<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">ETB4<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">ETB5<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">ETB6<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">ETB7<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">ETB8<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">ETB9<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">ETB10<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">ETB11<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">ETB12<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">NAK<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">NAK1<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">NAK6<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">SYN<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">SYN1<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">SYN2<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">SYN3<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">SYN4<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">SYN5<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">SYN6<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">SYN7<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">SYN8<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">SYN9<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">SYN10<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">SYN11<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">SYN12<br><br>{WR3 has been set up for the number of bits per character. Store this value wherever we want to disable CRC.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxWR3<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ORI</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxEnable<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">DisableRxCRC1<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">DisableRxCRC2<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">DisableRxCRC3<br><br>{OR in RxCRCEnable and store this value wherever we want to enable the CRC generator.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ORI</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxCRCEnable<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">EnableRxCRC1<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">EnableRxCRC2<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">EnableRxCRC3<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">EnableRxCRC4<br><br>{OR in the SyncCharacterLoadInhibit bit and the EnterHuntMode bit. This is the initial state of the receiver.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxWR3<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ORI</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxEnable+SyncCharacterLoadInhibit+EnterHuntPhase<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">EnterHuntMode1<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">EnterHuntMode2<br><br>{Initialize the values for the one second timer.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,BisyncTimerTable<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">CurrentBaudRate<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CALL</span><span class="tab" val="79"></span><span style="font: 10pt serif">HLPlus2A<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MOV</span><span class="tab" val="79"></span><span style="font: 10pt serif">A,M<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">OneSecondTimerLow<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">INX</span><span class="tab" val="79"></span><span style="font: 10pt serif">H<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MOV</span><span class="tab" val="79"></span><span style="font: 10pt serif">A,M<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">OneSecondTimerHigh<br><br>{Set up the SIO chip. The order is important. Any deviation from this may cause the chip to do weird things.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DI<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">A,ChannelReset<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">OUT</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxCont<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">A,PointToWR4<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">OUT</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxCont<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxWR4<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">OUT</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxCont<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">A,PointToWR5+ResetExternalStatusInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">OUT</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxCont<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxWR5<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">OUT</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxCont<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">A,PointToWR3<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">OUT</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxCont<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxWR3<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ORI</span><span class="tab" val="79"></span><span style="font: 10pt serif">EnterHuntPhase+SyncCharacterLoadInhibit<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">OUT</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxCont<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">A,PointToWR6<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">OUT</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxCont<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">CurrentSyncCharacter<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">OUT</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxCont<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">A,PointToWR7<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">OUT</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxCont<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">CurrentSyncCharacter<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">OUT</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxCont<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">A,PointToWR1+ResetExternalStatusInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">OUT</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxCont<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxWR1<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">OUT</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxCont<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">A,ChannelReset<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">OUT</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxCont<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">A,PointToWR4<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">OUT</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxCont<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxWR4<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">OUT</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxCont<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">A,PointToWR6<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">OUT</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxCont<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">A,Filler<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">OUT</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxCont<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">A,PointToWR7+ResetExternalStatusInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">OUT</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxCont<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">A,Filler<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">OUT</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxCont<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">A,PointToWR1+ResetExternalStatusInterrupts<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">OUT</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxCont<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxWR1<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">OUT</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxCont<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">A,PointToWR5<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">OUT</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxCont<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxWR5<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">OUT</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxCont<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">ReturnSuccess<br><br><br>InitializeSdlcMode:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,8000H+RxCont</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;HL points to Rx Control register<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DI<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">M,ChannelReset<br><br>{Set WR6 for the Sdlc sync character}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">M,ResetExternalStatusInterrupts+PointToWR6<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CParameter3<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MOV</span><span class="tab" val="79"></span><span style="font: 10pt serif">M,A<br><br>{Set WR7 to the Sdlc flag character.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">M,ResetExternalStatusInterrupts+PointToWR7<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">M,7EH<br><br>{WR4 has been set up for X1 ClockMode and Sdlc mode.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">M,ResetExternalStatusInterrupts+PointToWR4<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxWR4<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MOV</span><span class="tab" val="79"></span><span style="font: 10pt serif">M,A<br><br>{WR3 has been set up for the number of bits per character and CRC Enable.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">M,ResetExternalStatusInterrupts+PointToWR3<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxWR3<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MOV</span><span class="tab" val="79"></span><span style="font: 10pt serif">M,A<br><br>{WR1 has been set up for ExternalIntEnable, IntOnAllRxCharacters (status affects parity)}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">M,ResetExternalStatusInterrupts+PointToWR1<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxWR1<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MOV</span><span class="tab" val="79"></span><span style="font: 10pt serif">M,A<br><br>{Now initialize Channel B, the Tx channel}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,8000H+TxCont</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;HL points to TxControl register<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">M,ChannelReset<br><br>{Set WR7 to the Sdlc flag character.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">M,ResetExternalStatusInterrupts+PointToWR7<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">M,7EH<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">SetTxWR4<br><br><br>InitializeAsyncMode:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,8000H+RxCont</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;HL points to Rx Control register<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DI<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">M,ChannelReset<br><br>{WR4 has been set up for X16 ClockMode, the number of stop bits/character, and the parity specified by the client&rsquo;s parameter record.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">M,ResetExternalStatusInterrupts+PointToWR4<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxWR4<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MOV</span><span class="tab" val="79"></span><span style="font: 10pt serif">M,A<br><br>{WR3 has been set up for the number of bits per character}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">M,ResetExternalStatusInterrupts+PointToWR3<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxWR3<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MOV</span><span class="tab" val="79"></span><span style="font: 10pt serif">M,A<br><br>{WR1 has been set up for ExternalIntEnable, IntOnAllRxCharacters (status affects parity)}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">M,ResetExternalStatusInterrupts+PointToWR1<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxWR1<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MOV</span><span class="tab" val="79"></span><span style="font: 10pt serif">M,A<br><br>{Now initialize Channel B, the Tx channel}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,8000H+TxCont</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;HL points to TxControl register<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">M,ChannelReset<br><br>SetTxWR4:<br>{WR4 has been set up for X16 ClockMode, the number of stop bits/character, and the parity specified by the client&rsquo;s parameter record.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">M,ResetExternalStatusInterrupts+PointToWR4<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxWR4<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MOV</span><span class="tab" val="79"></span><span style="font: 10pt serif">M,A<br><br>{WR5 has been set up for the number of bits/character, DataTerminalReady (if specified in the client&rsquo;s parameter record), RequestToSend (if specified in the client&rsquo;s parameter record).}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">M,ResetExternalStatusInterrupts+PointToWR5<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxWR5<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MOV</span><span class="tab" val="79"></span><span style="font: 10pt serif">M,A<br><br>{WR1 has been set up for StatusAffectsVector, ExternalIntEnable, TxIntEnable}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">M,ResetExternalStatusInterrupts+PointToWR1<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxWR1<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MOV</span><span class="tab" val="79"></span><span style="font: 10pt serif">M,A<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br>ReturnSuccess:<br>{Return Success in the CSB.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">EI<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,XferSuccess<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">SHLD</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CParameter<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,SendParameter<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">ReturnResult<br>;<br>DoSetRS366Status:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CParameter2</span><span class="tab" val="79"></span><span style="font: 10pt serif">; Read New RS366 Status<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ANI</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS366StatusMask<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CALL</span><span class="tab" val="79"></span><span style="font: 10pt serif">SetRS366</span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">ResetMiscTaskFlag<br>;<br>DoGetStatus:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IN</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS366Reg</span><span class="tab" val="79"></span><span style="font: 10pt serif">; Read RS366 Reg Condition<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS366Buffer<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ANI</span><span class="tab" val="79"></span><span style="font: 10pt serif">DLO+PND+COS+ACR+PWI<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CDeviceStatusHi</span><span class="tab" val="79"></span><span style="font: 10pt serif">;Save RS366 Reg Condition in Device Status<br><br>{Get Data Carrier Detect bit from RR0.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IN</span><span class="tab" val="79"></span><span style="font: 10pt serif">RxCont<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ANI</span><span class="tab" val="79"></span><span style="font: 10pt serif">BreakAbort+DCD</span><span class="tab" val="79"></span><span style="font: 10pt serif">; Bk ABT is only on Async Mode<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MOV</span><span class="tab" val="79"></span><span style="font: 10pt serif">D,A</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;Save DCD in D<br><br>{Get Clear To Send Detect bit from RR0.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">IN</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxCont<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ANI</span><span class="tab" val="79"></span><span style="font: 10pt serif">CTS<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ORA</span><span class="tab" val="79"></span><span style="font: 10pt serif">D<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MOV</span><span class="tab" val="79"></span><span style="font: 10pt serif">D,A</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;Save DCD and CTS in D<br><br>{Get DataSetReady bit from RS366Buffer.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">opMVIA</span><span class="tab" val="79"></span><span style="font: 10pt serif">;A &larr; RS366Buffer<br>RS366Buffer:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ANI</span><span class="tab" val="79"></span><span style="font: 10pt serif">DSRdy</span><span class="tab" val="79"></span><span style="font: 10pt serif">; Data Set Ready?<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JZ</span><span class="tab" val="79"></span><span style="font: 10pt serif">CheckRingIndicator<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">A,DataSetReady</span><span class="tab" val="79"></span><span style="font: 10pt serif">; IF Yes, DataSetReady bit Set<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ORA</span><span class="tab" val="79"></span><span style="font: 10pt serif">D<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MOV</span><span class="tab" val="79"></span><span style="font: 10pt serif">D,A</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;Save DataSetReady, DCD and CTS in D<br><br>CheckRingIndicator:<br>{Get RingIndicator from RS366Buffer.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS366Buffer<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ANI</span><span class="tab" val="79"></span><span style="font: 10pt serif">Ring</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">; Ring Heard?<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JZ</span><span class="tab" val="79"></span><span style="font: 10pt serif">CheckRingHeardLatch<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">A,RingIndicator</span><span class="tab" val="79"></span><span style="font: 10pt serif">; If Yes, Ring Indicator bit Set<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ORA</span><span class="tab" val="79"></span><span style="font: 10pt serif">D<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MOV</span><span class="tab" val="79"></span><span style="font: 10pt serif">D,A<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RingHeardLatch</span><span class="tab" val="79"></span><span style="font: 10pt serif">; Set RingHeard Latch<br><br>CheckRingHeardLatch:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">opMVIA</span><span class="tab" val="79"></span><span style="font: 10pt serif">;A &larr; RingHeardLatch<br>RingHeardLatch:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DB</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ORA</span><span class="tab" val="79"></span><span style="font: 10pt serif">A<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JZ</span><span class="tab" val="79"></span><span style="font: 10pt serif">WriteDeviceStatus<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">A,RingHeard</span><span class="tab" val="79"></span><span style="font: 10pt serif">; IF Yes, Ring Heard bit set<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ORA</span><span class="tab" val="79"></span><span style="font: 10pt serif">D<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MOV</span><span class="tab" val="79"></span><span style="font: 10pt serif">D,A<br><br>WriteDeviceStatus:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MOV</span><span class="tab" val="79"></span><span style="font: 10pt serif">A,D<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">STA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CDeviceStatus<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,SendDeviceStatus<br><br>ReturnResult:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CALL</span><span class="tab" val="79"></span><span style="font: 10pt serif">WriteCPBuffer<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">ResetMiscTaskFlag<br>;<br>DoMinorSetParameters:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxWR5 <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ANI</span><span class="tab" val="79"></span><span style="font: 10pt serif">0FFH-DTR-RTS</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;Turn off DTR and RTS<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MOV</span><span class="tab" val="79"></span><span style="font: 10pt serif">D,A</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;Save TxWR5 in D<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CParameter2Hi</span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ANI</span><span class="tab" val="79"></span><span style="font: 10pt serif">CPDTRMask<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JZ</span><span class="tab" val="79"></span><span style="font: 10pt serif">RTSControl<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MOV</span><span class="tab" val="79"></span><span style="font: 10pt serif">A,D</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">; Set DTR bit if command bit is 1<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ORI</span><span class="tab" val="79"></span><span style="font: 10pt serif">DTR<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MOV</span><span class="tab" val="79"></span><span style="font: 10pt serif">D,A</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;Save TxWR5 in D<br><br>RTSControl:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">RS232CParameter2Hi</span><span class="tab" val="79"></span><span style="font: 10pt serif">; Check Command<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ANI</span><span class="tab" val="79"></span><span style="font: 10pt serif">CPRTSMask<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MOV</span><span class="tab" val="79"></span><span style="font: 10pt serif">A,D</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">; Set RTS bit if command bit is 1<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JZ</span><span class="tab" val="79"></span><span style="font: 10pt serif">ControlSigSet<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ORI</span><span class="tab" val="79"></span><span style="font: 10pt serif">RTS<br>ControlSigSet:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CALL</span><span class="tab" val="79"></span><span style="font: 10pt serif">UpdateTxWR5<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LDA</span><span class="tab" val="79"></span><span style="font: 10pt serif">TxWR5<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,TxCont+8000H</span><span class="tab" val="79"></span><span style="font: 10pt serif">;HL points to TxCont register<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DI<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MVI</span><span class="tab" val="79"></span><span style="font: 10pt serif">M,PointToWR5</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">MOV</span><span class="tab" val="79"></span><span style="font: 10pt serif">M,A</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">;Send new WR5 command<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">EI<br><br>{If ResetRingHeard bit is set, reset the RingHeardLatch.}<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CALL</span><span class="tab" val="79"></span><span style="font: 10pt serif">CheckResetRingHeard<br><br>ResetMiscTaskFlag:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">LXI</span><span class="tab" val="79"></span><span style="font: 10pt serif">H,ZeroMiscFlag<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CALL</span><span class="tab" val="79"></span><span style="font: 10pt serif">WriteCPBuffer<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JMP</span><span class="tab" val="79"></span><span style="font: 10pt serif">MiscYield<br><br>SaveMiscResumeAddressAndYield:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">SHLD</span><span class="tab" val="79"></span><span style="font: 10pt serif">MiscTaskResumeAddress<br>MiscYield:<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DS</span><span class="tab" val="79"></span><span style="font: 10pt serif">0<br>{Pass control to the next task specified in Domino.cfg}<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">END<br></span></div>
<script>function do_tabs() { // unit = px
  var tabs = document.getElementsByClassName("tab");
  for (var i = 0; i < tabs.length; ++i) {
    var span = tabs[i];
    var val = span.getAttribute("val");
    if (val == null) console.log("Couldn't get val");
    var rect = span.getBoundingClientRect();
    var tabstop;
    if (val > 0) tabstop = Math.ceil(rect.left / val) * val;
    else tabstop = -val;
    console.log("do_tabs", val, tabstop)
    if (tabstop > 0) {
      var width = tabstop - rect.left;
      span.style.display = "inline-block";
      span.style.width = width + "px";
    }
  }
}
do_tabs();
</script>
  </body>
</html>
