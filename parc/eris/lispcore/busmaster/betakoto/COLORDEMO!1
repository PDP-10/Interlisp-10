(FILECREATED " 8-Dec-85 15:10:43" {ERIS}<LISPCORE>LIBRARY>COLORDEMO.;3 44967        changes to:  (FNS COLORDEMO MODART MODARTDEMO VINEDEMO)		   (VARS COLORDEMOCOMS)      previous date: "20-Jun-85 18:11:13" {ERIS}<LISPCORE>LIBRARY>COLORDEMO.;2)(* Copyright (c) 1982, 1983, 1985 by Xerox Corporation. All rights reserved.)(PRETTYCOMPRINT COLORDEMOCOMS)(RPAQQ COLORDEMOCOMS ((FNS COLORDEMO CHOOSEDEMO DOCOLORDROP EXMINESHAFT MINESHAFT MODART MODARTDEMO 			     POINTTEST PUTDROPS QUITP RAINING RAININGCOLORMAP ROTATEIT SHOWCOLORW 			     TUNNEL TUNNELDEMO CIRCLEDEMO WELL)	(VARS COLORDEMOS \FIRSTAUTODEMO (\NEWCOLORDEMO NIL)	      (STOPDATE NIL)	      (DEMORAINBOWMAP)	      (DEMODEFAULTCOLORMAP)	      (DEMORAININGCOLORMAP))	(GLOBALVARS COLORDEMOS \FIRSTAUTODEMO \NEWCOLORDEMO STOPDATE DEMORAINBOWMAP 		    DEMODEFAULTCOLORMAP)	(COMS (* Logo demos)	      (FNS LOGODEMO COLORLOGO DRAWACOLORWINDOW INIT/LOGO/COLORBITMAP COLORPRINTCHAR)	      (VARS ANGLEDELTA CIRCLESIZE LOGOCYCLEWAITTIME (JLOGO)		    (WINDOWIMAGE)		    (INTERLISP-D/COLORBITMAP))	      (GLOBALVARS INTERLISP-D/COLORBITMAP))	(COMS (* Kinetic demos)	      (FNS COLORKINETIC DEMOCOLORKINETIC CIRKIN)	      (VARS (KINETICWAITTIME 150))	      (GLOBALVARS KINETICWAITTIME))	(COMS (FNS COLORDEMO1 COLORDEMO2 INIT/COLORDEMO/MENUS)	      (VARS KINCYCLEWAITTIME (COLORKINETICCOMMANDMENU)		    (COLORPRINTCHARDS)		    (COLORDEMO2MENU))	      (VARS RAINBOWINTENSITIES))	(COMS (* Simple demos)	      (FNS REDGREEN))	(COMS (* Overpaint demos)	      (FNS OVERPAINTDEMO OVERPAINTBM OVERPAINTSELFN CACHEBITMAP NEWX NEWY)	      (VARS (OVERPAINTBITMAPS)))	(COMS (* Walk demos)	      (FNS WALKDEMO WALKBM RANDCOLORMAP)	      (INITVARS MAXWALK MINWALK RANDCOLORPROB (WALKRANDOMCOLORMAP)			(8BITBMEXP (LIST (HARRAY 60)))			(4BITBMEXP (LIST (HARRAY 60))))	      (GLOBALVARS 8BITBMEXP 4BITBMEXP WALKRANDOMCOLORMAP))	(COMS (* Vines demo)	      (FNS VINEDEMO INRANGE))	(FILES COLOR)))(DEFINEQ(COLORDEMO  (LAMBDA (FASTFLG)                                          (* kbr: " 8-Dec-85 14:49")    (DECLARE (GLOBALVARS COLORDEMOS \FIRSTAUTODEMO \NEWCOLORDEMO STOPDATE))    (RESETLST (COND		  ((NULL (COLORDISPLAYP))		    (COLORDISPLAY T)))		(COND		  ((EQ (TYPENAME (SCREENCOLORMAP))			 (TYPENAME DEMODEFAULTCOLORMAP)))		  (T (SETQ DEMODEFAULTCOLORMAP (COLORMAPCREATE))))		(COND		  ((EQ (TYPENAME (SCREENCOLORMAP))			 (TYPENAME DEMORAINBOWMAP)))		  (T (SETQ DEMORAINBOWMAP (RAINBOWMAP))))		(COND		  ((EQ (TYPENAME (SCREENCOLORMAP))			 (TYPENAME DEMORAININGCOLORMAP)))		  (T (SETQ DEMORAININGCOLORMAP (RAININGCOLORMAP))))		(RESETSAVE (SCREENCOLORMAP DEMODEFAULTCOLORMAP))		(PROG ((COLORMENU (create MENU					      TITLE _ "Color demos"					      ITEMS _ (APPEND COLORDEMOS (QUOTE (STOP)))					      WHENSELECTEDFN _ (QUOTE CHOOSEDEMO))))		        (RESETSAVE NIL (LIST (QUOTE CLOSEW)						 (ADDMENU COLORMENU NIL							    (COND							      (FASTFLG                                                              (* put the menu at the top of the black and white 							     screen.)								       (create POSITION										 XCOORD _ 400										 YCOORD _										 (IDIFFERENCE										   SCREENHEIGHT										   (fetch 										      IMAGEHEIGHT										      of COLORMENT))										 ))							      (T (GETBOXPOSITION (fetch 										       IMAGEWIDTH										      of COLORMENU)										   (fetch 										      IMAGEHEIGHT										      of COLORMENU))								 )))))		        (AND FASTFLG (RESETSAVE (SETDISPLAYHEIGHT (fetch IMAGEHEIGHT									   of COLORMENU)))))		(SETQ \NEWCOLORDEMO NIL)		(bind (\NEXTCOLORDEMO _ \FIRSTAUTODEMO) until (EQ \NEXTCOLORDEMO (QUOTE									  STOP))		   do (SETQ STOPDATE (IPLUS (COND						    ((EQ (MACHINETYPE)							   (QUOTE DORADO))						      40)						    (T 60))						  (IDATE)))			(SETQ \NEWCOLORDEMO NIL)			(APPLY \NEXTCOLORDEMO)			(SETQ \NEXTCOLORDEMO (OR \NEWCOLORDEMO (CADR (FMEMB \NEXTCOLORDEMO 										    COLORDEMOS))						     \FIRSTAUTODEMO))		   finally (SETQ \NEWCOLORDEMO NIL)))))(CHOOSEDEMO  [LAMBDA (NEW)    (DECLARE (GLOBALVARS \NEWCOLORDEMO))                     (* bas: " 5-JUN-82 13:07")    (SETQ \NEWCOLORDEMO NEW])(DOCOLORDROP  [LAMBDA (X Y WIDTH RADIUSINCR NCIRCLES DS COLOR# MAXCOLOR)                                                             (* rrb "30-SEP-82 09:57")                                                             (* draws a series of concentric circles.							     Uses COLOR# freely.)    (for I from 1 to NCIRCLES do (DRAWCIRCLE X Y (ITIMES I RADIUSINCR)					     [LIST (QUOTE ROUND)						   WIDTH						   (COND						     ((ILESSP (SETQ COLOR# (ADD1 COLOR#))							      MAXCOLOR)						       COLOR#)						     (T (SETQ COLOR# 1]					     NIL DS))    COLOR#])(EXMINESHAFT  [LAMBDA (OUTFLG FACTOR)                                    (* edited: "12-SEP-82 13:05")                                                             (* draws a mineshaft on the colorscreen.)    (PROG [(COLOR 0)	   (LEFT 0.0)	   (BOTTOM 0.0)	   (MAXBOTTOM (FQUOTIENT COLORSCREENHEIGHT 2.0))	   (FACTOR (FQUOTIENT FACTOR 100.0))	   LEFTFACTOR BOTTOMFACTOR INCR (MAXCOLOR (SUB1 (EXPT 2 (COLORMAPBITS (SCREENCOLORMAP]          (SETQ LEFTFACTOR (FTIMES 4.0 FACTOR))          (SETQ BOTTOMFACTOR (FTIMES 3.0 FACTOR))      LP  (COLORFILLAREA (FIX LEFT)			 (FIX BOTTOM)			 (IDIFFERENCE COLORSCREENWIDTH (FTIMES LEFT 2))			 (IDIFFERENCE COLORSCREENHEIGHT (FTIMES BOTTOM 2))			 COLOR			 (COLORSCREENBITMAP))          [SETQ INCR (FPLUS 1.0 (FTIMES .1 (FDIFFERENCE MAXBOTTOM BOTTOM]          (SETQ LEFT (FPLUS LEFT (FTIMES INCR LEFTFACTOR)))          (SETQ BOTTOM (FPLUS BOTTOM (FTIMES INCR BOTTOMFACTOR)))          (COND	    ((FGREATERP BOTTOM MAXBOTTOM)	      (RETURN)))          [COND	    [OUTFLG (COND		      ((ILESSP (SETQ COLOR (SUB1 COLOR))			       0)			(SETQ COLOR MAXCOLOR]	    (T (COND		 ((IGREATERP (SETQ COLOR (ADD1 COLOR))			     MAXCOLOR)		   (SETQ COLOR 0]          (GO LP])(MINESHAFT  [LAMBDA (N OUTFLG)                                         (* edited: "10-SEP-82 17:55")                                                             (* draws a mineshaft on the colorscreen.)    (PROG ((COLOR 0)	   (N (OR (NUMBERP N)		  1)))          (for LEFT from 0 by (ITIMES N 4) as BOTTOM from 0 by (ITIMES N 3) to (IQUOTIENT 										COLORSCREENHEIGHT 2)	     do (COLORFILLAREA LEFT BOTTOM (IDIFFERENCE COLORSCREENWIDTH (ITIMES LEFT 2))			       (IDIFFERENCE COLORSCREENHEIGHT (ITIMES BOTTOM 2))			       COLOR			       (COLORSCREENBITMAP))		(COND		  [OUTFLG (COND			    ((ILESSP (SETQ COLOR (SUB1 COLOR))				     0)			      (SETQ COLOR 255]		  (T (COND		       ((IGREATERP (SETQ COLOR (ADD1 COLOR))				   256)			 (SETQ COLOR 0])(MODART  (LAMBDA NIL                                                (* kbr: " 8-Dec-85 14:49")    (COND      ((COLORDISPLAYP))      (T (COLORDISPLAY T)))    (PROG ((WD COLORSCREENWIDTH)	     (HT COLORSCREENHEIGHT)	     (CBM (COLORSCREENBITMAP))	     (MAXCOLOR (MAXIMUMCOLOR))	     X Y)	LP  (for I from 1 to 50	       do (SETQ X (RAND 0 WD))		    (SETQ Y (RAND 0 HT))		    (\NUBITBLT CBM 0 0 CBM (RAND 0 (IDIFFERENCE WD X))			       (RAND 0 (IDIFFERENCE HT Y))			       X Y (SELECTQ (RAND 0 1)					      (0 (QUOTE TEXTURE))					      (QUOTE INPUT))			       (SELECTQ (RAND 0 5)					  (0 (QUOTE INVERT))					  (QUOTE PAINT))			       (COLORTEXTUREFROMCOLOR# (RAND 0 MAXCOLOR)))		    (DISMISS 20)	       finally (ROTATECOLORMAP (SCREENCOLORMAP)))	    (GO LP))))(MODARTDEMO  (LAMBDA (WAIT)                                             (* kbr: " 8-Dec-85 14:49")    (COND      ((COLORDISPLAYP))      (T (COLORDISPLAY T)))    (PROG ((WD COLORSCREENWIDTH)	     (HT COLORSCREENHEIGHT)	     (CBM (COLORSCREENBITMAP))	     (MAXCOLOR (MAXIMUMCOLOR))	     X Y)	    (QUITP (OR WAIT 40))	    (until (QUITP NIL)	       do (for I from 1 to 8		       do (COND			      ((QUITP NIL)				(RETURN)))			    (SETQ X (RAND 0 WD))			    (SETQ Y (RAND 0 HT))			    (BITBLT CBM 0 0 CBM (RAND 0 (IDIFFERENCE WD X))				      (RAND 0 (IDIFFERENCE HT Y))				      X Y (QUOTE TEXTURE)				      (QUOTE REPLACE)				      (RAND 0 (LRSH MAXCOLOR 1)))			    (for J from 1 to 8			       do (SETQ X (RAND 0 WD))				    (SETQ Y (RAND 0 HT))				    (BITBLT CBM (RAND 0 (IDIFFERENCE WD X))					      (RAND 0 (IDIFFERENCE HT Y))					      CBM					      (RAND 0 (IDIFFERENCE WD X))					      (RAND 0 (IDIFFERENCE HT Y))					      X Y (QUOTE INPUT)					      (SELECTQ (RAND 0 2)							 (0 (QUOTE INVERT))							 (1 (QUOTE REPLACE))							 (QUOTE PAINT)))				    (DISMISS 300)				    (until (MOUSESTATE UP)))			    (ROTATECOLORMAP (SCREENCOLORMAP)))                                                             (* clear the screen every so often)		    (BITBLT CBM 0 0 CBM 0 (RAND (IDIFFERENCE HT Y))			      COLORSCREENWIDTH COLORSCREENHEIGHT (QUOTE TEXTURE)			      (QUOTE REPLACE)			      (RAND 0 (LRSH MAXCOLOR 1)))))))(POINTTEST  [LAMBDA (REGION)                                           (* edited: " 9-SEP-82 10:13")                                                             (* randomly puts points in a region)    (PROG ([LEFT (fetch (REGION LEFT) of (COND					   (REGION)					   (T WHOLECOLORDISPLAY]	   [BOTTOM (fetch (REGION BOTTOM) of (COND					       (REGION)					       (T WHOLECOLORDISPLAY]	   [RIGHT (fetch (REGION RIGHT) of (COND					     (REGION)					     (T WHOLECOLORDISPLAY]	   [TOP (fetch (REGION TOP) of (COND					 (REGION)					 (T WHOLECOLORDISPLAY]	   (MAXCOLOR (SUB1 (EXPT 2 \COLORDISPLAYBITSPERPIXEL)))	   (CSN (COLORSCREENBITMAP)))          (until (MOUSESTATE (NOT UP)) do (for I from 1 to 100 do (BITMAPBIT CSN (RAND LEFT RIGHT)									     (RAND BOTTOM TOP)									     (RAND 0 MAXCOLOR])(PUTDROPS  [LAMBDA (N)                                                (* rrb "21-SEP-82 15:54")    (PROG ((DS (DSPCREATE))	   POS)      LP  (SETQ POS (GETPOSITION))          (COND	    ((LASTMOUSESTATE RIGHT)	      (RETURN)))          (DOCOLORDROP (fetch XCOORD of POS)		       (fetch YCOORD of POS)		       (OR N 3)		       (COND			 ((LASTMOUSESTATE LEFT)			   (RAND 8 15))			 (T (RAND 10 20)))		       DS 128)          (GO LP])(QUITP  (LAMBDA (N)                                                (* edited: " 8-SEP-82 12:38")    (DECLARE (GLOBALVARS \NEWCOLORDEMO STOPDATE))    (WINDOW.MOUSE.HANDLER)    (OR \NEWCOLORDEMO (COND	  ((FIXP N)	    (SETQ STOPDATE (IPLUS N (IDATE)))	    NIL)	  (T (AND STOPDATE (ILESSP STOPDATE (IDATE))))))))(RAINING  [LAMBDA (N)                                                (* rrb "15-OCT-82 10:11")    (PROG ((COLOR# 0)	   (N (COND		((FIXP N))		(T 3)))	   (DS (DSPCREATE))	   (MAXCOLOR (MAXIMUMCOLOR)))          (DSPDESTINATION (COLORSCREENBITMAP)			  DS)          (COLORBACKGROUND 0)          (for COUNTER from 1 to (COND				   ((EQ MAXCOLOR 15)				     3)				   (T 12))	     do (for XQUAD from 0 to 1 do (for YQUAD from 0 to 1					     do (COND						  ((IGREATERP COLOR# 250)						    (RETURN)))						(SETQ COLOR#						  (DOCOLORDROP (IPLUS (ITIMES XQUAD (IQUOTIENT 										 COLORSCREENWIDTH 2))								      (RAND 10									    (IDIFFERENCE									      (IQUOTIENT 										 COLORSCREENWIDTH 2)									      10)))							       (IPLUS (ITIMES YQUAD (IQUOTIENT 										COLORSCREENHEIGHT 2))								      (RAND 10									    (IDIFFERENCE									      (IQUOTIENT 										COLORSCREENHEIGHT 2)									      10)))							       N							       (ITIMES N 3)							       (COND								 ((EQ MAXCOLOR 15)								   (RAND 4 8))								 (T (RAND 4 10)))							       DS COLOR# MAXCOLOR])(RAININGCOLORMAP  [LAMBDA NIL                                                (* rrb " 4-OCT-82 14:41")    (COLORMAPOF (COND		  [(EQ (MAXIMUMCOLOR)		       255)		    (NCONC (for I from 3 to 255 by 6 collect (LIST 0 0 I))			   (for I from 0 to 212 collect (QUOTE (0 0 0]		  (T (NCONC (LIST (QUOTE (0 0 0)))			    (for I from 100 to 255 by 50 collect (LIST 0 0 I))			    (for I from 0 to 11 collect (QUOTE (0 0 0])(ROTATEIT  [LAMBDA (BEGINCOLOR ENDCOLOR WAIT)                         (* rrb "30-SEP-82 11:35")    (PROG [(CM (SCREENCOLORMAP))	   (BEG (OR BEGINCOLOR 0))	   (END (OR ENDCOLOR (SUB1 (EXPT 2 (COLORMAPBITS (SCREENCOLORMAP]          (do (ROTATECOLORMAP CM BEGINCOLOR END)	      (COND		((NULL WAIT))		((SMALLP WAIT)		  (DISMISS WAIT))		(T (GETMOUSESTATE)		   (DISMISS (LRSH LASTMOUSEX 3])(SHOWCOLORW  [LAMBDA (W 1COLOR 0COLOR POS)                              (* rrb "22-SEP-82 10:19")    (PROG ((W (OR W (WHICHW)))	   DS)          (SETQ DS (DSPCREATE))          (DSPDESTINATION (COLORSCREENBITMAP)			  DS)          (DSPBACKGROUNDCOLOR 0COLOR DS)          (DSPFOREGROUNDCOLOR 1COLOR DS)          (CLOSEW W)          (OR POS (SETQ POS (GETPOSITION)))          (BITBLT (WINDOWPROP W (QUOTE IMAGECOVERED))		  0 0 DS (fetch XCOORD of POS)		  (fetch YCOORD of POS)		  NIL NIL (QUOTE INPUT)		  (QUOTE REPLACE))          (OPENW W])(TUNNEL  [LAMBDA (SPEED)                                            (* edited: "10-SEP-82 19:10")    (EXMINESHAFT T SPEED)    (ROTATEIT])(TUNNELDEMO  [LAMBDA (SPEED WAIT)                                       (* rrb "15-OCT-82 09:55")    (PROG [(CM (SCREENCOLORMAP DEMODEFAULTCOLORMAP))	   (MAXCOLOR (SUB1 (EXPT 2 (COLORMAPBITS (SCREENCOLORMAP]          (EXMINESHAFT T (OR SPEED 6))          (QUITP (OR WAIT 15))          (until (QUITP NIL) do (ROTATECOLORMAP CM 0 MAXCOLOR))          (SCREENCOLORMAP DEMORAINBOWMAP)          (QUITP (OR WAIT 15))          (until (QUITP NIL) do (ROTATECOLORMAP CM 0 MAXCOLOR))          (QUITP (OR WAIT 5))                                (* pause for optical illusion of movement back into the 							     screen.)          (until (QUITP NIL) do)          (EXMINESHAFT NIL (OR SPEED 6))          (QUITP (OR WAIT 15))          (until (QUITP NIL) do (ROTATECOLORMAP CM 0 MAXCOLOR])(CIRCLEDEMO  [LAMBDA (WAIT)                                             (* rrb "15-OCT-82 10:43")                                                             (* draws cirles and rotates through the colormap.)    (PROG [(PAUSETIME (COND			((EQ (MAXIMUMCOLOR)			     255)			  25)			(T 50]          (SCREENCOLORMAP DEMORAINBOWMAP)          (RAINING 1)          (QUITP (OR WAIT 15))          (until (QUITP NIL) do (ROTATECOLORMAP DEMORAINBOWMAP 1 NIL)				(DISMISS PAUSETIME))          (SCREENCOLORMAP DEMORAININGCOLORMAP)          (QUITP (OR WAIT 20))          (until (QUITP NIL) do (ROTATECOLORMAP DEMORAININGCOLORMAP 1 NIL)				(DISMISS PAUSETIME])(WELL  [LAMBDA (N)                                                (* rrb "20-SEP-82 18:44")    (PROG ((DS (DSPCREATE)))          (DSPDESTINATION (COLORSCREENBITMAP)			  DS)          (for I from 1 to (CONSTANT (IQUOTIENT (SQRT (IPLUS (ITIMES COLORSCREENWIDTH 								     COLORSCREENWIDTH)							     (ITIMES COLORSCREENHEIGHT 								     COLORSCREENHEIGHT)))						2))	     by N as COLOR from 1 do (DRAWCIRCLE (CONSTANT (IQUOTIENT COLORSCREENWIDTH 2))						 (CONSTANT (IQUOTIENT COLORSCREENHEIGHT 2))						 I						 (LIST (QUOTE ROUND)						       (ADD1 N)						       COLOR)						 NIL DS]))(RPAQQ COLORDEMOS (LOGODEMO COLORKINETIC OVERPAINTDEMO MODARTDEMO WALKDEMO TUNNELDEMO CIRCLEDEMO 			      VINEDEMO))(RPAQQ \FIRSTAUTODEMO LOGODEMO)(RPAQQ \NEWCOLORDEMO NIL)(RPAQQ STOPDATE NIL)(RPAQQ DEMORAINBOWMAP NIL)(RPAQQ DEMODEFAULTCOLORMAP NIL)(RPAQQ DEMORAININGCOLORMAP NIL)(DECLARE: DOEVAL@COMPILE DONTCOPY(GLOBALVARS COLORDEMOS \FIRSTAUTODEMO \NEWCOLORDEMO STOPDATE DEMORAINBOWMAP DEMODEFAULTCOLORMAP))(* Logo demos)(DEFINEQ(LOGODEMO  [LAMBDA NIL                                                (* edited: "10-SEP-82 17:09")    (RESETFORM (SCREENCOLORMAP (COLORMAPCREATE))	       (PROG ((NBITS (COLORMAPBITS (SCREENCOLORMAP)))		      MAXCOLOR)		     (SETQ MAXCOLOR 7)		     (COLORBACKGROUND 0)		     (COLORLOGO (create POSITION					XCOORD _ 240					YCOORD _ 260))		     [COND		       ((NOT (QUITP 30))			 (do (ROTATECOLORMAP (SCREENCOLORMAP)					     1 MAXCOLOR)			     (DISMISS 100) until (QUITP]		     (COND		       ((AND JLOGO (NOT (QUITP 20)))			 (RESETVARS ((INTERLISP-D/COLORBITMAP JLOGO))				    [COND				      ((NOT JLOGO)					(PROGN (COND						 ((NOT BIGJFONTS)						   (READBIGJFONTS)))					       (SETQ JLOGO						 (INIT/LOGO/COLORBITMAP (QUOTE (イ ン タ- リ ス プ - 										   D]				    (COLORLOGO (create POSITION						       XCOORD _ 240						       YCOORD _ 260))				    (COND				      ((NOT (QUITP 15))					(do (ROTATECOLORMAP (SCREENCOLORMAP)							    1 MAXCOLOR)					    (DISMISS 100) until (QUITP])(COLORLOGO  [LAMBDA (POSITION)                                         (* rrb "21-DEC-82 21:44")                                                             (* draws a logo on the color screen.)    (OR (POSITIONP POSITION)	(SETQ POSITION (create POSITION			       XCOORD _ 250			       YCOORD _ 390)))    (PROG ((XPOS (fetch XCOORD of POSITION))	   (YPOS (fetch YCOORD of POSITION))	   (COLOR 0)	   (BORDERCOLOR 7)	   (FONT (FONTCREATE (QUOTE TIMESROMAND)			     36))	   (WIMAGEWIDTH (FIX (FTIMES CIRCLESIZE .62)))	   (WIMAGEHEIGHT (FIX (FTIMES CIRCLESIZE .5)))	   (NBITS (COLORMAPBITS (SCREENCOLORMAP)))	   (MAXCOLOR 7)	   (COLORSKIP 1))          (for ANGLE from 0 to 270 by ANGLEDELTA do (DRAWACOLORWINDOW (IPLUS XPOS									     (FTIMES CIRCLESIZE										     (COS ANGLE)))								      (IPLUS YPOS									     (FTIMES CIRCLESIZE										     (SIN ANGLE)))								      WIMAGEWIDTH WIMAGEHEIGHT 2								      [COND									((EQ COLOR MAXCOLOR)									  (SETQ COLOR 1))									(T (SETQ COLOR									     (IPLUS COLORSKIP COLOR]								      0))          (BITBLT [COND		    ((AND INTERLISP-D/COLORBITMAP (EQ NBITS (fetch (BITMAP BITMAPBITSPERPIXEL)							       of INTERLISP-D/COLORBITMAP)))		      INTERLISP-D/COLORBITMAP)		    (T (SETQ INTERLISP-D/COLORBITMAP			 (INIT/LOGO/COLORBITMAP (QUOTE (I n t e r l i s p - D))						COLOR MAXCOLOR COLORSKIP]		  0 0 (COLORSCREENBITMAP)		  (IPLUS XPOS WIMAGEWIDTH)		  (IDIFFERENCE YPOS (IPLUS CIRCLESIZE 5)))          (RETURN])(DRAWACOLORWINDOW  [LAMBDA (XPOS YPOS WWIDTH WHEIGHT WBORDER 0COLOR 1COLOR)   (* rrb "21-FEB-82 10:30")    (PROG ((BM (COLORSCREENBITMAP)))          (COLORFILLAREA XPOS YPOS WWIDTH WHEIGHT 1COLOR BM (QUOTE REPLACE))          (COLORFILLAREA (IPLUS XPOS WBORDER)			 (IPLUS YPOS WBORDER)			 (IDIFFERENCE WWIDTH (ITIMES WBORDER 2))			 (IDIFFERENCE WHEIGHT (ITIMES WBORDER 3))			 0COLOR BM (QUOTE REPLACE))          (RETURN BM])(INIT/LOGO/COLORBITMAP  [LAMBDA (CHARS STARTCOLOR# MAXCOLOR COLORSKIP)             (* rrb "21-DEC-82 21:46")    (PROG ([CHARLST (OR CHARS (QUOTE (I n t e r l i s p - D]	   (FONT (FONTCREATE (QUOTE TIMESROMAND)			     36))	   (COLOR (COND		    (STARTCOLOR# (COLORNUMBERP STARTCOLOR#))		    (T 1)))	   (XPOS 0)	   COLORBM)          (SETQ COLORBM (BITMAPCREATE (for X in CHARLST sum (STRINGWIDTH X FONT))				      (FONTPROP FONT (QUOTE HEIGHT))				      (COLORNUMBERBITSPERPIXEL)))          (for C in CHARLST do (SETQ XPOS (COLORPRINTCHAR C XPOS 0 0 [SETQ COLOR							    (COND							      ((EQ COLOR MAXCOLOR)								1)							      (T (IPLUS COLOR COLORSKIP]							  FONT COLORBM)))          (RETURN COLORBM])(COLORPRINTCHAR  [LAMBDA (LET XPOS YPOS 0COLOR 1COLOR FONT TARGETBM)        (* rrb "12-OCT-83 14:09")                                                             (* prints a character on a color bitmap)    (COND      ((EQ (NCHARS LET)	   1)	(BITBLT (COLORIZEBITMAP (GETCHARBITMAP (CHCON1 LET)					       FONT)				0COLOR 1COLOR (BITSPERPIXEL TARGETBM))		0 0 TARGETBM XPOS YPOS NIL NIL NIL (QUOTE REPLACE))	(IPLUS XPOS (STRINGWIDTH LET FONT)))      (T (PROG ([DSP (COND		       ((TYPENAMEP COLORPRINTCHARDS (QUOTE DISPLAYSTREAM))			 COLORPRINTCHARDS)		       (T (SETQ COLORPRINTCHARDS (DSPCREATE]		(W (STRINGWIDTH LET FONT))		(H (FONTPROP FONT (QUOTE HEIGHT)))		TEMPBM)	       (SETQ TEMPBM (BITMAPCREATE (IPLUS 16 W)					  H))	       (DSPFONT FONT DSP)	       (DSPDESTINATION TEMPBM DSP)	       (DSPCLIPPINGREGION (create REGION					  LEFT _ 0					  BOTTOM _ 0					  WIDTH _ W					  HEIGHT _ H))	       (MOVETO 0 (FONTPROP FONT (QUOTE DESCENT))		       DSP)	       (PRIN3 LET DSP)	       (COLORBLT (COLORIZEBITMAP TEMPBM 0COLOR 1COLOR (BITSPERPIXEL TARGETBM))			 0 0 TARGETBM XPOS YPOS NIL NIL NIL (QUOTE REPLACE))	       (RETURN (IPLUS XPOS (DSPXPOSITION NIL DSP]))(RPAQQ ANGLEDELTA 23)(RPAQQ CIRCLESIZE 60)(RPAQQ LOGOCYCLEWAITTIME 60)(RPAQQ JLOGO NIL)(RPAQQ WINDOWIMAGE NIL)(RPAQQ INTERLISP-D/COLORBITMAP NIL)(DECLARE: DOEVAL@COMPILE DONTCOPY(GLOBALVARS INTERLISP-D/COLORBITMAP))(* Kinetic demos)(DEFINEQ(COLORKINETIC  [LAMBDA (REGION FIRSTCOLOR LASTCOLOR)                      (* rrb "13-SEP-82 10:06")                                                             (* test example (COLORKINETIC))    (RESETLST (RESETSAVE (COLORDISPLAY T))	      (OR (REGIONP REGION)		  (SETQ REGION WHOLECOLORDISPLAY))	      (SETQ FIRSTCOLOR (COLORNUMBERP (OR FIRSTCOLOR 0)))	      [SETQ LASTCOLOR (COLORNUMBERP (OR LASTCOLOR (MAXIMUMCOLOR]	      [COND		((IGREATERP FIRSTCOLOR LASTCOLOR)		  (SETQ LASTCOLOR (PROG1 FIRSTCOLOR (SETQ FIRSTCOLOR LASTCOLOR]	      (PROG ((LEFT (fetch LEFT of REGION))		     (RIGHT (fetch RIGHT of REGION))		     (BOTTOM (fetch BOTTOM of REGION))		     (TOP (fetch TOP of REGION))		     X Y (COLOR# FIRSTCOLOR))		BLTLP		    (SETQ X (RAND LEFT RIGHT))		    (SETQ Y (RAND BOTTOM TOP))		    (COLORFILLAREA X Y (RAND 2 (IDIFFERENCE RIGHT X))				   (RAND 2 (IDIFFERENCE TOP Y))				   [COND				     ((EQ COLOR# LASTCOLOR)				       (SETQ COLOR# FIRSTCOLOR))				     (T (SETQ COLOR# (ADD1 COLOR#]				   (COLORSCREENBITMAP)				   (SELECTQ (RAND 0 5)					    (0 (QUOTE PAINT))					    (1 (QUOTE ERASE))					    (2 (QUOTE INVERT))					    (QUOTE REPLACE)))		    (\BACKGROUND)		    (AND (QUITP)			 (RETURN))		    (GO BLTLP])(DEMOCOLORKINETIC  [LAMBDA (REGION FIRSTCOLOR LASTCOLOR)                      (* rrb "21-OCT-82 18:17")                                                             (* test example (DEMOCOLORKINETIC))    (OR (COLORDISPLAYP)	(COLORDISPLAY T))    (OR (REGIONP REGION)	(SETQ REGION WHOLECOLORDISPLAY))    (OR (COLORNUMBERP FIRSTCOLOR)	(SETQ FIRSTCOLOR 0))    (OR (COLORNUMBERP LASTCOLOR)	(SETQ LASTCOLOR 15))    [COND      ((IGREATERP FIRSTCOLOR LASTCOLOR)	(SETQ LASTCOLOR (PROG1 FIRSTCOLOR (SETQ FIRSTCOLOR LASTCOLOR]    (PROG ((LEFT (fetch LEFT of REGION))	   (RIGHT (fetch RIGHT of REGION))	   (BOTTOM (fetch BOTTOM of REGION))	   (TOP (fetch TOP of REGION))	   X Y (COLOR# FIRSTCOLOR)	   (ROTATETIME (CLOCK 0))	   (KINROTATETIME (CLOCK 0))	   HALFWIDTH HALFHEIGHT)          (SETQ HALFWIDTH (IQUOTIENT (fetch (REGION WIDTH) of REGION)				     2))          (SETQ HALFHEIGHT (IQUOTIENT (fetch (REGION HEIGHT) of REGION)				      2))          (COLORFILL REGION FIRSTCOLOR (COLORSCREENBITMAP))      BLTLP          [COND	    ((IGREATERP (CLOCKDIFFERENCE ROTATETIME)			LOGOCYCLEWAITTIME)                   (* cycle the colors in the logo)	      (ROTATECOLORMAP (SCREENCOLORMAP)			      1 7)	      (SETQ ROTATETIME (CLOCK0 ROTATETIME]          [COND	    ((IGREATERP (CLOCKDIFFERENCE KINROTATETIME)			KINCYCLEWAITTIME)                    (* cycle the colors in the logo)	      (ROTATECOLORMAP (SCREENCOLORMAP)			      FIRSTCOLOR LASTCOLOR)	      (SETQ KINROTATETIME (CLOCK0 KINROTATETIME]          (SETQ X (RAND LEFT RIGHT))          (SETQ Y (RAND BOTTOM TOP))          (COLORFILLAREA X Y (RAND 2 (IMIN (IDIFFERENCE RIGHT X)					   HALFWIDTH))			 (RAND 2 (IMIN (IDIFFERENCE TOP Y)				       HALFHEIGHT))			 [COND			   ((EQ COLOR# LASTCOLOR)			     (SETQ COLOR# FIRSTCOLOR))			   (T (SETQ COLOR# (ADD1 COLOR#]			 (COLORSCREENBITMAP)			 (QUOTE REPLACE))      MOUSELP          (COND	    ((MOUSESTATE MIDDLE)	      (SELECTQ [CAR (ERSETQ (MENU (PROGN (COND						   ((NOT (TYPENAMEP COLORKINETICCOMMANDMENU								    (QUOTE MENU)))						     (INIT/COLORDEMO/MENUS)))						 COLORKINETICCOMMANDMENU]		       (EditColorMap (EDITCOLORMAP (SCREENCOLORMAP)						   T))		       [IncreaseLogoSpeed (SETQ LOGOCYCLEWAITTIME (FIX (FTIMES LOGOCYCLEWAITTIME .8]		       [DecreaseLogoSpeed (SETQ LOGOCYCLEWAITTIME (FIX (FTIMES LOGOCYCLEWAITTIME 1.3]		       [IncreaseColorFlip (SETQ KINCYCLEWAITTIME (FIX (FTIMES KINCYCLEWAITTIME .8]		       [DecreaseColorFlip (SETQ KINCYCLEWAITTIME (FIX (FTIMES KINCYCLEWAITTIME 1.3]		       (STOP (RETURN))		       NIL))	    ((MOUSESTATE LEFT)                               (* on left rotate colormap)	      (ROTATECOLORMAP (SCREENCOLORMAP)			      FIRSTCOLOR LASTCOLOR)	      [COND		((IGREATERP (CLOCKDIFFERENCE ROTATETIME)			    LOGOCYCLEWAITTIME)               (* cycle the colors in the logo)		  (ROTATECOLORMAP (SCREENCOLORMAP)				  1 7)		  (SETQ ROTATETIME (CLOCK0 ROTATETIME]	      [COND		((IGREATERP (CLOCKDIFFERENCE KINROTATETIME)			    KINCYCLEWAITTIME)                (* cycle the colors in the logo)		  (ROTATECOLORMAP (SCREENCOLORMAP)				  FIRSTCOLOR LASTCOLOR)		  (SETQ KINROTATETIME (CLOCK0 KINROTATETIME]	      (DISMISS (IMIN KINETICWAITTIME LOGOCYCLEWAITTIME))	      (GO MOUSELP)))          (GO BLTLP])(CIRKIN  [LAMBDA (DS)                                               (* rrb "10-DEC-82 12:41")    (PROG (LEFT RIGHT TOP BOTTOM MAXRAD (MAXCOLOR (MAXIMUMCOLOR)))          (COND	    ((NOT (type? DISPLAYSTREAM DS))	      (SETQ DS (DSPCREATE (COLORSCREENBITMAP)))	      (DSPCLIPPINGREGION WHOLECOLORDISPLAY DS)))          [SETQ LEFT (fetch (REGION LEFT) of (SETQ MAXRAD (DSPCLIPPINGREGION NIL DS]          (SETQ RIGHT (fetch (REGION RIGHT) of MAXRAD))          (SETQ BOTTOM (fetch (REGION BOTTOM) of MAXRAD))          (SETQ TOP (fetch (REGION TOP) of MAXRAD))          (SETQ MAXRAD (IQUOTIENT (IMIN (fetch (REGION WIDTH) of MAXRAD)					(fetch (REGION HEIGHT) of MAXRAD))				  3))      LP  (for I from 1 to 4 do (FILLCIRCLE (RAND LEFT RIGHT)					    (RAND BOTTOM TOP)					    (RAND 0 MAXRAD)					    (RAND 0 MAXCOLOR)					    DS))          (DSPOPERATION (SELECTQ (RAND 0 3)				 (0 (QUOTE REPLACE))				 (1 (QUOTE PAINT))				 (2 (QUOTE INVERT))				 (QUOTE ERASE))			DS)          (GO LP]))(RPAQQ KINETICWAITTIME 150)(DECLARE: DOEVAL@COMPILE DONTCOPY(GLOBALVARS KINETICWAITTIME))(DEFINEQ(COLORDEMO1  [LAMBDA NIL                                                (* bas: "25-APR-82 23:48")    (PROG ((RAINBOWCOLORMAP (COLORMAPCREATE RAINBOWINTENSITIES))	   (KINREGION (create REGION			      LEFT _ 20			      BOTTOM _ 20			      WIDTH _ 600			      HEIGHT _ 300)))                (* turn on display to allocate screen bitmap.)          (RESETFORM (COLORDISPLAY T)		     (RESETFORM (SCREENCOLORMAP RAINBOWCOLORMAP)				(COLORBACKGROUND (QUOTE BLACK))				(COLORLOGO (create POSITION						   XCOORD _ 250						   YCOORD _ 390))				(until (MOUSESTATE (NOT UP)) do (ROTATECOLORMAP RAINBOWCOLORMAP 1 7)								(DISMISS LOGOCYCLEWAITTIME))				(DEMOCOLORKINETIC KINREGION 8 14))		     (COLORBACKGROUND (QUOTE WHITE])(COLORDEMO2  [LAMBDA (SIZE)                                             (* bas: "25-APR-82 23:46")    (DECLARE (GLOBALVARS \MOUSEHOTSPOTY COLORDEMO2MENU KINETICWAITTIME))                                                             (* flashy color demo)    (RESETFORM (COLORDISPLAY T)	       [RESETFORM (SCREENCOLORMAP)			  (SHOWCOLORTESTPATTERN SIZE)			  (\SETCURSORPOSITION LASTMOUSEX (LLSH KINETICWAITTIME 2))                                                             (* move cursor to start cycle at kinetic cycle time.)			  (bind COLOR			     do (ROTATECOLORMAP (SCREENCOLORMAP))				(COND				  [(MOUSESTATE MIDDLE)				    (SELECTQ (SETQ COLOR (MENU (PROGN (COND									((NOT (TYPENAMEP										COLORDEMO2MENU										(QUOTE MENU)))									  (INIT/COLORDEMO/MENUS)))								      COLORDEMO2MENU)))					     (STOP (RETURN))					     (EDITCOLORMAP (SCREENCOLORMAP (EDITCOLORMAP									     (COLORMAPCOPY (SCREENCOLORMAP))									     T)))					     (NIL NIL)					     (DEFAULT (SCREENCOLORMAP T))					     (SCREENCOLORMAP					       (MAPOFACOLOR (SELECTQ COLOR								     (RED (QUOTE (RED)))								     (BLUE (QUOTE (BLUE)))								     (GREEN (QUOTE (GREEN)))								     (PURPLE (QUOTE (RED BLUE)))								     (BLUEGREEN (QUOTE (BLUE GREEN)))								     (GREY (QUOTE (RED BLUE GREEN)))								     (YELLOW (QUOTE (RED GREEN)))								     (SHOULDNT]				  (T (DISMISS (LRSH (IDIFFERENCE LASTMOUSEY \MOUSEHOTSPOTY)						    2]	       (COLORBACKGROUND (QUOTE WHITE])(INIT/COLORDEMO/MENUS  [LAMBDA NIL                                                (* rrb "10-MAR-82 16:32")                                                             (* create all of the menus used by colordemos.)                                                             (* fetching image width forces the image to be created.)    (fetch (MENU IMAGEWIDTH) of (SETQ COLORDEMO2MENU (create MENU							     ITEMS _(QUOTE ((STOP (QUOTE STOP)										  									"Stops this demonstration.")									     (EditColors									       (QUOTE EDITCOLORMAP)									       								      "Calls the color map editor.")									     (Default (QUOTE DEFAULT)										      							 "Sets the color map to the system default")									     (Red (QUOTE RED)										  									"Switch to a RED color map")									     (Green (QUOTE GREEN)										    								      "Switch to a GREEN color map")									     (Blue (QUOTE BLUE)										   								       "Switch to a BLUE color map")									     (Yellow (QUOTE YELLOW)										     								     "Switch to a YELLOW color map")									     (Purple (QUOTE PURPLE)										     								     "Switch to a VIOLET color map")									     (Grey (QUOTE GREY)										   								       "Switch to a GREY color map")									     (BlueGreen (QUOTE 											BLUEGREEN)															       "Switch to a color map that is a mixture of BLUE and GREEN.")))							     CENTERFLG _ T							     CHANGEOFFSETFLG _ T)))    (fetch (MENU IMAGEWIDTH) of (SETQ COLORKINETICCOMMANDMENU (create MENU								      ITEMS _(QUOTE									((STOP (QUOTE STOP)									       									  "Stops the demonstration")									  (EditColorMap (QUOTE 										     EditColorMap)																			       "Edits the screen color map")									  (IncreaseLogoSpeed									    (QUOTE IncreaseLogoSpeed)									    						    "Speeds up the cycling of colors thru the logo")									  (DecreaseLogoSpeed									    (QUOTE DecreaseLogoSpeed)									    						   "Slows down the cycling of colors thru the logo")									  (IncreaseColorFlip									    (QUOTE IncreaseColorFlip)									    			       "Increases the frequency of color map changes in the Kinetic region"									    NXP)									  (DecreaseColorFlip									    (QUOTE DecreaseColorFlip)									    				  "Reduces the frequency of colormap changes in the Kinetic region")))								      CHANGEOFFSETFLG _ T								      CENTERFLG _ T]))(RPAQQ KINCYCLEWAITTIME 5114)(RPAQQ COLORKINETICCOMMANDMENU NIL)(RPAQQ COLORPRINTCHARDS NIL)(RPAQQ COLORDEMO2MENU NIL)(RPAQQ RAINBOWINTENSITIES ((178 0 0)			     (255 0 0)			     (255 128 0)			     (255 255 0)			     (128 255 0)			     (0 255 0)			     (0 255 128)			     (0 255 255)			     (0 128 255)			     (0 0 255)			     (128 0 255)			     (255 0 255)			     (255 128 255)			     (255 255 255)			     (128 128 128)			     (0 0 0)))(* Simple demos)(DEFINEQ(REDGREEN  [LAMBDA NIL                                                (* rrb " 2-JUL-82 18:26")    (RESETFORM (COLORDISPLAY T)	       (RESETFORM (SCREENCOLORMAP (MAPOFACOLOR (QUOTE RED)))			  (SHOWCOLORTESTPATTERN)			  (BIND (NCOLORMASK _(COND					      ((EQ \COLORDISPLAYBITSPERPIXEL 4)						15)					      (T 255)))			     for L from 0 do [COLORLEVEL (SCREENCOLORMAP)							 (LOGAND L NCOLORMASK)							 (COND							   ((ZEROP (LOGAND L 256))							     (QUOTE GREEN))							   (T (QUOTE RED)))							 (COND							   ((ZEROP (LOGAND L 512))							     (LOGAND 255 L))							   (T (IDIFFERENCE 255 (LOGAND 255 L]					     (ROTATECOLORMAP (SCREENCOLORMAP))					     (DISMISS 25)			     until (QUITP)))	       (COLORBACKGROUND (QUOTE WHITE]))(* Overpaint demos)(DEFINEQ(OVERPAINTDEMO  [LAMBDA NIL                                                (* rrb "15-OCT-82 10:36")    (DECLARE (GLOBALVARS STOPDATE))    (RESETLST [RESETSAVE NIL (LIST (QUOTE CLOSEW)				   (ADDMENU (create MENU						    ITEMS _(QUOTE (RANDOM LINE CURSOR NONE))						    WHENSELECTEDFN _(QUOTE OVERPAINTSELFN]	      (SETQ MOVEMODE (QUOTE RANDOM))	      [SETQ LASTX (SETQ LASTY (SETQ DX (SETQ DY (SETQ NSTEPS 0]	      (for I in [COND			  (OVERPAINTBITMAPS)			  (T (SETQ OVERPAINTBITMAPS (LIST (BITMAPFROMSTRING "Interlisp-D"]		 until (OR (QUITP 20)			   (EQ MOVEMODE (QUOTE NONE)))		 do (OVERPAINTBM I))	      (SCREENCOLORMAP DEMORAINBOWMAP)	      (QUITP 10)	      (until (QUITP) do (ROTATECOLORMAP (SCREENCOLORMAP)						1)				(DISMISS 40])(OVERPAINTBM  [LAMBDA (BM FONT)                                          (* rrb "21-DEC-82 22:16")    (PROG (EBM BMW BMH SCR (MAXCOLOR (MAXIMUMCOLOR))	       (COLORSCREENBITMAP (COLORSCREENBITMAP)))          (SETQ EBM (CACHEBITMAP BM FONT (COLORNUMBERBITSPERPIXEL)))          (SETQ BMW (BITMAPWIDTH BM))          (SETQ BMH (fetch BITMAPHEIGHT of EBM))          (SETQ SCR (BITMAPCOPY EBM))          (COLORBACKGROUND 0)          (until (QUITP)	     do (AND (EQ 51 (RAND 0 300))		     (COLORBACKGROUND 0))		(OVERPAINT EBM COLORSCREENBITMAP (NEWX BMW COLORSCREENWIDTH)			   (NEWY BMH COLORSCREENHEIGHT)			   (COLORTEXTUREFROMCOLOR# (RAND 1 MAXCOLOR))			   SCR])(OVERPAINTSELFN  [LAMBDA (V)                                                (* bas: "26-APR-82 18:07")    (SETQ MOVEMODE V])(CACHEBITMAP  [LAMBDA (BM FONT NBITS)                                    (* rrb "21-DEC-82 22:24")    (PROG ((BMEXP (COND		    ((EQ NBITS 8)		      8BITBMEXP)		    (T 4BITBMEXP)))	   CBM)          [COND	    ((BITMAPP BM))	    (T (SETQ BM (OR (GETHASH BM BMEXP)			    (PUTHASH BM (BITMAPFROMSTRING BM FONT)				     BMEXP]          (RETURN (OR (GETHASH BM BMEXP)		      (PUTHASH BM (PROG1 (SETQ CBM (EXPANDBITMAP BM (OR NBITS 4)))					 (replace (BITMAP BITMAPBITSPERPIXEL) of CBM					    with (OR NBITS 4)))			       BMEXP])(NEWX  [LAMBDA (BW SW)                                            (* rrb "13-SEP-82 11:42")    (SELECTQ MOVEMODE	     (RANDOM (RAND (IMINUS BW)			   SW))	     (CURSOR (IMIN (IDIFFERENCE LASTMOUSEX (IQUOTIENT BW 2))			   SW))	     (LINE [COND		     ((ILEQ (SETQ NSTEPS (SUB1 NSTEPS))			    0)		       (SETQ NSTEPS (RAND 0 50))		       (COND			 ((IGEQ (RAND 0 4)				2)			   (SETQ DX (RAND -10 10)))			 (T (SETQ DY (RAND -10 10]		   (COND		     ((ILESSP (SETQ LASTX (IPLUS LASTX DX))			      0)		       (SETQ LASTX (IMINUS LASTX))		       (SETQ DX (IMINUS DX)))		     [(IGEQ LASTX (IDIFFERENCE SW BW))		       (SETQ LASTX (IPLUS LASTX (SETQ DX (IMINUS DX]		     (T LASTX)))	     (NONE 0)	     (SHOULDNT])(NEWY  [LAMBDA (BH SH)                                            (* rrb "13-SEP-82 11:42")    (SELECTQ MOVEMODE	     (RANDOM (RAND (IMINUS BH)			   SH))	     (CURSOR (IDIFFERENCE LASTMOUSEY (IQUOTIENT BH 2)))	     (LINE [COND		     ((ILEQ (SETQ NSTEPS (SUB1 NSTEPS))			    0)		       (SETQ NSTEPS (RAND 0 50))		       (COND			 ((IGEQ (RAND 0 4)				2)			   (SETQ DX (RAND -10 10)))			 (T (SETQ DY (RAND -10 10]		   (COND		     ((ILESSP (SETQ LASTY (IPLUS LASTY DY))			      0)		       (SETQ LASTY (IMINUS LASTY))		       (SETQ DY (IMINUS DY)))		     [(IGEQ LASTY (IDIFFERENCE SH BH))		       (SETQ LASTY (IPLUS LASTY (SETQ DY (IMINUS DY]		     (T LASTY)))	     (NONE 0)	     (SHOULDNT]))(RPAQQ OVERPAINTBITMAPS NIL)(* Walk demos)(DEFINEQ(WALKDEMO  [LAMBDA (WAIT SPEED WORD1 WORDS)                           (* rrb "13-SEP-82 10:49")    (DECLARE (GLOBALVARS STOPDATE))    (RESETFORM (SCREENCOLORMAP NIL)	       (COLORBACKGROUND 0)	       (for I in [COND			   (OVERPAINTBITMAPS)			   (T (SETQ OVERPAINTBITMAPS (LIST (BITMAPFROMSTRING "Interlisp-D"]		  until (QUITP (OR WAIT 10)) do (WALKBM I NIL SPEED)						(OR (QUITP 10)						    (WALKBM NIL NIL SPEED])(WALKBM  [LAMBDA (BM FONT SPEED)                                    (* rrb "21-DEC-82 22:29")    (OR SPEED (SETQ SPEED 5))    (PROG (EBM SCR MAXX MAXY (MAXCOLOR (MAXIMUMCOLOR)))          (SETQ EBM (CACHEBITMAP BM FONT (COLORNUMBERBITSPERPIXEL)))          (SETQ SCR (BITMAPCOPY EBM))          (SETQ MAXX (IDIFFERENCE COLORSCREENWIDTH (BITMAPWIDTH EBM)))          (SETQ MAXY (IDIFFERENCE COLORSCREENHEIGHT (fetch BITMAPHEIGHT of EBM)))          (SCREENCOLORMAP (RANDCOLORMAP))          (bind (X _ -1)		(Y _ -1)		(DX _ 0)		(DY _ 0)		(I _ 1)		(J _ 0)		(COLORCOUNTER _ 0) until (QUITP)	     do [COND		  ((EQ I MAXCOLOR)		    (SETQ I 1))		  (T (SETQ I (ADD1 I]		(add X DX)		(add Y DY)		[COND		  ((OR (ILEQ J 0)		       (ILESSP X 0)		       (IGEQ X MAXX)		       (ILESSP Y 0)		       (IGEQ Y MAXY))		    (SETQ X (RAND 0 MAXX))		    (SETQ Y (RAND 0 MAXY))		    (SETQ DX (RAND (IMINUS SPEED)				   SPEED))		    (SETQ DY (RAND (IMINUS SPEED)				   SPEED))		    (SETQ J (RAND MINWALK MAXWALK)))		  (T (SETQ J (SUB1 J]		(OVERPAINT EBM (COLORSCREENBITMAP)			   X Y (COLORTEXTUREFROMCOLOR# I)			   SCR)		(COND		  ((IGREATERP (SETQ COLORCOUNTER (ADD1 COLORCOUNTER))			      300)		    (SETQ COLORCOUNTER 0)		    (SCREENCOLORMAP (RANDCOLORMAP)))		  (T (ROTATECOLORMAP (SCREENCOLORMAP)				     1 MAXCOLOR)))		(DISMISS 15])(RANDCOLORMAP  [LAMBDA NIL                                                (* edited: "10-SEP-82 14:58")    (PROG [(MAXCOLOR (SUB1 (EXPT 2 (COLORMAPBITS (SCREENCOLORMAP]          (RETURN (SELECTQ (RAND 1 2)			   [1 (COND				((COLORMAPP WALKRANDOMCOLORMAP)				  WALKRANDOMCOLORMAP)				(T (SETQ WALKRANDOMCOLORMAP (COLORMAPCREATE))				   (for CN from 0 to MAXCOLOR do (COLORLEVEL WALKRANDOMCOLORMAP CN									     (QUOTE RED)									     (RAND 0 255))								 (COLORLEVEL WALKRANDOMCOLORMAP CN									     (QUOTE GREEN)									     (RAND 0 255))								 (COLORLEVEL WALKRANDOMCOLORMAP CN									     (QUOTE BLUE)									     (RAND 0 255]			   (2 (COND				((COLORMAPP WALKRAINBOWCOLORMAP)				  WALKRAINBOWCOLORMAP)				(T [SETQ WALKRAINBOWCOLORMAP (RAINBOWMAP (COLORMAPBITS (SCREENCOLORMAP											 ]                                                             (* make every 16th color random)				   (for CN from (RAND 0 15) to MAXCOLOR by 16				      do (COLORLEVEL WALKRAINBOWCOLORMAP CN (QUOTE RED)						     (RAND 0 255))					 (COLORLEVEL WALKRAINBOWCOLORMAP CN (QUOTE GREEN)						     (RAND 0 255))					 (COLORLEVEL WALKRAINBOWCOLORMAP CN (QUOTE BLUE)						     (RAND 0 255)))				   WALKRAINBOWCOLORMAP)))			   (PROG [(CM (MAPOFACOLOR (CAR (NTH (QUOTE ((RED GREEN)								      RED								      (BLUE GREEN)								      (BLUE RED)								      GREEN								      (RED GREEN BLUE)))							     (RAND 1 6]                                                             (* make every 16th color random)			         (for CN from (RAND 0 15) to MAXCOLOR by 16				    do (COLORLEVEL CM CN (QUOTE RED)						   (RAND 0 255))				       (COLORLEVEL CM CN (QUOTE GREEN)						   (RAND 0 255))				       (COLORLEVEL CM CN (QUOTE BLUE)						   (RAND 0 255)))			         (RETURN CM]))(RPAQ? MAXWALK NIL)(RPAQ? MINWALK NIL)(RPAQ? RANDCOLORPROB NIL)(RPAQ? WALKRANDOMCOLORMAP )(RPAQ? 8BITBMEXP (LIST (HARRAY 60)))(RPAQ? 4BITBMEXP (LIST (HARRAY 60)))(DECLARE: DOEVAL@COMPILE DONTCOPY(GLOBALVARS 8BITBMEXP 4BITBMEXP WALKRANDOMCOLORMAP))(* Vines demo)(DEFINEQ(VINEDEMO  (LAMBDA (WAIT)                                             (* kbr: " 8-Dec-85 15:07")    (PROG (X1 Y1 DX DY X2 Y2 COLOR MAXCOLOR WIDTH MAXWIDTH DS)	    (SCREENCOLORMAP DEMORAINBOWMAP)	    (SETQ X1 (IQUOTIENT COLORSCREENWIDTH 2))	    (SETQ Y1 (IQUOTIENT COLORSCREENHEIGHT 2))	    (SETQ MAXCOLOR (MAXIMUMCOLOR))	    (SETQ COLOR (IQUOTIENT MAXCOLOR 2))	    (SETQ MAXWIDTH 200)	    (SETQ WIDTH 10)	    (SETQ DX (RAND -100 100))	    (SETQ DY (RAND -100 100))	    (SETCOLORINTENSITY (SCREENCOLORMAP)				 MAXCOLOR				 (LIST (RAND 0 255)					 (RAND 0 255)					 (RAND 0 255)))	    (BITBLT NIL NIL NIL (COLORSCREENBITMAP)		      NIL NIL NIL NIL (QUOTE TEXTURE)		      (QUOTE REPLACE)		      MAXCOLOR)	    (SETQ DS (DSPCREATE (COLORSCREENBITMAP)))	    (QUITP (OR WAIT 120))	    (until (QUITP NIL)	       do (SETQ DX (INRANGE -100 100 (IPLUS DX (RAND -10 10))))		    (SETQ DY (INRANGE -100 100 (IPLUS DY (RAND -10 10))))		    (SETQ X2 (INRANGE 0 COLORSCREENWIDTH (IPLUS X1 DX)))		    (COND		      ((OR (EQ X2 0)			     (EQ X2 COLORSCREENWIDTH))			(SETQ DX (IMINUS DX))))		    (SETQ Y2 (INRANGE 0 COLORSCREENHEIGHT (IPLUS Y1 DY)))		    (COND		      ((OR (EQ Y2 0)			     (EQ Y2 COLORSCREENHEIGHT))			(SETQ DY (IMINUS DY))))		    (SETQ WIDTH		      (INRANGE 1 MAXWIDTH				 (IPLUS WIDTH					  (ITIMES (CAR (NTH (QUOTE (-1 0 0 0 0 0 0 1))								  (RAND 1 8)))						    (ADD1 (IQUOTIENT WIDTH 3))))))		    (SETQ COLOR		      (IMOD (IPLUS COLOR				       (CAR (NTH (QUOTE (-1 0 0 0 0 0 0 1))						     (RAND 1 8))))			      (SUB1 MAXCOLOR)))		    (DRAWLINE X1 Y1 X2 Y2 WIDTH (QUOTE REPLACE)				DS COLOR)		    (SETQ X1 X2)		    (SETQ Y1 Y2)		    (SETCOLORINTENSITY (SCREENCOLORMAP)					 (RAND 0 (SUB1 MAXCOLOR))					 (LIST (RAND 0 255)						 (RAND 0 255)						 (RAND 0 255)))))))(INRANGE  (LAMBDA (MIN MAX VALUE)                                    (* kbr: " 4-Mar-85 14:12")    (IMAX MIN (IMIN MAX VALUE)))))(FILESLOAD COLOR)(PUTPROPS COLORDEMO COPYRIGHT ("Xerox Corporation" 1982 1983 1985))(DECLARE: DONTCOPY  (FILEMAP (NIL (1982 16699 (COLORDEMO 1992 . 4415) (CHOOSEDEMO 4417 . 4574) (DOCOLORDROP 4576 . 5188) (EXMINESHAFT 5190 . 6425) (MINESHAFT 6427 . 7238) (MODART 7240 . 8162) (MODARTDEMO 8164 . 9894) (POINTTEST 9896 . 10782) (PUTDROPS 10784 . 11256) (QUITP 11258 . 11630) (RAINING 11632 . 12817) (RAININGCOLORMAP 12819 . 13319) (ROTATEIT 13321 . 13728) (SHOWCOLORW 13730 . 14306) (TUNNEL 14308 . 14464) (TUNNELDEMO 14466 . 15343) (CIRCLEDEMO 15345 . 16054) (WELL 16056 . 16697)) (17180 22288 (LOGODEMO 17190 . 18282) (COLORLOGO 18284 . 19871) (DRAWACOLORWINDOW 19873 . 20313) (INIT/LOGO/COLORBITMAP 20315 . 21073) (COLORPRINTCHAR 21075 . 22286)) (22570 28362 (COLORKINETIC 22580 . 23880) (DEMOCOLORKINETIC 23882 . 27278) (CIRKIN 27280 . 28360)) (28462 33317 (COLORDEMO1 28472 . 29241) (COLORDEMO2 29243 . 30790) (INIT/COLORDEMO/MENUS 30792 . 33315)) (33825 34630 (REDGREEN 33835 . 34628)) (34659 38352 (OVERPAINTDEMO 34669 . 35484) (OVERPAINTBM 35486 . 36198) (OVERPAINTSELFN 36200 . 36334) (CACHEBITMAP 36336 . 36894) (NEWX 36896 . 37630) (NEWY 37632 . 38350)) (38410 42189 (WALKDEMO 38420 . 38890) (WALKBM 38892 . 40294) (RANDCOLORMAP 40296 . 42187)) (42500 44859 (VINEDEMO 42510 . 44705) (INRANGE 44707 . 44857)))))STOP