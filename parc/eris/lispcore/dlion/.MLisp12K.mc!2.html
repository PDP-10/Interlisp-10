<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
    <title>File [eris]&lt;LispCore>dlion>MLisp12K.mc!2</title>
  </head>
  <body>
    <pre>
{mlisp12k.mccreated by cal:   5-Nov-84 15:59:32}{*****************************************************************************	BITBLT*****************************************************************************}@BBLT:	opcode[166'b],	Bank &larr; 2,	c1;	,	c2;	CROSS[BBEntry],	c3;	PC &larr; PC + PC16{***1}, GOTO[IBDispOnly]	,c1, at[BBExit];IBDispOnly:	IBDisp, L2 &larr; L2.0,	c2;	TOSH &larr; smallpl, L2 &larr; L2.0, DISPNI[OpTable],	c3;{*****************************************************************************	MISC	Input*****************************************************************************}@MISC1:	opcode[170'b],	L2 &larr; L2.0, GOTO[Misc],	c1;@MISC2:	opcode[171'b],	L2 &larr; L2.0,	c1;Misc:	PC &larr; PC + 1, Xbus &larr; ib, XDisp,	c2;	uTOS &larr; TOS, YDisp, DISP4[MiscDisp, 0C],	c3;Misc0:	Q &larr; 121'd, CANCELBR[sink2, 0F],	c1, at[0C,10, MiscDisp];{MP9121}Misc3:	Q &larr; 121'd, CANCELBR[sink2, 0F],	c1, at[0F,10, MiscDisp];{MP9121}{*****************************************************************************	INPUT	Input*****************************************************************************}INPUT:	TOSH &larr; smallpl, DISP4[MiscIn],	c1, at[0D,10, MiscDisp];	TOS &larr; EIData, IBDisp, L2 &larr; L2.0, GOTO[MiscInEnd],	c2, at[0,10,MiscIn];	TOS &larr; EStatus, IBDisp, L2 &larr; L2.0, GOTO[MiscInEnd],	c2, at[1,10,MiscIn];	TOS &larr; KIData, IBDisp, L2 &larr; L2.0, GOTO[MiscInEnd],	c2, at[2,10,MiscIn];	TOS &larr; KStatus, IBDisp, L2 &larr; L2.0, GOTO[MiscInEnd],	c2, at[3,10,MiscIn];	TOS &larr; uSTATE, IBDisp, L2 &larr; L2.0, GOTO[MiscInEnd],	c2, at[4,10,MiscIn];	TOS &larr; MStatus, IBDisp, L2 &larr; L2.0, GOTO[MiscInEnd],	c2, at[5,10,MiscIn];	TOS &larr; KTest, IBDisp, L2 &larr; L2.0, GOTO[MiscInEnd],	c2, at[6,10,MiscIn];	{TOS &larr; PPort}Q &larr; 122'd, GOTO[sink3],	c2, at[7,10,MiscIn];	TOS &larr; VersionHi, GOTO[MiscVers],	c2, at[8,10,MiscIn];	{**}{Q &larr; 122'd, GOTO[sink3],	c2, at[09,10,MiscIn];}{MP9122}	{Q &larr; 122'd, GOTO[sink3],	c2, at[0A,10,MiscIn];}{MP9122}	TOS &larr; uFLmode, IBDisp, L2 &larr; L2.0, GOTO[MiscInEnd],	c2, at[0B,10,MiscIn];	Q &larr; 122'd, GOTO[sink3],	c2, at[0C,10,MiscIn];{MP9122}	Q &larr; 122'd, GOTO[sink3],	c2, at[0D,10,MiscIn];{MP9122}	Q &larr; 122'd, GOTO[sink3],	c2, at[0E,10,MiscIn];{MP9122}	Q &larr; 122'd, GOTO[sink3],	c2, at[0F,10,MiscIn];{MP9122}MiscInEnd:	TOSH &larr; smallpl, L2 &larr; L2.0, DISPNI[OpTable],	c3;MiscVers:	TOS &larr; TOS LRot8,	c3;	TOS &larr; TOS or VersionLo,	c1;	IBDisp, L2 &larr; L2.0, TOS &larr; TOS or 1, GOTO[MiscInEnd],	c2;{*****************************************************************************	OUTPUT	Output*****************************************************************************}OUTPUT:	MAR &larr; S &larr; [rhS, S + 0], Xbus &larr; uTOS, XDisp, CANCELBR[$, 0F],	c1, at[0E,10, MiscDisp];	S &larr; S - 2, DISP4[MiscOut],	c2;	{**}{IOPOData &larr; MD, GOTO[OutEnd],	c3, at[0,10,MiscOut];}	IOPCtl &larr; MD, GOTO[OutEnd],	c3, at[1,10,MiscOut];	{**}{KOData &larr; MD, GOTO[OutEnd],	c3, at[2,10,MiscOut];}	TT &larr; MD, GOTO[OutSetFPmode],	c3, at[2,10,MiscOut];	KCtl &larr; MD, GOTO[OutEnd],	c3, at[3,10,MiscOut];	EOData &larr; MD, GOTO[OutEnd],	c3, at[4,10,MiscOut];	EICtl &larr; MD, GOTO[OutEnd],	c3, at[5,10,MiscOut];	DCtl &larr; MD, GOTO[OutEnd],	c3, at[6,10,MiscOut];	TT &larr; MD, GOTO[OutSetBBTime],	c3, at[7,10,MiscOut];	TT &larr; MD, GOTO[OutSetOpt],	c3, at[8,10,MiscOut];	PCtl &larr; MD, GOTO[OutEnd],	c3, at[9,10,MiscOut];	TT &larr; MD, GOTO[OutMCtl],	c3, at[0A,10,MiscOut];	{**}{   Q &larr; 120'd, GOTO[sink1],		c3, at[0B,10,MiscOut];}{MP9120}	EOCtl &larr; MD, GOTO[OutEnd],	c3, at[0C,10,MiscOut];	KCmd &larr; MD, GOTO[OutEnd],	c3, at[0D,10,MiscOut];	TT &larr; MD, GOTO[OutPPort],	c3, at[0E,10,MiscOut];	POData &larr; MD, GOTO[OutEnd],	c3, at[0F,10,MiscOut];OutSetFPmode:	uFLmode &larr; TT, GOTO[IB.nop],	c1;OutSetBBTime:	uBBTime &larr; TT, GOTO[IB.nop],	c1;OutEnd:	Noop, GOTO[IB.nop],	c1;OutPPort:	PPort &larr; TT, GOTO[IB.nop],	c1;OutSetOpt:	uLispOptions &larr; TT, GOTO[IB.nop],	c1;OutMCtl:	MCtl &larr; TT, GOTO[IB.nop],	c1;{*******************************************************************	READPRINTERPORT		3 clicks*******************************************************************}@READPRINTERPORT:	opcode[164'b],	MAR &larr; S &larr; [rhS, S + 1],	c1;ReadRet:	MDR &larr; TOSH, S &larr; S + 1, BRANCH[$, ReadCarry, 1],	c2;	Ybus &larr; S xor uStkLimO, ZeroBranch,	c3;	MAR &larr; [rhS, S + 0], BRANCH[$, ReadStkLim],	c1;	MDR &larr; TOS,	c2;	TOSH &larr; smallpl,	c3;	TOS &larr; PPort, GOTO[IB.pc1],	c1;{page cross:}ReadCarry:	S &larr; S + 0FF,	c3;	MAR &larr; [rhS, S + 0], GOTO[ReadRet],	c1;{Stack Limit:}ReadStkLim:	MDR &larr; TOS, 	c2;	TOSH &larr; smallpl,	c3;	TOS &larr; PPort,	c1;	,	c2;	PC &larr; PC + PC16, GOTO[StackOverflow],	c3;{*******************************************************************	WRITEPRINTERPORT		1 click*******************************************************************}@WRITEPRINTERPORT:	opcode[165'b],	PPort &larr; TOS, L2 &larr; L2.0,	c1;	PC &larr; PC + PC16, IBDisp,	c2;	uPPsave &larr; TOS, L2 &larr; L2.0, DISPNI[OpTable],	c3;{*******************************************************************}logout:	TT &larr; 55{password to mesa},	c2;	uLispBootMsg &larr; TT,	c3;	Bank &larr; 0 ,	c1;		{MPL  1-Jan-84 13:20:12 Changed for Domino 10}	TT &larr; 0,	c2;	rhRx &larr; Rx &larr; uIOPage, CROSS[LOGOUT]	c3;Off:	MAR &larr; [rhRx, IOPage.ProcessorCommand+0],	c1, at[LOGOUT];	MDR{4} &larr;  4,	c2;	Noop,  GOTO[Off],	c3;Burdx:	Rx &larr; 41, CANCELBR[$, 0F],	c1;	DCtl &larr; Rx LRot0,	c2;	IOPCtl &larr; 1, GOTO[Reset],	c3;	{ E N D }</pre>
  </body>
</html>
