<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
    <title>File [eris]&lt;LispCore>SOURCES>IMAGEIO!123</title>
  </head>
  <body>
    <pre>
(FILECREATED "16-Sep-86 10:09:30" {ERIS}&lt;LISPCORE&gt;SOURCES&gt;IMAGEIO.;123 72284        changes to:  (FNS \IMAGEIOINIT \GOOD.DASHLST)      previous date: " 9-Sep-86 16:34:30" {ERIS}&lt;LISPCORE&gt;SOURCES&gt;IMAGEIO.;122)(* Copyright (c) 1983, 1984, 1985, 1986 by Xerox Corporation. All rights reserved.)(PRETTYCOMPRINT IMAGEIOCOMS)(RPAQQ IMAGEIOCOMS        [(FNS IMAGESTREAMP IMAGESTREAMTYPE IMAGESTREAMTYPEP OPENIMAGESTREAM \GOOD.DASHLST)        (INITVARS (IMAGESTREAMTYPES NIL))        (FNS DRAWDASHEDLINE)        (FNS DSPBACKCOLOR DSPBOTTOMMARGIN DSPCOLOR DSPCLIPPINGREGION DSPRESET DSPFONT DSPLEFTMARGIN              DSPLINEFEED DSPOPERATION DSPRIGHTMARGIN DSPTOPMARGIN DSPSCALE DSPSPACEFACTOR              DSPXPOSITION DSPYPOSITION DSPROTATE DSPPUSHSTATE DSPPOPSTATE DSPDEFAULTSTATE DSPSCALE2              DSPTRANSLATE)        (FNS DSPNEWPAGE DRAWBETWEEN DRAWCIRCLE DRAWARC DRAWCURVE DRAWELLIPSE DRAWLINE DRAWPOLYGON              FILLPOLYGON DRAWTO FILLCIRCLE MOVETO RELDRAWTO BITMAPIMAGESIZE SCALEDBITBLT)        (FNS \IMAGEIOINIT \NOIMAGE.DSPFONT \UNIMPIMAGEOP)        [COMS (* stuff to support the checking and defaulting of arguments in the device independent                  drawing functions.)              (FNS INSURE.BRUSH BRUSHP \POSSIBLECOLOR)              (DECLARE: DONTCOPY EVAL@COMPILE (RESOURCES SYSTEMBRUSH))              (INITRESOURCES SYSTEMBRUSH)              (FNS DASHINGP INSURE.DASHING)              (DECLARE: DONTCOPY (EXPORT (RECORDS BRUSH)))              (DECLARE: DONTCOPY (CONSTANTS (MICASPERPT (FQUOTIENT 635 18]        (DECLARE: DONTCOPY (EXPORT (MACROS IMAGEOP)                                  (RECORDS IMAGEOPS)                                  (GLOBALVARS \NOIMAGEOPS)))        (INITRECORDS IMAGEOPS)        (SYSRECORDS IMAGEOPS)        (DECLARE: DONTEVAL@LOAD DOCOPY (P (\IMAGEIOINIT)))        [COMS (* Implementation of display stream resident "files." Done here cause it might matter                  that the display device get defined early so that its event fn will be evaluated as                  the last thing before logout)              (INITVARS (\COLORDISPLAYSTREAMTYPES (QUOTE (4DISPLAY 8DISPLAY 24DISPLAY)))                     (\DISPLAYSTREAMTYPES (CONS (QUOTE DISPLAY)                                                \COLORDISPLAYSTREAMTYPES)))              (FNS \DisplayEventFn \DISPLAYINIT \4DISPLAYINIT \8DISPLAYINIT \24DISPLAYINIT                    \DISPLAYSTREAMTYPEBPP)              (ALISTS (IMAGESTREAMTYPES DISPLAY 4DISPLAY 8DISPLAY 24DISPLAY))              (GLOBALVARS DisplayFDEV \4DISPLAYFDEV \8DISPLAYFDEV \24DISPLAYFDEV)              (DECLARE: DONTEVAL@LOAD DOCOPY (P (\DISPLAYINIT)                                                (\4DISPLAYINIT)                                                (\8DISPLAYINIT)                                                (\24DISPLAYINIT]        (DECLARE: DONTEVAL@LOAD DOEVAL@COMPILE DONTCOPY COMPILERVARS (ADDVARS (NLAMA)                                                                            (NLAML)                                                                            (LAMA IMAGESTREAMP])(DEFINEQ(IMAGESTREAMP  (LAMBDA NARGS                                              (* lmm " 7-Jan-86 16:27")    (PROG ((STREAM (AND (IGREATERP NARGS 0)			    (SELECTQ (ARG NARGS 1)				       (T \TERM.OFD)				       (NIL \PRIMOUT.OFD)				       (ARG NARGS 1))))	     STYPE)	    (OR (type? STREAM STREAM)		  (RETURN))	    (SETQ STYPE (fetch (IMAGEOPS IMAGETYPE) of (fetch (STREAM IMAGEOPS) of STREAM)))	    (RETURN (AND (COND			       ((EQ NARGS 2)				 (for X inside (ARG NARGS 2) always (EQMEMB X STYPE)))			       (T STYPE))			     STREAM)))))(IMAGESTREAMTYPE  (LAMBDA (STREAM)                                           (* rmk: "20-AUG-83 17:28")    (fetch (IMAGEOPS IMAGETYPE) of (fetch (STREAM IMAGEOPS) of (\STREAMARG STREAM)))))(IMAGESTREAMTYPEP  (LAMBDA (STREAM STYPE)                                     (* AJB "16-Jul-85 15:31")          (* * Returns T if STREAM is an imagestream of type STYPE)    (LET ((S (SELECTQ STREAM			  ((T NIL)			    (\GETSTREAM STREAM (QUOTE OUTPUT)					  T))			  STREAM)))           (AND (type? STREAM S)		  (for X inside STYPE always (EQMEMB X (fetch (IMAGEOPS IMAGETYPE)								  of (fetch (STREAM IMAGEOPS)									  of S))))))))(OPENIMAGESTREAM  (LAMBDA (FILE IMAGETYPE OPTIONS)                           (* hdj " 4-Sep-86 11:49")                                                  (* ;; "Opens an IMAGETYPE imagestream, or if NIL, an imagestream of a type that FILE (perhaps from DEFAULTPRINTINGHOST) can print directly. If FILE is an the LPT device, then the type of the corresponding printer is used. If FILE is NIL, then an LPT file on a printer from default printinghost is used, so the file will be printed on closing.")    (DECLARE (GLOBALVARS IMAGESTREAMTYPES))    (PROG (LPTNAME LPTP (DEFPRINTER (OR (CAR (LISTP DEFAULTPRINTINGHOST))                                        DEFAULTPRINTINGHOST)))          (SETQ FILE (\CONVERT-PATHNAME FILE))          (COND             ((AND (NULL FILE)                   (NEQ IMAGETYPE (QUOTE DISPLAY)))                                                  (* ;                                  "YUCK! TAKE THIS OUT WHEN WE FIGURE OUT DISPLAY IMAGESTREAMS BETTER")              (SETQ LPTP T)              (SETQ FILE (QUOTE {LPT})))             ((STREAMP FILE))             ((EQ (FILENAMEFIELD FILE (QUOTE HOST))                  (QUOTE LPT))              (SETQ LPTP T)              (PROG (POS)                         (* ;; "This should be (FILENAMEFIELD FILE 'NAME) except that FILENAMEFIELD won't accept : as part of the name, thinks it marks a device field. This code is borrowed from PRINTERDEVICE")                    (AND (SETQ POS (STRPOS "}" FILE))                         (SETQ LPTNAME (SUBATOM FILE (ADD1 POS)                                              (SUB1 (OR (STRPOS "." FILE (ADD1 POS))                                                        0))))))))          (COND             ((NULL IMAGETYPE)                    (* ;; "Get the image type from FILE if it is an LPT file, otherwise choose the image type from the first printer on DEFAULTPRINTINGHOST")                                                  (* ;;             "Assume that it will be printed on the defaultprintinghost if it is an ordinary filename")              (COND                 ((SETQ IMAGETYPE (PRINTFILETYPE.FROM.EXTENSION FILE)))                 ((SETQ IMAGETYPE (CAR (MKLIST (PRINTERPROP (PRINTERTYPE (OR LPTNAME DEFPRINTER))                                                      (QUOTE CANPRINT)))))                                                  (* ;                                  "If FILE is NIL, LPTNAME must be NIL and we are going to DEFPRINTER")                  )                 (T (ERROR "Can't determine IMAGETYPE for " FILE))))             (LPTNAME (OR (EQMEMB IMAGETYPE (PRINTERPROP (PRINTERTYPE LPTNAME)                                                   (QUOTE CANPRINT)))                          (ERROR (CONCAT "Printer " LPTNAME " can't print " IMAGETYPE " files"))))             (LPTP                                (* ;                                          "This includes the NIL FILE case, cause of initial coercion")                   (for P inside DEFAULTPRINTINGHOST when (EQMEMB IMAGETYPE (PRINTERPROP (PRINTERTYPE                                                                                          P)                                                                                   (QUOTE CANPRINT)))                      do (SETQ FILE (PACKFILENAME (QUOTE HOST)                                           (QUOTE LPT)                                           (QUOTE NAME)                                           P))                         (RETURN) finally (ERROR (CONCAT                                         "Can't find a printer on DEFAULTPRINTINGHOST that can print "                                                         IMAGETYPE " files")))))          (RETURN (APPLY* (OR (CADR (ASSOC (QUOTE OPENSTREAM)                                           (CDR (ASSOC IMAGETYPE IMAGESTREAMTYPES))))                              (ERROR "No open function for " IMAGETYPE " streams"))                         (COND                            ((OR LPTP (STREAMP FILE)                                 (EQ IMAGETYPE (QUOTE DISPLAY)))                             FILE)                            (T                    (* ;                                                   "Stick on default extension from PRINTFILETYPES")                               (PACKFILENAME (QUOTE BODY)                                      FILE                                      (QUOTE EXTENSION)                                      (OR (CAR (CADR (ASSOC (QUOTE EXTENSION)                                                            (CDR (ASSOC IMAGETYPE PRINTFILETYPES)))))                                          IMAGETYPE))))                         OPTIONS)))))(\GOOD.DASHLST  [LAMBDA (DASHING BRUSH)                                    (* rrb " 9-Sep-86 16:16")                    (* * massage the DASHING parameter to mesh well with the size of the BRUSH)    (PROG [(DASHLST (INSURE.DASHING DASHING))           (BRUSHSIZE (COND                         ((LITATOM BRUSH)                    (* handles NULL and function name                                                              case.)                          1)                         ((BITMAPP BRUSH)                          (IQUOTIENT (IPLUS 2 (BITMAPHEIGHT BRUSH)                                            (BITMAPWIDTH BRUSH))                                 2))                         ((NUMBERP BRUSH)                    (* brush can be a number meaning ROUND                                                              and it hasn't been coerced yet.)                          (FIXR BRUSH))                         (T (fetch (BRUSH BRUSHSIZE) of BRUSH]          [COND             ((AND DASHLST (GREATERP BRUSHSIZE 1))           (* adjust the dashing to take into                                                              account the brush size.)              [COND                 ((ODDP (LENGTH DASHLST))                    (* even out the DASHLST because on and                                                              off are handled differently.)                  (SETQ DASHLST (APPEND DASHLST DASHLST]              (SETQ DASHLST (bind NOWOFF for NDASH in DASHLST                               collect (COND                                          (NOWOFF (SETQ NOWOFF NIL)                                                 (TIMES NDASH BRUSHSIZE))                                          ((SETQ NOWOFF T)   (* make the on case be 1 for the first                                                              one and brushsize for every one after                                                              that.)                                           (ADD1 (TIMES (SUB1 NDASH)                                                        BRUSHSIZE]          (RETURN DASHLST]))(RPAQ? IMAGESTREAMTYPES NIL)(DEFINEQ(DRAWDASHEDLINE  (LAMBDA (X1 Y1 X2 Y2 WIDTH OPERATION STREAM COLOR DASHING)                                                             (* rrb "25-Jun-85 14:59")    (PROG ((DASHON T)	     DASHTAIL DASHCNT (ADJACENT (IDIFFERENCE X2 X1))	     (OPPOSITE (IDIFFERENCE Y2 Y1))	     (LENGTHDRAWN 0)	     DASHLST NEWX NEWY LINELENGTH SINE COSINE)	    (SETQ LINELENGTH (FIX (SQRT (IPLUS (ITIMES ADJACENT ADJACENT)						       (ITIMES OPPOSITE OPPOSITE)))))                                                             (* expand the dashing by the width.)	    (SETQ DASHLST (bind NOWOFF for NDASH in DASHING collect (TIMES NDASH WIDTH)))	    (SETQ DASHTAIL DASHLST)	    (SETQ SINE (FQUOTIENT OPPOSITE LINELENGTH))	    (SETQ COSINE (FQUOTIENT ADJACENT LINELENGTH))	    (while (ILESSP (PLUS LENGTHDRAWN (CAR DASHTAIL))			       LINELENGTH)	       do (SETQ DASHCNT (CAR DASHTAIL))		    (SETQ DASHTAIL (CDR DASHTAIL))		    (add LENGTHDRAWN DASHCNT)		    (SETQ NEWX (FPLUS X1 (FTIMES COSINE DASHCNT)))		    (SETQ NEWY (FPLUS Y1 (FTIMES SINE DASHCNT)))		    (COND		      (DASHON (DRAWLINE X1 Y1 NEWX NEWY WIDTH OPERATION STREAM COLOR))		      (T (RELMOVETO NEWX NEWY STREAM)))		    (SETQ DASHON (NOT DASHON))		    (SETQ X1 NEWX)		    (SETQ Y1 NEWY)		    (COND		      ((NULL DASHTAIL)			(SETQ DASHTAIL DASHLST)))	       finally                                     (* do last partial segment)			 (COND			   (DASHON (DRAWLINE X1 Y1 X2 Y2 WIDTH OPERATION STREAM COLOR))))	    (MOVETO X2 Y2 STREAM)))))(DEFINEQ(DSPBACKCOLOR  (LAMBDA (COLOR STREAM)                                     (* rmk: "12-Sep-84 09:53")                                                             (* Switches background color on stream)    (IMAGEOP (QUOTE IMBACKCOLOR)	     (SETQ STREAM (\OUTSTREAMARG STREAM))	     STREAM COLOR)))(DSPBOTTOMMARGIN  (LAMBDA (YPOSITION STREAM)                                 (* rmk: "26-Jun-84 13:56")                                                             (* Sets the Y position that forces a new page)    (IMAGEOP (QUOTE IMBOTTOMMARGIN)	     (SETQ STREAM (\OUTSTREAMARG STREAM))	     STREAM YPOSITION)))(DSPCOLOR  (LAMBDA (COLOR STREAM)                                     (* rmk: "12-Sep-84 09:53")                                                             (* Switches foreground color on stream)    (IMAGEOP (QUOTE IMCOLOR)	     (SETQ STREAM (\OUTSTREAMARG STREAM))	     STREAM COLOR)))(DSPCLIPPINGREGION  (LAMBDA (REGION STREAM)                                    (* bvm: " 4-Sep-85 20:57")                                                             (* Set the clipping region for an imagestream)    (AND REGION (NOT (type? REGION REGION))	   (\ILLEGAL.ARG REGION))    (COND      (STREAM                                                (* special check done for NIL to stop default to 							     primary output file.)	      (IMAGEOP (QUOTE IMCLIPPINGREGION)		       (SETQ STREAM (\OUTSTREAMARG STREAM))		       STREAM REGION))      (T (\ILLEGAL.ARG STREAM)))))(DSPRESET  (LAMBDA (STREAM)                                           (* jds "11-Jan-85 16:54")                                                             (* resets a display stream)    (IMAGEOP (QUOTE IMRESET)	     (SETQ STREAM (\OUTSTREAMARG STREAM))	     STREAM)))(DSPFONT  (LAMBDA (FONT STREAM)                                      (* rmk: " 2-SEP-83 10:50")                                                             (* sets the font that an image stream uses to print 							     characters.)    (IMAGEOP (QUOTE IMFONT)	     (SETQ STREAM (\OUTSTREAMARG STREAM))	     STREAM FONT)))(DSPLEFTMARGIN  (LAMBDA (XPOSITION STREAM)                                 (* rmk: " 2-SEP-83 10:50")                                                             (* Sets the the position that a carriage return 							     returns to)    (IMAGEOP (QUOTE IMLEFTMARGIN)	     (SETQ STREAM (\OUTSTREAMARG STREAM))	     STREAM XPOSITION)))(DSPLINEFEED  (LAMBDA (DELTAY STREAM)                                    (* rmk: " 2-SEP-83 10:50")                                                             (* Sets the Xposition of STREAM)    (IMAGEOP (QUOTE IMLINEFEED)	     (SETQ STREAM (\OUTSTREAMARG STREAM))	     STREAM DELTAY)))(DSPOPERATION  (LAMBDA (OPERATION STREAM)                                 (* rmk: "12-Sep-84 09:56")                                                             (* sets the operation field of a stream)    (IMAGEOP (QUOTE IMOPERATION)	     (SETQ STREAM (\OUTSTREAMARG STREAM))	     STREAM OPERATION)))(DSPRIGHTMARGIN  (LAMBDA (XPOSITION STREAM)                                 (* rmk: " 2-SEP-83 10:51")                                                             (* Sets the right margin that determines when a cr is 							     inserted by print.)    (IMAGEOP (QUOTE IMRIGHTMARGIN)	     (SETQ STREAM (\OUTSTREAMARG STREAM))	     STREAM XPOSITION)))(DSPTOPMARGIN  (LAMBDA (YPOSITION STREAM)                                 (* rmk: "26-Jun-84 13:55")                                                             (* Sets the Y position that a newpage starts at)    (IMAGEOP (QUOTE IMTOPMARGIN)	     (SETQ STREAM (\OUTSTREAMARG STREAM))	     STREAM YPOSITION)))(DSPSCALE  (LAMBDA (SCALE STREAM)                                     (* rmk: "16-Jun-84 14:48")                                                             (* Returns (and eventually will set) the current scale							     of STREAM.)    (IMAGEOP (QUOTE IMSCALE)	     (SETQ STREAM (\OUTSTREAMARG STREAM))	     STREAM SCALE)))(DSPSPACEFACTOR  (LAMBDA (FACTOR STREAM)                                    (* rmk: "27-Nov-84 18:57")                                                             (* Sets the space factor of STREAM)    (AND FACTOR (OR (GREATERP FACTOR 0)			(\ILLEGAL.ARG FACTOR)))    (IMAGEOP (QUOTE IMSPACEFACTOR)	     (SETQ STREAM (\OUTSTREAMARG STREAM))	     STREAM FACTOR)))(DSPXPOSITION  (LAMBDA (XPOSITION STREAM)                                 (* rmk: " 2-SEP-83 10:51")                                                             (* Sets the Xposition of STREAM)    (IMAGEOP (QUOTE IMXPOSITION)	     (SETQ STREAM (\OUTSTREAMARG STREAM))	     STREAM XPOSITION)))(DSPYPOSITION  (LAMBDA (YPOSITION STREAM)                                 (* rmk: " 2-SEP-83 10:51")                                                             (* Sets the Yposition of STREAM)    (IMAGEOP (QUOTE IMYPOSITION)	     (SETQ STREAM (\OUTSTREAMARG STREAM))	     STREAM YPOSITION)))(DSPROTATE  (LAMBDA (ROTATION STREAM)                                  (* hdj "22-Oct-85 12:15")                                                             (* Sets the rotation of STREAM)    (IMAGEOP (QUOTE IMROTATE)	     (SETQ STREAM (\OUTSTREAMARG STREAM))	     STREAM ROTATION)))(DSPPUSHSTATE  (LAMBDA (STREAM)                                           (* hdj "25-Nov-85 11:49")          (* * push a new graphics context for STREAM)    (IMAGEOP (QUOTE IMPUSHSTATE)	     (SETQ STREAM (\OUTSTREAMARG STREAM))	     STREAM)))(DSPPOPSTATE  (LAMBDA (STREAM)                                           (* hdj "25-Nov-85 11:50")          (* * pop a the graphics context for STREAM)    (IMAGEOP (QUOTE IMPOPSTATE)	     (SETQ STREAM (\OUTSTREAMARG STREAM))	     STREAM)))(DSPDEFAULTSTATE  (LAMBDA (STREAM)                                           (* hdj "30-Dec-85 17:39")          (* * push a new graphics context for STREAM)    (IMAGEOP (QUOTE IMDEFAULTSTATE)	     (SETQ STREAM (\OUTSTREAMARG STREAM))	     STREAM)))(DSPSCALE2  (LAMBDA (Sx Sy STREAM)                                     (* hdj " 2-Jan-86 18:38")                                                             (* Sets the scaling of STREAM)    (IMAGEOP (QUOTE IMSCALE2)	     (SETQ STREAM (\OUTSTREAMARG STREAM))	     STREAM Sx Sy)))(DSPTRANSLATE  (LAMBDA (Tx Ty STREAM)                                     (* hdj " 2-Jan-86 18:37")                                                             (* Sets the translation of STREAM)    (IMAGEOP (QUOTE IMTRANSLATE)	     (SETQ STREAM (\OUTSTREAMARG STREAM))	     STREAM Tx Ty))))(DEFINEQ(DSPNEWPAGE  [LAMBDA (STREAM)                                                     (* jds                                                                            " 9-Feb-86 17:18")                        (* * Start a new page on the image stream STREAM.)    (AND (STREAMPROP (SETQ STREAM (\OUTSTREAMARG STREAM))                (QUOTE BEFORENEWPAGEFN))         (APPLY* (STREAMPROP STREAM (QUOTE BEFORENEWPAGEFN))                STREAM))                                                   (* Let the stream's                                                                            creator get control                                                                            before and after the                                                                            page break, if he wants                                                                            it.)    (IMAGEOP (QUOTE IMNEWPAGE)           (SETQ STREAM (\OUTSTREAMARG STREAM))           STREAM)    (AND (STREAMPROP STREAM (QUOTE AFTERNEWPAGEFN))         (APPLY* (STREAMPROP STREAM (QUOTE AFTERNEWPAGEFN))                STREAM])(DRAWBETWEEN  (LAMBDA (PT1 PT2 WIDTH OPERATION STREAM COLOR DASHING)     (* hdj " 7-Nov-84 14:03")                                                             (* draws a line bwteen two points)    (IMAGEOP (QUOTE IMDRAWLINE)	     (SETQ STREAM (\OUTSTREAMARG STREAM))	     STREAM	     (fetch XCOORD of PT1)	     (fetch YCOORD of PT1)	     (fetch XCOORD of PT2)	     (fetch YCOORD of PT2)	     WIDTH OPERATION COLOR DASHING)))(DRAWCIRCLE  (LAMBDA (CENTERX CENTERY RADIUS BRUSH DASHING STREAM)      (* rrb "30-Oct-85 14:22")                                                             (* Generic DRAWCIRCLE)    (COND      ((LESSP RADIUS 0)	(\ILLEGAL.ARG RADIUS))      ((EQP RADIUS 0)	NIL)      (T (IMAGEOP (QUOTE IMDRAWCIRCLE)		  (SETQ STREAM (\OUTSTREAMARG STREAM))		  STREAM CENTERX CENTERY RADIUS (INSURE.BRUSH BRUSH STREAM)		  (INSURE.DASHING DASHING))))))(DRAWARC  (LAMBDA (CENTERX CENTERY RADIUS STARTANGLE NDEGREES BRUSH DASHING STREAM)                                                             (* rrb "31-Oct-85 09:18")                                                             (* Draws an arc of a given brush and dashing.							     NDEGREES can be either positive 							     (counterclockwise) or negative 							     (clockwise).)    (IMAGEOP (QUOTE IMDRAWARC)	     (SETQ STREAM (\OUTSTREAMARG STREAM))	     STREAM CENTERX CENTERY RADIUS STARTANGLE NDEGREES (INSURE.BRUSH BRUSH STREAM)	     (INSURE.DASHING DASHING))))(DRAWCURVE  [LAMBDA (KNOTS CLOSED BRUSH DASHING STREAM)                      (* edited:                                                                        "31-Mar-86 20:07")                                                                       (* draws a spline curve                                                                        with a given brush.)    (LET ((VALIDBRUSH BRUSH))         (if (NOT (BRUSHP BRUSH))             then (SETQ VALIDBRUSH (INSURE.BRUSH BRUSH STREAM)))         (IMAGEOP (QUOTE IMDRAWCURVE)                (SETQ STREAM (\OUTSTREAMARG STREAM))                STREAM KNOTS CLOSED VALIDBRUSH (INSURE.DASHING DASHING))         (if (NEQ VALIDBRUSH BRUSH)             then (FREERESOURCE SYSTEMBRUSH VALIDBRUSH])(DRAWELLIPSE  (LAMBDA (CENTERX CENTERY SEMIMINORRADIUS SEMIMAJORRADIUS ORIENTATION BRUSH DASHING STREAM)                                                             (* rrb "30-Oct-85 14:26")          (* Draws an ellipse. At ORIENTATION 0, the semimajor axis is horizontal, the semiminor axis vertical.	  Orientation is positive in the counterclockwise direction. The current location in the stream is left at the center	  of the ellipse.)    (DECLARE (LOCALVARS . T))    (IMAGEOP (QUOTE IMDRAWELLIPSE)	     (SETQ STREAM (\OUTSTREAMARG STREAM))	     STREAM CENTERX CENTERY SEMIMINORRADIUS SEMIMAJORRADIUS ORIENTATION (INSURE.BRUSH	       BRUSH STREAM)	     (INSURE.DASHING DASHING))))(DRAWLINE  (LAMBDA (X1 Y1 X2 Y2 WIDTH OPERATION STREAM COLOR DASHING)                                                             (* hdj "17-Jun-85 11:27")    (IMAGEOP (QUOTE IMDRAWLINE)	     (SETQ STREAM (\OUTSTREAMARG STREAM))	     STREAM X1 Y1 X2 Y2 WIDTH OPERATION COLOR DASHING)))(DRAWPOLYGON  (LAMBDA (POINTS CLOSED BRUSH DASHING STREAM)               (* rrb "30-Oct-85 14:26")                                                             (* draws a polygon with a given brush.)    (IMAGEOP (QUOTE IMDRAWPOLYGON)	     (SETQ STREAM (\OUTSTREAMARG STREAM))	     STREAM POINTS CLOSED (INSURE.BRUSH BRUSH STREAM)	     (INSURE.DASHING DASHING))))(FILLPOLYGON  [LAMBDA (POINTS TEXTURE STREAM OPERATION WINDNUMBER)                 (* rrb                                                                            " 5-Mar-86 15:39")                                                                           (* fills a polygon                                                                            with a given texture)    (COND       ((NOT (OR (EQUAL WINDNUMBER 0)                 (EQUAL WINDNUMBER 1)))        (SETQ WINDNUMBER 1)))    (IMAGEOP (QUOTE IMFILLPOLYGON)           (SETQ STREAM (\OUTSTREAMARG STREAM))           STREAM POINTS TEXTURE (OR OPERATION (DSPOPERATION NIL STREAM))           WINDNUMBER])(DRAWTO  (LAMBDA (X Y WIDTH OPERATION STREAM COLOR DASHING)         (* hdj " 7-Nov-84 14:03")                                                             (* draws a line fro the current position of STREAM to 							     absolute position X,Y.)    (IMAGEOP (QUOTE IMDRAWLINE)	     (SETQ STREAM (\OUTSTREAMARG STREAM))	     STREAM	     (IMAGEOP (QUOTE IMXPOSITION)		      STREAM STREAM)	     (IMAGEOP (QUOTE IMYPOSITION)		      STREAM STREAM)	     X Y WIDTH OPERATION COLOR DASHING)))(FILLCIRCLE  (LAMBDA (CENTERX CENTERY RADIUS TEXTURE STREAM)            (* rmk: " 2-SEP-83 10:54")    (IMAGEOP (QUOTE IMFILLCIRCLE)	     (SETQ STREAM (\OUTSTREAMARG STREAM))	     STREAM CENTERX CENTERY RADIUS TEXTURE)))(MOVETO  (LAMBDA (X Y STREAM)                                       (* rmk: "17-Sep-84 17:59")                                                             (* sets both the X and Y positions in a Stream)    (IMAGEOP (QUOTE IMMOVETO)	     (SETQ STREAM (\OUTSTREAMARG STREAM))	     STREAM X Y)))(RELDRAWTO  [LAMBDA (DX DY WIDTH OPERATION STREAM COLOR DASHING)                 (* rrb                                                                            "21-Feb-86 09:23")                                                                           (* Draws a vector                                                                            from the current                                                                            position)    (PROG (ORIGX ORIGY (STRM (\OUTSTREAMARG STREAM)))          (RETURN (COND                     ((NOT (AND (ZEROP DX)                                (ZEROP DX)))                               (* documented to not                                                                            draw anything if DX and                                                                            DY are both 0)                      (IMAGEOP (QUOTE IMDRAWLINE)                             STRM STRM (SETQ ORIGX (IMAGEOP (QUOTE IMXPOSITION)                                                          STRM STRM))                             (SETQ ORIGY (IMAGEOP (QUOTE IMYPOSITION)                                                STRM STRM))                             (IPLUS ORIGX DX)                             (IPLUS ORIGY DY)                             WIDTH OPERATION COLOR DASHING])(BITMAPIMAGESIZE  (LAMBDA (BITMAP DIMENSION STREAM)                          (* hdj "19-Dec-84 11:57")    (IMAGEOP (QUOTE IMBITMAPSIZE)	     STREAM STREAM BITMAP DIMENSION)))(SCALEDBITBLT  (LAMBDA (SOURCE SOURCELEFT SOURCEBOTTOM DESTINATION DESTINATIONLEFT DESTINATIONBOTTOM WIDTH HEIGHT 		  SOURCETYPE OPERATION TEXTURE CLIPPINGREGION SCALE)                                                             (* hdj "14-Feb-85 14:35")    (IMAGEOP (QUOTE IMSCALEDBITBLT)	     DESTINATION SOURCE SOURCELEFT SOURCEBOTTOM DESTINATION (OR DESTINATIONLEFT 0)	     (OR DESTINATIONBOTTOM 0)	     WIDTH HEIGHT SOURCETYPE OPERATION TEXTURE CLIPPINGREGION (if CLIPPINGREGION									  then (fetch										   (REGION LEFT)										    of 										   CLIPPINGREGION)									else 0)	     (if CLIPPINGREGION		 then (fetch (REGION LEFT) of CLIPPINGREGION)	       else 0)	     SCALE))))(DEFINEQ(\IMAGEIOINIT  [LAMBDA NIL                                                (* rrb "16-Sep-86 10:07")    (DECLARE (GLOBALVARS \NOIMAGEOPS))                       (* most of the functions are filled                                                              with NILL from the record declaration                                                              for IMAGEOPS)    (SETQ \NOIMAGEOPS (create IMAGEOPS                             IMAGETYPE &larr; NIL                             IMXPOSITION &larr; [FUNCTION (LAMBDA (STREAM POS)                                                       (LET ((OPOS (POSITION STREAM)))                                                            (PROG1 OPOS                                                                   (COND                                                                      (POS (SPACES (DIFFERENCE POS                                                                                           OPOS)                                                                                  STREAM]                             IMYPOSITION &larr; [FUNCTION (LAMBDA (STREAM N)                                                       (PROG1 (AND \#DISPLAYLINES (NEQ                                                                                   \CURRENTDISPLAYLINE                                                                                        -1)                                                                   (DIFFERENCE \#DISPLAYLINES                                                                           \CURRENTDISPLAYLINE))                                                              (COND                                                                 (N (\UNIMPIMAGEOP STREAM                                                                           (QUOTE DSPYPOSITION]                             IMFONT &larr; (FUNCTION \NOIMAGE.DSPFONT)                             IMLEFTMARGIN &larr; (FUNCTION ZERO)                             IMRIGHTMARGIN &larr; [FUNCTION (LAMBDA (STREAM N)                                                         (LINELENGTH N STREAM]                             IMLINEFEED &larr; [FUNCTION (LAMBDA (STREAM DY)                                                      (PROG1 -1 (AND DY (COND                                                                           ((NEQ DY -1)                                                                            (ERROR DY                                                                    "Illegal DSPLINEFEED for terminal"                                                                                   ]                             IMSPACEFACTOR &larr; [FUNCTION (LAMBDA (STREAM)                                                         (\UNIMPIMAGEOP STREAM (QUOTE DSPSPACEFACTOR]                             IMFONTCREATE &larr; [FUNCTION (LAMBDA (STREAM)                                                        (\UNIMPIMAGEOP STREAM (QUOTE FONTCREATE]                             IMSTRINGWIDTH &larr; [FUNCTION (LAMBDA (STREAM STR RDTBL)                                                         (NCHARS STR RDTBL RDTBL]                             IMCHARWIDTH &larr; [FUNCTION (LAMBDA NIL 1]                             IMCHARSET &larr; (FUNCTION (LAMBDA (STREAM CHARSET)                    (* If we had another illegal character set value, then we could simply fix it           so that the character set didn't match anything, which would cause the           character set shift to be put out on the next character)                                                     (COND                                                        ((\IOMODEP STREAM (QUOTE OUTPUT)                                                                T)                                                         (\BOUT STREAM NSCHARSETSHIFT)                                                         (COND                                                            ((EQ CHARSET T)                                                             (\BOUT STREAM NSCHARSETSHIFT)                                                             (\BOUT STREAM 0))                                                            (T (\BOUT STREAM CHARSET])(\NOIMAGE.DSPFONT  (LAMBDA (STREAM FONT)                                                    (* lmm                                                                            " 4-Mar-86 14:50")    (LET ((OLDFONT (ffetch IMAGEDATA of STREAM)))         (PROG1 OLDFONT (AND (NEQ OLDFONT 0)                             (LET ((FONTN (OR (SMALLP FONT)                                              (AND (type? FONTCLASS FONT)                                                   (fetch (FONTCLASS PRETTYFONT#) of FONT)))))                                  (COND                                     ((AND FONTN (NEQ FONTN OLDFONT))      (* must be an outchar                                                                            so that if the file is                                                                            run-coded, the font                                                                            change characters will                                                                            come out in charset 0.0)                                      (COND                                         ((NEQ FONTN 0)                                          (BOUT STREAM (CONSTANT (CHCON1 FONTESCAPECHAR)))                                          (BOUT STREAM FONTN)))                                      (freplace IMAGEDATA of STREAM with FONTN)))))))))(\UNIMPIMAGEOP  (LAMBDA (STREAM OP)                                        (* rmk: "26-Jun-84 13:28")    (ERROR STREAM (CONCAT "does not support " OP)))))(* stuff to support the checking and defaulting of arguments in the device independent drawing functions.)(DEFINEQ(INSURE.BRUSH  [LAMBDA (BRUSH STREAM NOERRORFLG)                                (* edited:                                                                        "31-Mar-86 20:07")                                                                       (* returns a full brush                                                                        if BRUSH is interpretable                                                                        as a brush)    (COND       ((BRUSHP BRUSH))       ((NUMBERP BRUSH)        (LET ((SYSTEMBRUSH (NEWRESOURCE SYSTEMBRUSH)))             (replace (BRUSH BRUSHSHAPE) of SYSTEMBRUSH with (QUOTE ROUND))             (replace (BRUSH BRUSHSIZE) of SYSTEMBRUSH with BRUSH)             (replace (BRUSH BRUSHCOLOR) of SYSTEMBRUSH with (DSPCOLOR NIL STREAM))         SYSTEMBRUSH))       ((NULL BRUSH)                                                   (* Defaults to ROUND, 1                                                                        screen point and the                                                                        current stream color)        (LET ((SYSTEMBRUSH (NEWRESOURCE SYSTEMBRUSH)))             (replace (BRUSH BRUSHSHAPE) of SYSTEMBRUSH with (QUOTE ROUND))             (replace (BRUSH BRUSHCOLOR) of SYSTEMBRUSH with (DSPCOLOR NIL STREAM))             (replace (BRUSH BRUSHSIZE) of SYSTEMBRUSH with (DSPSCALE NIL STREAM))                                                                       (* the default brush                                                                        should be 1 screen point                                                                        wide.)         SYSTEMBRUSH))       (NOERRORFLG NIL)       (T (\ILLEGAL.ARG BRUSH])(BRUSHP  (LAMBDA (BRUSH?)                                                     (* rrb                                                                            "13-Feb-86 17:37")                                                                           (* checks if BRUSH?                                                                            is a legal brush)    (DECLARE (GLOBALVARS KNOWN.BRUSHES))    (COND       ((LITATOM BRUSH?)                                                   (* the name of a                                                                            function to be applied                                                                            at each point.)        (AND (\DEFINEDP BRUSH?)             BRUSH?))       ((AND (MEMB (CAR (LISTP BRUSH?))                   KNOWN.BRUSHES)             (NUMBERP (CAR (LISTP (CDR BRUSH?))))             (OR (NULL (CDDR BRUSH?))                 (AND (OR (\POSSIBLECOLOR (CAR (LISTP (CDDR BRUSH?))))                          (NULL (CAR (LISTP (CDDR BRUSH?)))))                      (NULL (CDDDR BRUSH?)))))        BRUSH?))))(\POSSIBLECOLOR  (LAMBDA (COLOR?)                                                    (* kbr:                                                                           "15-Feb-86 22:20")                                                                          (* could COLOR? be a                                                                           color indicator.                                                                          True if it is a number                                                                           in the right range or a                                                                           LITATOM that could be a                                                                           name.)    (SELECTQ (TYPENAME COLOR?)        (LITATOM COLOR?)        ((SMALLP FIXP)              (AND (IGEQ COLOR? 0)                  (ILEQ COLOR? (MASK.1'S 0 24))                  COLOR?))        (LISTP (OR (RGBP COLOR?)                   (HLSP COLOR?)))        NIL))))(DECLARE: DONTCOPY EVAL@COMPILE (DECLARE: EVAL@COMPILE [PUTDEF (QUOTE SYSTEMBRUSH)       (QUOTE RESOURCES)       (QUOTE (NEW (CREATE BRUSH)                   FREE                   (PUSH \SYSTEMBRUSHES (PROG1 . ARGS))                   GET                   (OR (POP \SYSTEMBRUSHES)                       (NEWRESOURCE SYSTEMBRUSH))                   INIT                   (SETQ \SYSTEMBRUSHES NIL]))(SETQ \SYSTEMBRUSHES NIL)(DEFINEQ(DASHINGP  (LAMBDA (DASHING)                                          (* rrb "30-Oct-85 11:33")                                                             (* return DASHING if it is a legal DASHING Note that 							     NIL is a legal dashing and this will return NIL.)    (AND (LISTP DASHING)	   (for X in DASHING always (NUMBERP X))	   DASHING)))(INSURE.DASHING  (LAMBDA (DASHING NOERRORFLG)                               (* rrb "30-Oct-85 11:35")                                                             (* checks to make sure DASHING is a legal dashing 							     spec.)    (COND      (DASHING (COND		 ((DASHINGP DASHING))		 (NOERRORFLG NIL)		 (T (\ILLEGAL.ARG DASHING))))))))(DECLARE: DONTCOPY (* FOLLOWING DEFINITIONS EXPORTED)[DECLARE: EVAL@COMPILE (RECORD BRUSH (BRUSHSHAPE BRUSHSIZE BRUSHCOLOR)              BRUSHSHAPE &larr; (QUOTE ROUND)              BRUSHSIZE &larr; 1)](* END EXPORTED DEFINITIONS))(DECLARE: DONTCOPY (DECLARE: EVAL@COMPILE (RPAQ MICASPERPT (FQUOTIENT 635 18))(CONSTANTS (MICASPERPT (FQUOTIENT 635 18)))))(DECLARE: DONTCOPY (* FOLLOWING DEFINITIONS EXPORTED)(DECLARE: EVAL@COMPILE [PUTPROPS IMAGEOP MACRO (ARGS (CONS (QUOTE SPREADAPPLY*)                                    (CONS (COND [(EQ (CAR (LISTP (CAR ARGS)))                                                     (QUOTE QUOTE))                                                 (LIST (QUOTE fetch)                                                       (LIST (QUOTE IMAGEOPS)                                                             (CADAR ARGS))                                                       (QUOTE of)                                                       (LIST (QUOTE fetch)                                                             (QUOTE (STREAM IMAGEOPS))                                                             (QUOTE of)                                                             (CADR ARGS]                                                (T (HELP "IMAGEOP - OPNAME not quoted:" ARGS)))                                          (CDDR ARGS])[DECLARE: EVAL@COMPILE (DATATYPE IMAGEOPS           (IMAGETYPE IMCLOSEFN IMXPOSITION IMYPOSITION IMFONT IMLEFTMARGIN IMRIGHTMARGIN IMLINEFEED                  IMDRAWLINE IMDRAWCURVE IMDRAWCIRCLE IMDRAWELLIPSE IMFILLCIRCLE IMBLTSHADE IMBITBLT                  IMNEWPAGE IMMOVETO IMSCALE IMTERPRI IMTOPMARGIN IMBOTTOMMARGIN IMSPACEFACTOR                  IMFONTCREATE IMOPERATION IMCOLOR IMSTRINGWIDTH IMCHARWIDTH IMCHARWIDTHY IMBACKCOLOR                  IMBITMAPSIZE IMCLIPPINGREGION IMRESET IMDRAWPOLYGON IMFILLPOLYGON IMSCALEDBITBLT                  IMWRITEPIXEL IMCHARSET IMROTATE IMDRAWARC IMTRANSLATE IMSCALE2 IMPUSHSTATE                  IMPOPSTATE IMDEFAULTSTATE)          IMCLOSEFN &larr; (FUNCTION NILL)          IMTERPRI &larr; [FUNCTION (LAMBDA (STREAM)                                 (\OUTCHAR STREAM (CHARCODE EOL]          IMNEWPAGE &larr; [FUNCTION (LAMBDA (STREAM)                                  (\OUTCHAR STREAM (CHARCODE &uarr;L]          IMOPERATION &larr; (FUNCTION NILL)          IMCOLOR &larr; (FUNCTION NILL)          IMCLIPPINGREGION &larr; (FUNCTION NILL)          IMRESET &larr; (FUNCTION NILL)          IMBACKCOLOR &larr; (FUNCTION NILL)          IMSTRINGWIDTH &larr; [FUNCTION (LAMBDA (STREAM STR RDTBL)                                      (STRINGWIDTH STR (DSPFONT NIL STREAM)                                             RDTBL RDTBL]          IMCHARWIDTH &larr; [FUNCTION (LAMBDA (STREAM CHARCODE)                                    (CHARWIDTH CHARCODE (DSPFONT NIL STREAM]          IMMOVETO &larr; [FUNCTION (LAMBDA (STREAM X Y)                                 (IMAGEOP (QUOTE IMXPOSITION)                                        STREAM STREAM X)                                 (IMAGEOP (QUOTE IMYPOSITION)                                        STREAM STREAM Y]          IMBITMAPSIZE &larr; [FUNCTION (LAMBDA (STREAM BITMAP DIMENSION)                                     (SELECTQ DIMENSION                                         (WIDTH (TIMES (DSPSCALE NIL STREAM)                                                       (BITMAPWIDTH BITMAP)))                                         (HEIGHT (TIMES (DSPSCALE NIL STREAM)                                                        (BITMAPHEIGHT BITMAP)))                                         (NIL (CONS (TIMES (DSPSCALE NIL STREAM)                                                           (BITMAPWIDTH BITMAP))                                                    (TIMES (DSPSCALE NIL STREAM)                                                           (BITMAPHEIGHT BITMAP))))                                         (\ILLEGAL.ARG DIMENSION]          IMWRITEPIXEL &larr; (FUNCTION NILL)          IMCHARSET &larr; (FUNCTION NILL)          IMXPOSITION &larr; (FUNCTION NILL)          IMYPOSITION &larr; (FUNCTION NILL)          IMFONT &larr; (FUNCTION NILL)          IMLEFTMARGIN &larr; (FUNCTION NILL)          IMRIGHTMARGIN &larr; (FUNCTION NILL)          IMLINEFEED &larr; (FUNCTION NILL)          IMDRAWLINE &larr; (FUNCTION NILL)          IMDRAWCURVE &larr; (FUNCTION NILL)          IMDRAWCIRCLE &larr; (FUNCTION NILL)          IMDRAWELLIPSE &larr; (FUNCTION NILL)          IMFILLCIRCLE &larr; (FUNCTION NILL)          IMBLTSHADE &larr; (FUNCTION NILL)          IMBITBLT &larr; (FUNCTION NILL)          IMSCALE &larr; (FUNCTION NILL)          IMTOPMARGIN &larr; (FUNCTION NILL)          IMBOTTOMMARGIN &larr; (FUNCTION NILL)          IMSPACEFACTOR &larr; (FUNCTION NILL)          IMFONTCREATE &larr; (FUNCTION NILL)          IMCHARWIDTHY &larr; (FUNCTION NILL)          IMDRAWPOLYGON &larr; (FUNCTION NILL)          IMFILLPOLYGON &larr; (FUNCTION NILL)          IMSCALEDBITBLT &larr; (FUNCTION NILL)          IMROTATE &larr; (FUNCTION NILL)          IMDRAWARC &larr; (FUNCTION NILL)          IMTRANSLATE &larr; (FUNCTION NILL)          IMPUSHSTATE &larr; (FUNCTION NILL)          IMPOPSTATE &larr; (FUNCTION NILL)          IMSCALE2 &larr; (FUNCTION NILL)          IMDEFAULTSTATE &larr; (FUNCTION NILL))](/DECLAREDATATYPE (QUOTE IMAGEOPS)       (QUOTE (POINTER POINTER POINTER POINTER POINTER POINTER POINTER POINTER POINTER POINTER                      POINTER POINTER POINTER POINTER POINTER POINTER POINTER POINTER POINTER POINTER                      POINTER POINTER POINTER POINTER POINTER POINTER POINTER POINTER POINTER POINTER                      POINTER POINTER POINTER POINTER POINTER POINTER POINTER POINTER POINTER POINTER                      POINTER POINTER POINTER POINTER))       (QUOTE ((IMAGEOPS 0 POINTER)               (IMAGEOPS 2 POINTER)               (IMAGEOPS 4 POINTER)               (IMAGEOPS 6 POINTER)               (IMAGEOPS 8 POINTER)               (IMAGEOPS 10 POINTER)               (IMAGEOPS 12 POINTER)               (IMAGEOPS 14 POINTER)               (IMAGEOPS 16 POINTER)               (IMAGEOPS 18 POINTER)               (IMAGEOPS 20 POINTER)               (IMAGEOPS 22 POINTER)               (IMAGEOPS 24 POINTER)               (IMAGEOPS 26 POINTER)               (IMAGEOPS 28 POINTER)               (IMAGEOPS 30 POINTER)               (IMAGEOPS 32 POINTER)               (IMAGEOPS 34 POINTER)               (IMAGEOPS 36 POINTER)               (IMAGEOPS 38 POINTER)               (IMAGEOPS 40 POINTER)               (IMAGEOPS 42 POINTER)               (IMAGEOPS 44 POINTER)               (IMAGEOPS 46 POINTER)               (IMAGEOPS 48 POINTER)               (IMAGEOPS 50 POINTER)               (IMAGEOPS 52 POINTER)               (IMAGEOPS 54 POINTER)               (IMAGEOPS 56 POINTER)               (IMAGEOPS 58 POINTER)               (IMAGEOPS 60 POINTER)               (IMAGEOPS 62 POINTER)               (IMAGEOPS 64 POINTER)               (IMAGEOPS 66 POINTER)               (IMAGEOPS 68 POINTER)               (IMAGEOPS 70 POINTER)               (IMAGEOPS 72 POINTER)               (IMAGEOPS 74 POINTER)               (IMAGEOPS 76 POINTER)               (IMAGEOPS 78 POINTER)               (IMAGEOPS 80 POINTER)               (IMAGEOPS 82 POINTER)               (IMAGEOPS 84 POINTER)               (IMAGEOPS 86 POINTER)))       (QUOTE 88))(DECLARE: DOEVAL@COMPILE DONTCOPY(GLOBALVARS \NOIMAGEOPS))(* END EXPORTED DEFINITIONS))(/DECLAREDATATYPE (QUOTE IMAGEOPS)       (QUOTE (POINTER POINTER POINTER POINTER POINTER POINTER POINTER POINTER POINTER POINTER                      POINTER POINTER POINTER POINTER POINTER POINTER POINTER POINTER POINTER POINTER                      POINTER POINTER POINTER POINTER POINTER POINTER POINTER POINTER POINTER POINTER                      POINTER POINTER POINTER POINTER POINTER POINTER POINTER POINTER POINTER POINTER                      POINTER POINTER POINTER POINTER))       (QUOTE ((IMAGEOPS 0 POINTER)               (IMAGEOPS 2 POINTER)               (IMAGEOPS 4 POINTER)               (IMAGEOPS 6 POINTER)               (IMAGEOPS 8 POINTER)               (IMAGEOPS 10 POINTER)               (IMAGEOPS 12 POINTER)               (IMAGEOPS 14 POINTER)               (IMAGEOPS 16 POINTER)               (IMAGEOPS 18 POINTER)               (IMAGEOPS 20 POINTER)               (IMAGEOPS 22 POINTER)               (IMAGEOPS 24 POINTER)               (IMAGEOPS 26 POINTER)               (IMAGEOPS 28 POINTER)               (IMAGEOPS 30 POINTER)               (IMAGEOPS 32 POINTER)               (IMAGEOPS 34 POINTER)               (IMAGEOPS 36 POINTER)               (IMAGEOPS 38 POINTER)               (IMAGEOPS 40 POINTER)               (IMAGEOPS 42 POINTER)               (IMAGEOPS 44 POINTER)               (IMAGEOPS 46 POINTER)               (IMAGEOPS 48 POINTER)               (IMAGEOPS 50 POINTER)               (IMAGEOPS 52 POINTER)               (IMAGEOPS 54 POINTER)               (IMAGEOPS 56 POINTER)               (IMAGEOPS 58 POINTER)               (IMAGEOPS 60 POINTER)               (IMAGEOPS 62 POINTER)               (IMAGEOPS 64 POINTER)               (IMAGEOPS 66 POINTER)               (IMAGEOPS 68 POINTER)               (IMAGEOPS 70 POINTER)               (IMAGEOPS 72 POINTER)               (IMAGEOPS 74 POINTER)               (IMAGEOPS 76 POINTER)               (IMAGEOPS 78 POINTER)               (IMAGEOPS 80 POINTER)               (IMAGEOPS 82 POINTER)               (IMAGEOPS 84 POINTER)               (IMAGEOPS 86 POINTER)))       (QUOTE 88))[ADDTOVAR SYSTEMRECLST(DATATYPE IMAGEOPS           (IMAGETYPE IMCLOSEFN IMXPOSITION IMYPOSITION IMFONT IMLEFTMARGIN IMRIGHTMARGIN IMLINEFEED                  IMDRAWLINE IMDRAWCURVE IMDRAWCIRCLE IMDRAWELLIPSE IMFILLCIRCLE IMBLTSHADE IMBITBLT                  IMNEWPAGE IMMOVETO IMSCALE IMTERPRI IMTOPMARGIN IMBOTTOMMARGIN IMSPACEFACTOR                  IMFONTCREATE IMOPERATION IMCOLOR IMSTRINGWIDTH IMCHARWIDTH IMCHARWIDTHY IMBACKCOLOR                  IMBITMAPSIZE IMCLIPPINGREGION IMRESET IMDRAWPOLYGON IMFILLPOLYGON IMSCALEDBITBLT                  IMWRITEPIXEL IMCHARSET IMROTATE IMDRAWARC IMTRANSLATE IMSCALE2 IMPUSHSTATE                  IMPOPSTATE IMDEFAULTSTATE))](DECLARE: DONTEVAL@LOAD DOCOPY (\IMAGEIOINIT))(* Implementation of display stream resident "files." Done here cause it might matter that the display device get defined early so that its event fn will be evaluated as the last thing before logout)(RPAQ? \COLORDISPLAYSTREAMTYPES (QUOTE (4DISPLAY 8DISPLAY 24DISPLAY)))(RPAQ? \DISPLAYSTREAMTYPES (CONS (QUOTE DISPLAY)                                 \COLORDISPLAYSTREAMTYPES))(DEFINEQ(\DisplayEventFn  (LAMBDA (FDEV EVENT)                                       (* bvm: "25-MAY-83 12:32")    (SELECTQ EVENT	       (BEFORELOGOUT (DISPLAYBEFOREEXIT (QUOTE LOGOUT)))	       (AFTERLOGOUT (DISPLAYAFTERENTRY (QUOTE LOGOUT)))	       (BEFOREMAKESYS (DISPLAYBEFOREEXIT (QUOTE MAKESYS)))	       (AFTERMAKESYS (DISPLAYAFTERENTRY (QUOTE MAKESYS)))	       ((BEFORESYSOUT BEFORESAVEVM)		 (DISPLAYBEFOREEXIT (QUOTE SYSOUT)))	       ((AFTERSYSOUT AFTERSAVEVM)		 (DISPLAYAFTERENTRY (QUOTE SYSOUT)))	       NIL)))(\DISPLAYINIT  (LAMBDA NIL                                                         (* kbr:                                                                           "20-Feb-86 17:13")                                                                          (* Initializes global                                                                           variables for the                                                                           Display device)                        (* Display Streams are referred to only by themselves so they do not             need directory operations. Most of the fields in the DisplayDevice are             empty to avoid something bad happening.)    (DECLARE (GLOBALVARS DisplayFDEV \DISPLAYIMAGEOPS \DisplayDeviceMethods \DisplayDeviceData))    (SETQ \DisplayDeviceMethods (create WSOPS))    (SETQ \DisplayDeviceData     (create WSDATA            WSDESTINATION &larr;"Destination"            WSREGION &larr;(create REGION                             LEFT &larr; 0                             BOTTOM &larr; 0                             WIDTH &larr; 1024                             HEIGHT &larr; 808)))    (SETQ \DISPLAYIMAGEOPS (create IMAGEOPS                                  IMAGETYPE &larr;(QUOTE DISPLAY)                                  IMFONT &larr;(FUNCTION \DSPFONT.DISPLAY)                                  IMLEFTMARGIN &larr;(FUNCTION \DSPLEFTMARGIN.DISPLAY)                                  IMRIGHTMARGIN &larr;(FUNCTION \DSPRIGHTMARGIN.DISPLAY)                                  IMLINEFEED &larr;(FUNCTION \DSPLINEFEED.DISPLAY)                                  IMXPOSITION &larr;(FUNCTION \DSPXPOSITION.DISPLAY)                                  IMYPOSITION &larr;(FUNCTION \DSPYPOSITION.DISPLAY)                                  IMCLOSEFN &larr;(FUNCTION NILL)                                  IMDRAWCURVE &larr;(FUNCTION \DRAWCURVE.DISPLAY)                                  IMFILLCIRCLE &larr;(QUOTE \FILLCIRCLE.DISPLAY)                                  IMDRAWLINE &larr;(FUNCTION \DRAWLINE.DISPLAY)                                  IMDRAWELLIPSE &larr;(FUNCTION \DRAWELLIPSE.DISPLAY)                                  IMDRAWCIRCLE &larr;(FUNCTION \DRAWCIRCLE.DISPLAY)                                  IMFILLPOLYGON &larr;(FUNCTION POLYSHADE.DISPLAY)                                  IMBITBLT &larr;(FUNCTION \BITBLT.DISPLAY)                                  IMBLTSHADE &larr;(FUNCTION \BLTSHADE.DISPLAY)                                  IMNEWPAGE &larr;(FUNCTION \NEWPAGE.DISPLAY)                                  IMSCALE &larr;(FUNCTION (LAMBDA NIL 1))                                  IMSPACEFACTOR &larr;(FUNCTION NILL)                                  IMFONTCREATE &larr;(QUOTE DISPLAY)                                  IMCOLOR &larr;(FUNCTION NILL)                                  IMBACKCOLOR &larr;(FUNCTION NILL)                                  IMOPERATION &larr;(FUNCTION \DSPOPERATION.DISPLAY)                                  IMSTRINGWIDTH &larr;(FUNCTION \STRINGWIDTH.DISPLAY)                                  IMCHARWIDTH &larr;(FUNCTION \CHARWIDTH.DISPLAY)                                  IMCLIPPINGREGION &larr;(FUNCTION \DSPCLIPPINGREGION.DISPLAY)                                  IMRESET &larr;(FUNCTION \DSPRESET.DISPLAY)                                  IMDRAWARC &larr;(FUNCTION \DRAWARC.DISPLAY)))    (SETQ DisplayFDEV (create FDEV                             DEVICENAME &larr;(QUOTE DISPLAY)                             RESETABLE &larr; NIL                             RANDOMACCESSP &larr; NIL                             PAGEMAPPED &larr; NIL                             CLOSEFILE &larr;(FUNCTION NILL)                             DELETEFILE &larr;(FUNCTION NILL)                             GETFILEINFO &larr;(FUNCTION NILL)                             OPENFILE &larr;(FUNCTION (LAMBDA (NAME ACCESS RECOG OTHERINFO FDEV)                                                   NAME))                             READPAGES &larr;(FUNCTION \ILLEGAL.DEVICEOP)                             SETFILEINFO &larr;(FUNCTION NILL)                             GENERATEFILES &larr;(FUNCTION \GENERATENOFILES)                             TRUNCATEFILE &larr;(FUNCTION NILL)                             WRITEPAGES &larr;(FUNCTION \ILLEGAL.DEVICEOP)                             GETFILENAME &larr;(FUNCTION (LAMBDA (NAME RECOG FDEV)                                                      NAME))                             REOPENFILE &larr;(FUNCTION (LAMBDA (NAME)                                                     NAME))                             EVENTFN &larr;(FUNCTION \DisplayEventFn)                             DIRECTORYNAMEP &larr;(FUNCTION NILL)                             HOSTNAMEP &larr;(FUNCTION NILL)                             BIN &larr;(FUNCTION \ILLEGAL.DEVICEOP)                             BOUT &larr;(FUNCTION \DSPPRINTCHAR)                             PEEKBIN &larr;(FUNCTION \ILLEGAL.DEVICEOP)                             BACKFILEPTR &larr;(FUNCTION \PAGEDBACKFILEPTR)                             BLOCKIN &larr;(FUNCTION \ILLEGAL.DEVICEOP)                             BLOCKOUT &larr;(FUNCTION \NONPAGEDBOUTS)                             WINDOWOPS &larr; \DisplayDeviceMethods                             WINDOWDATA &larr; \DisplayDeviceData                             DEVICEINFO &larr;(create DISPLAYSTATE)))    (\DEFINEDEVICE (QUOTE LFDISPLAY)           DisplayFDEV)))(\4DISPLAYINIT  (LAMBDA NIL                                                         (* kbr:                                                                           "20-Feb-86 19:08")    (DECLARE (GLOBALVARS \4DISPLAYIMAGEOPS \4DISPLAYFDEV))    (SETQ \4DISPLAYIMAGEOPS (create IMAGEOPS                                   IMAGETYPE &larr;(QUOTE 4DISPLAY)                                   IMFONT &larr;(FUNCTION \DSPFONT.DISPLAY)                                   IMLEFTMARGIN &larr;(FUNCTION \DSPLEFTMARGIN.DISPLAY)                                   IMRIGHTMARGIN &larr;(FUNCTION \DSPRIGHTMARGIN.DISPLAY)                                   IMLINEFEED &larr;(FUNCTION \DSPLINEFEED.DISPLAY)                                   IMXPOSITION &larr;(FUNCTION \DSPXPOSITION.DISPLAY)                                   IMYPOSITION &larr;(FUNCTION \DSPYPOSITION.DISPLAY)                                   IMCLOSEFN &larr;(FUNCTION NILL)                                   IMDRAWCURVE &larr;(FUNCTION \DRAWCURVE.DISPLAY)                                   IMFILLCIRCLE &larr;(QUOTE \FILLCIRCLE.DISPLAY)                                   IMDRAWLINE &larr;(FUNCTION \DRAWLINE.DISPLAY)                                   IMDRAWELLIPSE &larr;(FUNCTION \DRAWELLIPSE.DISPLAY)                                   IMDRAWCIRCLE &larr;(FUNCTION \DRAWCIRCLE.DISPLAY)                                   IMBITBLT &larr;(FUNCTION \BITBLT.DISPLAY)                                   IMBLTSHADE &larr;(FUNCTION \BLTSHADE.DISPLAY)                                   IMNEWPAGE &larr;(FUNCTION \NEWPAGE.DISPLAY)                                   IMSCALE &larr;(FUNCTION (LAMBDA NIL 1))                                   IMSPACEFACTOR &larr;(FUNCTION \DSPSPACEFACTOR.DISPLAY)                                   IMFONTCREATE &larr;(QUOTE 4DISPLAY)                                   IMCOLOR &larr;(FUNCTION \DSPCOLOR.DISPLAY)                                   IMBACKCOLOR &larr;(FUNCTION \DSPBACKCOLOR.DISPLAY)                                   IMOPERATION &larr;(FUNCTION \DSPOPERATION.DISPLAY)                                   IMSTRINGWIDTH &larr;(FUNCTION \STRINGWIDTH.DISPLAY)                                   IMCHARWIDTH &larr;(FUNCTION \CHARWIDTH.DISPLAY)                                   IMCLIPPINGREGION &larr;(FUNCTION \DSPCLIPPINGREGION.DISPLAY)                                   IMRESET &larr;(FUNCTION \DSPRESET.DISPLAY)                                   IMDRAWARC &larr;(FUNCTION \DRAWARC.DISPLAY)))    (SETQ \4DISPLAYFDEV (create FDEV                               DEVICENAME &larr;(QUOTE 4DISPLAY)                               RESETABLE &larr; NIL                               RANDOMACCESSP &larr; NIL                               PAGEMAPPED &larr; NIL                               CLOSEFILE &larr;(FUNCTION NILL)                               DELETEFILE &larr;(FUNCTION NILL)                               GETFILEINFO &larr;(FUNCTION NILL)                               OPENFILE &larr;(FUNCTION (LAMBDA (NAME ACCESS RECOG OTHERINFO FDEV)                                                     NAME))                               READPAGES &larr;(FUNCTION \ILLEGAL.DEVICEOP)                               SETFILEINFO &larr;(FUNCTION NILL)                               GENERATEFILES &larr;(FUNCTION \GENERATENOFILES)                               TRUNCATEFILE &larr;(FUNCTION NILL)                               WRITEPAGES &larr;(FUNCTION \ILLEGAL.DEVICEOP)                               GETFILENAME &larr;(FUNCTION (LAMBDA (NAME RECOG FDEV)                                                        NAME))                               REOPENFILE &larr;(FUNCTION (LAMBDA (NAME)                                                       NAME))                               EVENTFN &larr;(FUNCTION NILL)                               DIRECTORYNAMEP &larr;(FUNCTION NILL)                               HOSTNAMEP &larr;(FUNCTION NILL)                               BIN &larr;(FUNCTION \ILLEGAL.DEVICEOP)                               BOUT &larr;(FUNCTION \DSPPRINTCHAR)                               PEEKBIN &larr;(FUNCTION \ILLEGAL.DEVICEOP)                               BACKFILEPTR &larr;(FUNCTION \PAGEDBACKFILEPTR)                               BLOCKIN &larr;(FUNCTION \ILLEGAL.DEVICEOP)                               BLOCKOUT &larr;(FUNCTION \NONPAGEDBOUTS)                               DEVICEINFO &larr;(create DISPLAYSTATE)                               WINDOWOPS &larr; NIL))    (\DEFINEDEVICE NIL \4DISPLAYFDEV)))(\8DISPLAYINIT  (LAMBDA NIL                                                         (* kbr:                                                                           "20-Feb-86 19:08")    (DECLARE (GLOBALVARS \8DISPLAYIMAGEOPS \8DISPLAYFDEV))    (SETQ \8DISPLAYIMAGEOPS (create IMAGEOPS                                   IMAGETYPE &larr;(QUOTE 8DISPLAY)                                   IMFONT &larr;(FUNCTION \DSPFONT.DISPLAY)                                   IMLEFTMARGIN &larr;(FUNCTION \DSPLEFTMARGIN.DISPLAY)                                   IMRIGHTMARGIN &larr;(FUNCTION \DSPRIGHTMARGIN.DISPLAY)                                   IMLINEFEED &larr;(FUNCTION \DSPLINEFEED.DISPLAY)                                   IMXPOSITION &larr;(FUNCTION \DSPXPOSITION.DISPLAY)                                   IMYPOSITION &larr;(FUNCTION \DSPYPOSITION.DISPLAY)                                   IMCLOSEFN &larr;(FUNCTION NILL)                                   IMDRAWCURVE &larr;(FUNCTION \DRAWCURVE.DISPLAY)                                   IMFILLCIRCLE &larr;(QUOTE \FILLCIRCLE.DISPLAY)                                   IMDRAWLINE &larr;(FUNCTION \DRAWLINE.DISPLAY)                                   IMDRAWELLIPSE &larr;(FUNCTION \DRAWELLIPSE.DISPLAY)                                   IMDRAWCIRCLE &larr;(FUNCTION \DRAWCIRCLE.DISPLAY)                                   IMBITBLT &larr;(FUNCTION \BITBLT.DISPLAY)                                   IMBLTSHADE &larr;(FUNCTION \BLTSHADE.DISPLAY)                                   IMNEWPAGE &larr;(FUNCTION \NEWPAGE.DISPLAY)                                   IMSCALE &larr;(FUNCTION (LAMBDA NIL 1))                                   IMSPACEFACTOR &larr;(FUNCTION \DSPSPACEFACTOR.DISPLAY)                                   IMFONTCREATE &larr;(QUOTE 8DISPLAY)                                   IMCOLOR &larr;(FUNCTION \DSPCOLOR.DISPLAY)                                   IMBACKCOLOR &larr;(FUNCTION \DSPBACKCOLOR.DISPLAY)                                   IMOPERATION &larr;(FUNCTION \DSPOPERATION.DISPLAY)                                   IMSTRINGWIDTH &larr;(FUNCTION \STRINGWIDTH.DISPLAY)                                   IMCHARWIDTH &larr;(FUNCTION \CHARWIDTH.DISPLAY)                                   IMCLIPPINGREGION &larr;(FUNCTION \DSPCLIPPINGREGION.DISPLAY)                                   IMRESET &larr;(FUNCTION \DSPRESET.DISPLAY)                                   IMDRAWARC &larr;(FUNCTION \DRAWARC.DISPLAY)))    (SETQ \8DISPLAYFDEV (create FDEV                               DEVICENAME &larr;(QUOTE 8DISPLAY)                               RESETABLE &larr; NIL                               RANDOMACCESSP &larr; NIL                               PAGEMAPPED &larr; NIL                               CLOSEFILE &larr;(FUNCTION NILL)                               DELETEFILE &larr;(FUNCTION NILL)                               GETFILEINFO &larr;(FUNCTION NILL)                               OPENFILE &larr;(FUNCTION (LAMBDA (NAME ACCESS RECOG OTHERINFO FDEV)                                                     NAME))                               READPAGES &larr;(FUNCTION \ILLEGAL.DEVICEOP)                               SETFILEINFO &larr;(FUNCTION NILL)                               GENERATEFILES &larr;(FUNCTION \GENERATENOFILES)                               TRUNCATEFILE &larr;(FUNCTION NILL)                               WRITEPAGES &larr;(FUNCTION \ILLEGAL.DEVICEOP)                               GETFILENAME &larr;(FUNCTION (LAMBDA (NAME RECOG FDEV)                                                        NAME))                               REOPENFILE &larr;(FUNCTION (LAMBDA (NAME)                                                       NAME))                               EVENTFN &larr;(FUNCTION NILL)                               DIRECTORYNAMEP &larr;(FUNCTION NILL)                               HOSTNAMEP &larr;(FUNCTION NILL)                               BIN &larr;(FUNCTION \ILLEGAL.DEVICEOP)                               BOUT &larr;(FUNCTION \DSPPRINTCHAR)                               PEEKBIN &larr;(FUNCTION \ILLEGAL.DEVICEOP)                               BACKFILEPTR &larr;(FUNCTION \PAGEDBACKFILEPTR)                               BLOCKIN &larr;(FUNCTION \ILLEGAL.DEVICEOP)                               BLOCKOUT &larr;(FUNCTION \NONPAGEDBOUTS)                               DEVICEINFO &larr;(create DISPLAYSTATE)                               WINDOWOPS &larr; NIL))    (\DEFINEDEVICE NIL \8DISPLAYFDEV)))(\24DISPLAYINIT  (LAMBDA NIL                                                         (* kbr:                                                                           "20-Feb-86 19:09")    (DECLARE (GLOBALVARS \24DISPLAYIMAGEOPS \24DISPLAYFDEV))    (SETQ \24DISPLAYIMAGEOPS (create IMAGEOPS                                    IMAGETYPE &larr;(QUOTE 24DISPLAY)                                    IMFONT &larr;(FUNCTION \DSPFONT.DISPLAY)                                    IMLEFTMARGIN &larr;(FUNCTION \DSPLEFTMARGIN.DISPLAY)                                    IMRIGHTMARGIN &larr;(FUNCTION \DSPRIGHTMARGIN.DISPLAY)                                    IMLINEFEED &larr;(FUNCTION \DSPLINEFEED.DISPLAY)                                    IMXPOSITION &larr;(FUNCTION \DSPXPOSITION.DISPLAY)                                    IMYPOSITION &larr;(FUNCTION \DSPYPOSITION.DISPLAY)                                    IMCLOSEFN &larr;(FUNCTION NILL)                                    IMDRAWCURVE &larr;(FUNCTION \DRAWCURVE.DISPLAY)                                    IMFILLCIRCLE &larr;(QUOTE \FILLCIRCLE.DISPLAY)                                    IMDRAWLINE &larr;(FUNCTION \DRAWLINE.DISPLAY)                                    IMDRAWELLIPSE &larr;(FUNCTION \DRAWELLIPSE.DISPLAY)                                    IMDRAWCIRCLE &larr;(FUNCTION \DRAWCIRCLE.DISPLAY)                                    IMBITBLT &larr;(FUNCTION \BITBLT.DISPLAY)                                    IMBLTSHADE &larr;(FUNCTION \BLTSHADE.DISPLAY)                                    IMNEWPAGE &larr;(FUNCTION \NEWPAGE.DISPLAY)                                    IMSCALE &larr;(FUNCTION (LAMBDA NIL 1))                                    IMSPACEFACTOR &larr;(FUNCTION \DSPSPACEFACTOR.DISPLAY)                                    IMFONTCREATE &larr;(QUOTE 24DISPLAY)                                    IMCOLOR &larr;(FUNCTION \DSPCOLOR.DISPLAY)                                    IMBACKCOLOR &larr;(FUNCTION \DSPBACKCOLOR.DISPLAY)                                    IMOPERATION &larr;(FUNCTION \DSPOPERATION.DISPLAY)                                    IMSTRINGWIDTH &larr;(FUNCTION \STRINGWIDTH.DISPLAY)                                    IMCHARWIDTH &larr;(FUNCTION \CHARWIDTH.DISPLAY)                                    IMCLIPPINGREGION &larr;(FUNCTION \DSPCLIPPINGREGION.DISPLAY)                                    IMRESET &larr;(FUNCTION \DSPRESET.DISPLAY)                                    IMDRAWARC &larr;(FUNCTION \DRAWARC.DISPLAY)))    (SETQ \24DISPLAYFDEV (create FDEV                                DEVICENAME &larr;(QUOTE 24DISPLAY)                                RESETABLE &larr; NIL                                RANDOMACCESSP &larr; NIL                                PAGEMAPPED &larr; NIL                                CLOSEFILE &larr;(FUNCTION NILL)                                DELETEFILE &larr;(FUNCTION NILL)                                GETFILEINFO &larr;(FUNCTION NILL)                                OPENFILE &larr;(FUNCTION (LAMBDA (NAME ACCESS RECOG OTHERINFO FDEV)                                                      NAME))                                READPAGES &larr;(FUNCTION \ILLEGAL.DEVICEOP)                                SETFILEINFO &larr;(FUNCTION NILL)                                GENERATEFILES &larr;(FUNCTION \GENERATENOFILES)                                TRUNCATEFILE &larr;(FUNCTION NILL)                                WRITEPAGES &larr;(FUNCTION \ILLEGAL.DEVICEOP)                                GETFILENAME &larr;(FUNCTION (LAMBDA (NAME RECOG FDEV)                                                         NAME))                                REOPENFILE &larr;(FUNCTION (LAMBDA (NAME)                                                        NAME))                                EVENTFN &larr;(FUNCTION NILL)                                DIRECTORYNAMEP &larr;(FUNCTION NILL)                                HOSTNAMEP &larr;(FUNCTION NILL)                                BIN &larr;(FUNCTION \ILLEGAL.DEVICEOP)                                BOUT &larr;(FUNCTION \DSPPRINTCHAR)                                PEEKBIN &larr;(FUNCTION \ILLEGAL.DEVICEOP)                                BACKFILEPTR &larr;(FUNCTION \PAGEDBACKFILEPTR)                                BLOCKIN &larr;(FUNCTION \ILLEGAL.DEVICEOP)                                BLOCKOUT &larr;(FUNCTION \NONPAGEDBOUTS)                                DEVICEINFO &larr;(create DISPLAYSTATE)                                WINDOWOPS &larr; NIL))    (\DEFINEDEVICE NIL \24DISPLAYFDEV)))(\DISPLAYSTREAMTYPEBPP  (LAMBDA (DISPLAYSTREAMTYPE)                                         (* kbr:                                                                           " 6-Feb-86 18:14")    (SELECTQ DISPLAYSTREAMTYPE        (DISPLAY 1)        (4DISPLAY 4)        (8DISPLAY 8)        (24DISPLAY 24)        (SHOULDNT)))))(ADDTOVAR IMAGESTREAMTYPES (DISPLAY (OPENSTREAM OPENDISPLAYSTREAM)                                  (FONTCREATE \CREATEDISPLAYFONT)                                  (FONTSAVAILABLE \SEARCHDISPLAYFONTFILES))                           (4DISPLAY (OPENSTREAM OPENDISPLAYSTREAM)                                  (FONTCREATE \CREATEDISPLAYFONT)                                  (FONTSAVAILABLE \SEARCHDISPLAYFONTFILES))                           (8DISPLAY (OPENSTREAM OPENDISPLAYSTREAM)                                  (FONTCREATE \CREATEDISPLAYFONT)                                  (FONTSAVAILABLE \SEARCHDISPLAYFONTFILES))                           (24DISPLAY (OPENSTREAM OPENDISPLAYSTREAM)                                  (FONTCREATE \CREATEDISPLAYFONT)                                  (FONTSAVAILABLE \SEARCHDISPLAYFONTFILES)))(DECLARE: DOEVAL@COMPILE DONTCOPY(GLOBALVARS DisplayFDEV \4DISPLAYFDEV \8DISPLAYFDEV \24DISPLAYFDEV))(DECLARE: DONTEVAL@LOAD DOCOPY (\DISPLAYINIT)(\4DISPLAYINIT)(\8DISPLAYINIT)(\24DISPLAYINIT))(DECLARE: DONTEVAL@LOAD DOEVAL@COMPILE DONTCOPY COMPILERVARS (ADDTOVAR NLAMA )(ADDTOVAR NLAML )(ADDTOVAR LAMA IMAGESTREAMP))(PUTPROPS IMAGEIO COPYRIGHT ("Xerox Corporation" 1983 1984 1985 1986))(DECLARE: DONTCOPY  (FILEMAP (NIL (3155 11634 (IMAGESTREAMP 3165 . 3814) (IMAGESTREAMTYPE 3816 . 4031) (IMAGESTREAMTYPEP 4033 . 4550) (OPENIMAGESTREAM 4552 . 9417) (\GOOD.DASHLST 9419 . 11632)) (11669 13411 (DRAWDASHEDLINE 11679 . 13409)) (13412 20560 (DSPBACKCOLOR 13422 . 13742) (DSPBOTTOMMARGIN 13744 . 14081) (DSPCOLOR 14083 . 14395) (DSPCLIPPINGREGION 14397 . 15036) (DSPRESET 15038 . 15331) (DSPFONT 15333 . 15684) (DSPLEFTMARGIN 15686 . 16049) (DSPLINEFEED 16051 . 16363) (DSPOPERATION 16365 . 16690) (DSPRIGHTMARGIN 16692 . 17071) (DSPTOPMARGIN 17073 . 17406) (DSPSCALE 17408 . 17763) (DSPSPACEFACTOR 17765 . 18169) (DSPXPOSITION 18171 . 18488) (DSPYPOSITION 18490 . 18807) (DSPROTATE 18809 . 19117) (DSPPUSHSTATE 19119 . 19389) (DSPPOPSTATE 19391 . 19658) (DSPDEFAULTSTATE 19660 . 19936) (DSPSCALE2 19938 . 20242) (DSPTRANSLATE 20244 . 20558)) (20561 29684 (DSPNEWPAGE 20571 . 21716) (DRAWBETWEEN 21718 . 22204) (DRAWCIRCLE 22206 . 22694) (DRAWARC 22696 . 23321) (DRAWCURVE 23323 . 24120) (DRAWELLIPSE 24122 . 24863) (DRAWLINE 24865 . 25171) (DRAWPOLYGON 25173 . 25568) (FILLPOLYGON 25570 . 26266) (DRAWTO 26268 . 26793) (FILLCIRCLE 26795 . 27034) (MOVETO 27036 . 27353) (RELDRAWTO 27355 . 28721) (BITMAPIMAGESIZE 28723 . 28912) (SCALEDBITBLT 28914 . 29682)) (29685 35606 (\IMAGEIOINIT 29695 . 33988) (\NOIMAGE.DSPFONT 33990 . 35431) (\UNIMPIMAGEOP 35433 . 35604)) (35723 39785 (INSURE.BRUSH 35733 . 37594) (BRUSHP 37596 . 38742) (\POSSIBLECOLOR 38744 . 39783)) (40226 41010 (DASHINGP 40236 . 40631) (INSURE.DASHING 40633 . 41008)) (51764 70998 (\DisplayEventFn 51774 . 52356) (\DISPLAYINIT 52358 . 57634) (\4DISPLAYINIT 57636 . 61951) (\8DISPLAYINIT 61953 . 66268) (\24DISPLAYINIT 66270 . 70650) (\DISPLAYSTREAMTYPEBPP 70652 . 70996)))))STOP</pre>
  </body>
</html>
