<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
    <title>File [eris]&lt;LispCore>32mbdlioninitial>trident>NewInit11T.mc!1</title>
  </head>
  <body>
    <pre>
{NewInit11T.mcLichtenberg 13-Jul-84 18:42:06 changed to initialize both versions of u1FFFLast modifiedby don:       9-Sep-83  9:51:57Created by don:   2-Sep-83 13:38:39Purcell  1-Jul-84 23:23:09 disabled writes to IOPage which moves from init{2000} to lisp{14000}}{SetTask[0];}RegDef[uLisp1FFF,U,2E];   {Lisp's u1FFF}Set[bigVMrefFlg, 75'b];Set[InitVersion, 5];{	deleted initialization of the following U registers:		uPcBreak		uValHigh  --  reinserted for Intermezzo compatability		unboundPvar		unboundFvar		u3FF  --  reinserted for Intermezzo compatability		u3FFF  --  reinserted for Intermezzo compatability	added initialization of the following U registers:		uSTATE		uDTDbase		uInitVersion	added test of large VM:		result to INTERFACEbasePage + bigVMrefFlg}StartNewInit:	uRx &larr; Rx,	c1;	UQSave &larr; Q,	c2;	Q &larr; rhRx,	c3;	UGsave &larr; Q,	c1;	Rx &larr; Rx xor ~Rx,	c2;	uStkLimO &larr; Rx,	c3;	{can delete these 3 clicks eventually --- for compatability with Intermezzo}	Rx &larr; VALspace,	c1;	uValHigh &larr; Rx,	c2;	Rx &larr; 3,	c3;	Rx &larr; Rx LRot8,	c1;	Rx &larr; Rx or 0FF,	c2;	u3FF &larr; Rx,	c3;	Rx &larr; Rx LRot4,	c1;	Rx &larr; Rx or 0F,	c2;	u3FFF &larr; Rx,	c3;	Rx &larr; InitVersion,	c1;	uInitVersion &larr; Rx,	c2;	,	c3;	Rx &larr; DTDbasePage,	c1;	Rx &larr; Rx LRot8,	c2;	uDTDbase &larr; Rx,	c3;	uSTATE &larr; 0,	c1;	uWP &larr; 0,	c2;	uWDC &larr; 0{uWDC inited by mesaInit},	c3;	Rx &larr;  ~0FD,	c1;	Rx &larr; Rx LRot8,	c2;	uBfResidualRhmask &larr; Rx{2FF},	c3;	Rx &larr;  0A0,	c1;	Rx &larr; Rx LRot8,	c2;	uFreeStackBlock &larr; Rx{0A000},	c3;	Rx &larr;  0FF + 1,	c1;	uFxNoPushReturn &larr; Rx{100h},	c2;	Rx &larr;  LShift1(Rx + Rx), SE&larr;0,	c3;	uFxInCall &larr; Rx{400h},	c1;	Rx &larr;  7F,	c2;	u7F &larr; Rx{7F},	c3;	Rx &larr;  ~0FF,	c1;{OK}	u0FF &larr; ~Rx{~0FF},	c2;	uFF00 &larr;  Q &larr; Rx{~0FF},	c3;	Rx &larr; Q{0FF00} or 1,	c1;	Rx &larr; Rx LRot8,	c2;	u1FF &larr; Rx{1FF},	c3;	Rx &larr; Q{0FF00} or 3,	c1;	Rx &larr; Rx LRot8,	c2;	uTT3FF &larr; Rx{3FF},	c3;	Rx &larr; Q{0FF00} or 0F,	c1;	Rx &larr; Rx LRot8,	c2;	u0FFF &larr; Rx{0FFF},	c3;	Rx &larr; Q{0FF00} or 1F,	c1;	Rx &larr; Rx LRot8,	c2;	u1FFF &larr; Rx{1FFF},	c3;	uLisp1FFF {called u1FFF in lisp code} &larr; Rx, c1;	, c2;	, c3;	Rx &larr; Q{0FF00} or 3F,	c1;	Rx &larr; Rx LRot8,	c2;	uTT3FFF &larr; Rx{3FFF},	c3;	Rx &larr; Q{0FF00} or 7F,	c1;	Rx &larr; Rx LRot8,	c2;	u7FFF &larr; Rx{7FFF},	c3;	Rx &larr; Q{0FF00} or 7,	c1;	Rx &larr; Rx LRot8,	c2;	u7FF &larr; Rx{7FF},	c3;	uLispOptions &larr; 0,	c1;	Rx &larr; Rx xor 1,	c2;	u7FE &larr; Rx{7FE},	c3;	Rx &larr; 80,	c1;	Rx &larr;  Rx LRot8,	c2;	uBFmark &larr; Rx{8000},	c3;{compliance: using uSTACKspace with duplicated high byte for bind ptr}	Rx &larr; STACKspace,	c1;	Rx &larr; Rx LRot8 or Rx,	c2;	uSTACKspace &larr; Rx,	c3;	Rx &larr; 0C0,	c1;	Rx &larr;  Rx LRot8,	c2;	uFXmark &larr; Rx{C000},	c3;	Set[UFNTablePageHalf, Rshift[UFNTablebase, 9]];	Rx &larr;  UFNTablePageHalf,	c1;	Rx &larr;  Rx LRot8,	c2;	uUFNTableBaseHalf &larr; Rx,	c3;bigVMtest:	Rx &larr; 5,	c1;	passTraps &larr; Rx,	c2;	Rx &larr; rhRx &larr; 0FF,	c3;	Map &larr; [rhRx,Rx],	c1;{cause trap if bigVM not supported}	,	c2;	Rx &larr; MD, GOTO[bigVMok],	c3;bigVMok:	rhRx &larr; INTERFACEspace,	c1;	Rx &larr; INTERFACEbasePage,	c2;	Rx &larr; Rx LRot8,	c3;		Map{InterfacePage} &larr; [rhRx, Rx],	c1;	passTraps &larr; 0,	c2;	rhRx &larr; Rx &larr; MD,	c3;	MAR &larr; [rhRx, bigVMrefFlg  + 0], c1;	MDR &larr; 1 {true}, c2;	GOTO[uInitdone], c3;{	in case of map fault come here }	at[1, 4, errorType],	Rx &larr; passTraps,	c1;	Ybus &larr; Rx xor 5, ZeroBr,	c2;	BRANCH[notmytrap, uInitdone],	c3;notmytrap:	Xbus&larr; MStatus, XLDisp, GOTO[memFault],	c1;uInitdone:	Rx &larr; uRx,	c1;	Q &larr; UQSave,	c2;	rhRx &larr; UGsave, GOTO[BackFromNewInit],	c3;	{ E N D }</pre>
  </body>
</html>
